(function webpackUniversalModuleDefinition(a,b){if(typeof exports==="object"&&typeof module==="object"){module.exports=b(require("canvas"))}else{if(typeof define==="function"&&define.amd){define(["canvas"],b)}else{if(typeof exports==="object"){exports.ImglyKit=b(require("canvas"))}else{a.ImglyKit=b(a.canvas)}}}})(this,function(a){return(function(b){var c={};function d(f){if(c[f]){return c[f].exports}var e=c[f]={exports:{},id:f,loaded:false};b[f].call(e.exports,e,e.exports,d);e.loaded=true;return e.exports}d.m=b;d.c=c;d.p="";return d(0)})([function(e,w,f){
/*!
	 * Photo Editor SDK - photoeditorsdk.com
	 * Copyright (c) 2013-2015 9elements GmbH
	 *
	 * Released under Attribution-NonCommercial 3.0 Unported
	 * http://creativecommons.org/licenses/by-nc/3.0/
	 *
	 * For commercial use, please contact us at contact@9elements.com
	 */
"use strict";Object.defineProperty(w,"__esModule",{value:true});var p=(function(){function y(C,A){for(var z=0;z<A.length;z++){var B=A[z];B.enumerable=B.enumerable||false;B.configurable=true;if("value" in B){B.writable=true}Object.defineProperty(C,B.key,B)}}return function(B,z,A){if(z){y(B.prototype,z)}if(A){y(B,A)}return B}})();function d(y){return y&&y.__esModule?y:{"default":y}}function h(y,z){if(!(y instanceof z)){throw new TypeError("Cannot call a class as a function")}}var j=f(1);var c=d(j);var l=f(13);var m=d(l);var n=f(20);var g=d(n);var r=f(14);var u=f(15);var o=d(u);var k=f(18);var x=d(k);var i=f(21);var t=d(i);var b=f(25);var s=d(b);var q="2.0.3-6";var v=(function(){function C(N){h(this,C);if(typeof N==="undefined"){throw new Error("No options given.")}N=o["default"].defaults(N,{assetsUrl:"assets",container:null,renderOnWindowResize:false,versionCheck:true});N.ui=N.ui||{};N.ui=o["default"].defaults(N.ui,{enabled:true});if(typeof N.image==="undefined"&&!N.ui.enabled){throw new Error("`options.image` needs to be set when UI is disabled.")}this._options=N;this.operationsStack=[];this._registeredUIs={};this._registerUIs();this._registeredOperations={};this._registerOperations();if(typeof window!=="undefined"&&this._options.versionCheck){this._versionChecker=new g["default"](q)}if(this._options.image){this._parseExif(this._options.image)}if(this._options.ui.enabled){this._initUI();if(this._options.renderOnWindowResize){this._handleWindowResize()}}}p(C,[{key:"render",value:function y(O,S,N,V){var U=this;var Q=m["default"].validateSettings(O,S);O=Q.renderType;S=Q.imageFormat;var P=new c["default"](this._options.image,this.operationsStack,N,this._options.renderer);for(var T=0;T<this.operationsStack.length;T++){var R=this.operationsStack[T];if(!R){continue}R.dirty=true}return P.render().then(function(){var W=P.getRenderer().getCanvas();return m["default"]["export"](U,U._options.image,W,O,S,V)})}},{key:"setImage",value:function I(N){this._options.image=N;this._parseExif(N)}},{key:"_parseExif",value:function G(R){if(x["default"].isJPEG(R.src)){this._exif=null;try{this._exif=x["default"].fromBase64String(R.src)}catch(Q){}if(!this._exif){return}var P=this._exif.getTags();if(P&&P.Orientation){if(P.Orientation!==1&&P.Orientation!==2){var S=0;switch(P.Orientation){case 7:case 8:S=-90;break;case 3:case 4:S=-180;break;case 5:case 6:S=90;break}var O=new t["default"](this,{degrees:S});this.operationsStack.push(O)}if([2,4,5,7].indexOf(P.Orientation)!==-1){var N=new s["default"](this,{horizontal:true});this.operationsStack.push(N)}this._exif.setOrientation(1)}}}},{key:"reset",value:function F(){}},{key:"getAssetPath",value:function E(O){var N=typeof window!=="undefined";if(N){return this._options.assetsUrl+"/"+O}else{var P=f(26);return P.resolve(this._options.assetsUrl,O)}}},{key:"_handleWindowResize",value:function D(){var N=this;var O=null;window.addEventListener("resize",function(){if(O!==null){clearTimeout(O)}O=setTimeout(function(){O=null;N.ui.render()},300)})}},{key:"_registerUIs",value:function L(){this.registerUI(C.NightUI)}},{key:"_registerOperations",value:function K(){for(var N in C.Operations){this.registerOperation(C.Operations[N])}}},{key:"registerOperation",value:function H(N){this._registeredOperations[N.prototype.identifier]=N;if(this.ui){this.ui.addOperation(N)}}},{key:"registerUI",value:function M(N){this._registeredUIs[N.prototype.identifier]=N}},{key:"_initUI",value:function A(){var N;if(this._options.ui.enabled===true){N=o["default"].values(this._registeredUIs)[0]}if(!N){return}this.ui=new N(this,this._options)}},{key:"getOperationFromStack",value:function J(O){var N=this.operationsStack.filter(function(P){return P.identifier===O})[0];return N}},{key:"run",value:function B(){if(typeof this.ui!=="undefined"){this.ui.run()}}},{key:"exif",get:function z(){return this._exif}},{key:"registeredOperations",get:function z(){return this._registeredOperations}}]);return C})();v.version=q;v.RenderImage=c["default"];v.Color=f(23);v.Filter=f(27);v.Operation=f(22);v.Operations={};v.Operations.Filters=f(41);v.Operations.Crop=f(43);v.Operations.Rotation=f(21);v.Operations.Saturation=f(44);v.Operations.Contrast=f(45);v.Operations.Brightness=f(46);v.Operations.Flip=f(25);v.Operations.TiltShift=f(47);v.Operations.RadialBlur=f(49);v.Operations.Text=f(50);v.Operations.Stickers=f(51);v.Operations.Frames=f(52);v.Operations.Brush=f(53);v.Filters={};v.Filters.A15=f(54);v.Filters.Breeze=f(55);v.Filters.BW=f(56);v.Filters.BWHard=f(57);v.Filters.Celsius=f(58);v.Filters.Chest=f(59);v.Filters.Fixie=f(60);v.Filters.Food=f(61);v.Filters.Fridge=f(62);v.Filters.Front=f(63);v.Filters.Glam=f(64);v.Filters.Gobblin=f(65);v.Filters.K1=f(66);v.Filters.K2=f(67);v.Filters.K6=f(68);v.Filters.KDynamic=f(69);v.Filters.Lenin=f(70);v.Filters.Lomo=f(71);v.Filters.Mellow=f(72);v.Filters.Morning=f(73);v.Filters.Orchid=f(74);v.Filters.Pola=f(75);v.Filters.Pola669=f(76);v.Filters.Quozi=f(77);v.Filters.Semired=f(78);v.Filters.Sunny=f(79);v.Filters.Texas=f(80);v.Filters.X400=f(81);v.RenderType=r.RenderType;v.ImageFormat=r.ImageFormat;v.Vector2=f(4);v.NightUI=f(82);w["default"]=v;e.exports=w["default"]},function(e,t,f){Object.defineProperty(t,"__esModule",{value:true});var o=(function(){function v(z,x){for(var w=0;w<x.length;w++){var y=x[w];y.enumerable=y.enumerable||false;y.configurable=true;if("value" in y){y.writable=true}Object.defineProperty(z,y.key,y)}}return function(y,w,x){if(w){v(y.prototype,w)}if(x){v(y,x)}return y}})();var b=function q(C,B,A){var y=true;_function:while(y){var w=C,E=B,v=A;x=D=z=undefined;y=false;if(w===null){w=Function.prototype}var x=Object.getOwnPropertyDescriptor(w,E);if(x===undefined){var D=Object.getPrototypeOf(w);if(D===null){return undefined}else{C=D;B=E;A=v;y=true;continue _function}}else{if("value" in x){return x.value}else{var z=x.get;if(z===undefined){return undefined}return z.call(v)}}}};function c(v){return v&&v.__esModule?v:{"default":v}}function h(v,w){if(!(v instanceof w)){throw new TypeError("Cannot call a class as a function")}}function n(w,v){if(typeof v!=="function"&&v!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof v)}w.prototype=Object.create(v&&v.prototype,{constructor:{value:w,enumerable:false,writable:true,configurable:true}});if(v){Object.setPrototypeOf?Object.setPrototypeOf(w,v):w.__proto__=v}}var d=f(2);var k=c(d);var r=f(3);var j=c(r);var u=f(4);var m=c(u);var p=f(5);var i=c(p);var l=f(12);var g=c(l);var s=(function(A){n(x,A);function x(E,C,B,D){h(this,x);b(Object.getPrototypeOf(x.prototype),"constructor",this).call(this);this._options={preferredRenderer:D};this._webglEnabled=false;this._renderer=null;this._image=E;this._stack=C;this._dimensions=new j["default"](B);this._initialDimensions=new m["default"](this._image.width,this._image.height);this._initRenderer()}o(x,[{key:"_initRenderer",value:function v(){var B=this;if(g["default"].isSupported()&&this._options.preferredRenderer!=="canvas"){this._renderer=new g["default"](this._initialDimensions,null,this._image);this._webglEnabled=true}else{if(i["default"].isSupported()){this._renderer=new i["default"](this._initialDimensions,null,this._image);this._webglEnabled=false}}if(this._renderer===null){throw new Error("Neither Canvas nor WebGL renderer are supported.")}this._renderer.on("error",function(C){return B.emit("error",C)})}},{key:"render",value:function z(){var F=this;var B=this.sanitizedStack;var G=this._renderer.getInitialDimensionsForStack(B,this._dimensions);this._renderer.resizeTo(G);this._renderer.drawImage(this._image);var E=[];for(var D=0;D<B.length;D++){var C=B[D];E.push(C.validateSettings())}return Promise.all(E).then(function(){var J=[];for(var I=0;I<B.length;I++){var H=B[I];J.push(H.render(F._renderer))}return Promise.all(J)}).then(function(){return F._renderer.renderFinal()}).then(function(){return F._renderer.postRender(F._dimensions)})}},{key:"getRenderer",value:function w(){return this._renderer}},{key:"sanitizedStack",get:function y(){var D=[];for(var C=0;C<this._stack.length;C++){var B=this._stack[C];if(!B){continue}D.push(B)}return D}}]);return x})(k["default"]);t["default"]=s;e.exports=t["default"]},function(e,b){Object.defineProperty(b,"__esModule",{value:true});var d=(function(){function i(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(l,j,k){if(j){i(l.prototype,j)}if(k){i(l,k)}return l}})();function h(i,j){if(!(i instanceof j)){throw new TypeError("Cannot call a class as a function")}}var g=12;function c(l){for(var i=arguments.length,j=Array(i>1?i-1:0),k=1;k<i;k++){j[k-1]=arguments[k]}console.error.apply(console,[l].concat(j));console.trace()}var f=(function(){function m(){h(this,m);this._maxListeners=g;this._events={}}d(m,[{key:"on",value:function i(p,q){if(typeof q!=="function"){throw new TypeError()}var o=this._events[p]||(this._events[p]=[]);if(o.indexOf(q)!==-1){return this}o.push(q);if(o.length>this._maxListeners){c("possible memory leak, added %i %s listeners,\n        use EventEmitter#setMaxListeners(number) if you\n        want to increase the limit (%i now)",o.length,p,this._maxListeners)}return this}},{key:"once",value:function l(p,r){var q=this;function o(){q.off(p,o);r.apply(null,arguments)}return this.on(p,o)}},{key:"off",value:function n(s){for(var o=arguments.length,q=Array(o>1?o-1:0),p=1;p<o;p++){q[p-1]=arguments[p]}if(q.length===0){this._events[s]=null;return this}var u=q[0];if(typeof u!=="function"){throw new TypeError()}var r=this._events[s];if(!r||!r.length){return this}var t=r.indexOf(u);if(t===-1){return this}r.splice(t,1);return this}},{key:"emit",value:function j(r){for(var s=arguments.length,p=Array(s>1?s-1:0),o=1;o<s;o++){p[o-1]=arguments[o]}var q=this._events[r];if(!q||!q.length){return false}q.forEach(function(t){return t.apply(null,p)});return true}},{key:"setMaxListeners",value:function k(o){if(parseInt(o,10)!==o){throw new TypeError()}this._maxListeners=o}}]);return m})();b["default"]=f;e.exports=b["default"]},function(e,c){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function g(l,j){for(var h=0;h<j.length;h++){var k=j[h];k.enumerable=k.enumerable||false;k.configurable=true;if("value" in k){k.writable=true}Object.defineProperty(l,k.key,k)}}return function(j,h,i){if(h){g(j.prototype,h)}if(i){g(j,i)}return j}})();function f(g,h){if(!(g instanceof h)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function g(k){f(this,g);this._modifiers={FIXED:"!"};this._dimensionsString=k;this._rules=this._parse();this._validateRules()}d(g,[{key:"_parse",value:function h(){if(typeof this._dimensionsString==="undefined"||this._dimensionsString===null){return null}var k=this._dimensionsString.match(/^([0-9]+)?x([0-9]+)?([\!])?$/i);if(!k){throw new Error("Invalid size option: "+this._dimensionsString)}return{x:isNaN(k[1])?null:parseInt(k[1],10),y:isNaN(k[2])?null:parseInt(k[2],10),modifier:k[3]}}},{key:"_validateRules",value:function i(){if(this._rules===null){return}var k=this._rules.x!==null;var l=this._rules.y!==null;if(this._rules.modifier===this._modifiers.FIXED&&!(k&&l)){throw new Error("Both `x` and `y` have to be set when using the fixed (!) modifier.")}if(!k&&!l){throw new Error("Neither `x` nor `y` are given.")}}},{key:"calculateFinalDimensions",value:function j(m){var l=m.clone(),k;if(this._rules===null){return l}if(this._rules.modifier===this._modifiers.FIXED){l.set(this._rules.x,this._rules.y)}else{if(this._rules.x!==null&&this._rules.y!==null){k=Math.min(this._rules.x/l.x,this._rules.y/l.y);l.multiply(k)}else{if(this._rules.x!==null){k=m.y/m.x;l.x=this._rules.x;l.y=l.x*k}else{if(this._rules.y!==null){k=m.x/m.y;l.y=this._rules.y;l.x=l.y*k}}}}return l}}]);return g})();c["default"]=b;e.exports=c["default"]},function(e,c){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function g(l,j){for(var h=0;h<j.length;h++){var k=j[h];k.enumerable=k.enumerable||false;k.configurable=true;if("value" in k){k.writable=true}Object.defineProperty(l,k.key,k)}}return function(j,h,i){if(h){g(j.prototype,h)}if(i){g(j,i)}return j}})();function f(g,h){if(!(g instanceof h)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function u(w,z){f(this,u);this.x=w;this.y=z;if(typeof this.x==="undefined"){this.x=0}if(typeof this.y==="undefined"){this.y=0}}d(u,[{key:"set",value:function q(w,z){this.x=w;this.y=z;return this}},{key:"clone",value:function o(){return new u(this.x,this.y)}},{key:"copy",value:function g(w){this.x=w.x;this.y=w.y;return this}},{key:"clamp",value:function n(x,z){var w=x!==null&&typeof x!=="undefined";var y=z!==null&&typeof z!=="undefined";if(!(x instanceof u)&&w){x=new u(x,x)}if(!(z instanceof u)&&y){z=new u(z,z)}if(w){this.x=Math.max(x.x,this.x);this.y=Math.max(x.y,this.y)}if(y){this.x=Math.min(z.x,this.x);this.y=Math.min(z.y,this.y)}return this}},{key:"divide",value:function k(x,w){if(x instanceof u){this.x/=x.x;this.y/=x.y}else{this.x/=x;this.y/=typeof w==="undefined"?x:w}return this}},{key:"subtract",value:function p(w,x){if(w instanceof u){this.x-=w.x;this.y-=w.y}else{this.x-=w;this.y-=typeof x==="undefined"?w:x}return this}},{key:"multiply",value:function h(w,x){if(w instanceof u){this.x*=w.x;this.y*=w.y}else{this.x*=w;this.y*=typeof x==="undefined"?w:x}return this}},{key:"add",value:function t(w,x){if(w instanceof u){this.x+=w.x;this.y+=w.y}else{this.x+=w;this.y+=typeof x==="undefined"?w:x}return this}},{key:"equals",value:function j(w,x){if(w instanceof u){return w.x===this.x&&w.y===this.y}else{return w===this.x&&x===this.y}}},{key:"flip",value:function l(){var w=this.x;this.x=this.y;this.y=w;return this}},{key:"round",value:function s(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}},{key:"ceil",value:function r(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this}},{key:"floor",value:function m(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this}},{key:"abs",value:function v(){this.x=Math.abs(this.x);this.y=Math.abs(this.y);return this}},{key:"toString",value:function i(){return"Vector2({ x: "+this.x+", y: "+this.y+" })"}}]);return u})();c["default"]=b;e.exports=c["default"]},function(c,i,b){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var k=function e(y,x,u){var v=true;_function:while(v){var s=y,A=x,r=u;t=z=w=undefined;v=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;u=r;v=true;continue _function}}else{if("value" in t){return t.value}else{var w=t.get;if(w===undefined){return undefined}return w.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function p(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var n=b(6);var f=q(n);var h=b(4);var l=q(h);var o=b(8);var d=q(o);var m=(function(w){p(B,w);function B(){j(this,B);k(Object.getPrototypeOf(B.prototype),"constructor",this).apply(this,arguments)}g(B,[{key:"cache",value:function r(F){this._cache[F]={data:this._context.getImageData(0,0,this._canvas.width,this._canvas.height),size:new l["default"](this._canvas.width,this._canvas.height)}}},{key:"drawCached",value:function E(F){var H=this._cache[F];var I=H.data;var G=H.size;this._canvas.width=G.x;this._canvas.height=G.y;this._context.putImageData(I,0,0)}},{key:"_getContext",value:function s(){return this._canvas.getContext("2d")}},{key:"drawImage",value:function u(F){this._context.drawImage(F,0,0,F.width,F.height,0,0,this._canvas.width,this._canvas.height);return d["default"].resolve()}},{key:"resizeTo",value:function x(G){G=G.clone().floor();if(this._canvas.width===G.x&&this._canvas.height===G.y){return}var F=this.createCanvas();F.width=G.x;F.height=G.y;var H=F.getContext("2d");H.drawImage(this._canvas,0,0,this._canvas.width,this._canvas.height,0,0,F.width,F.height);this.setCanvas(F)}},{key:"cloneCanvas",value:function C(){var F=this.createCanvas();var G=F.getContext("2d");F.width=this._canvas.width;F.height=this._canvas.height;G.drawImage(this._canvas,0,0);return F}},{key:"reset",value:function A(){var F=arguments.length<=0||arguments[0]===undefined?false:arguments[0];if(F){this._cache=[]}}},{key:"getInitialDimensionsForStack",value:function D(F,G){return new l["default"](this._image.width,this._image.height)}},{key:"setSize",value:function y(F){F=F.clone().floor();if(this._canvas.width===F.x&&this._canvas.height===F.y){return}this._canvas.width=F.x;this._canvas.height=F.y;this._size.copy(F)}},{key:"postRender",value:function z(G){var H=new l["default"](this._canvas.width,this._canvas.height);var F=G.calculateFinalDimensions(H);this.resizeTo(F)}}],[{key:"isSupported",value:function t(){var F=this.prototype.createCanvas();return !!(F.getContext&&F.getContext("2d"))}},{key:"identifier",get:function v(){return"canvas"}}]);return B})(f["default"]);i["default"]=m;c.exports=i["default"]},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function e(w,v,s){var t=true;_function:while(t){var q=w,y=v,p=s;r=x=u=undefined;t=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;s=p;t=true;continue _function}}else{if("value" in r){return r.value}else{var u=r.get;if(u===undefined){return undefined}return u.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var h=c(4);var l=o(h);var b=c(2);var m=o(b);var g=(function(z){n(w,z);function w(L,K,M){j(this,w);k(Object.getPrototypeOf(w.prototype),"constructor",this).call(this);this._size=new l["default"](M.width,M.height);this._canvas=K||this.createCanvas();if(!K){this.setSize(L)}this._context=this._getContext();this._cache={};this._image=M}f(w,[{key:"cache",value:function t(K){}},{key:"drawCached",value:function s(K){}},{key:"createCanvas",value:function D(O,L){var N=typeof window!=="undefined";var M;if(N){M=document.createElement("canvas")}else{var K=c(7);M=new K()}if(typeof O!=="undefined"){M.width=O}if(typeof L!=="undefined"){M.height=L}return M}},{key:"getSize",value:function q(){return new l["default"](this._canvas.width,this._canvas.height)}},{key:"_getContext",value:function x(){throw new Error("Renderer#_getContext is abstract and not implemented in inherited class.")}},{key:"resizeTo",value:function v(K){throw new Error("Renderer#resizeTo is abstract and not implemented in inherited class.")}},{key:"drawImage",value:function y(K){throw new Error("Renderer#drawImage is abstract and not implemented in inherited class.")}},{key:"renderFinal",value:function E(){}},{key:"getCanvas",value:function p(){return this._canvas}},{key:"getContext",value:function r(){return this._context}},{key:"setCanvas",value:function C(K){this._canvas=K;this._context=this._getContext();this.emit("new-canvas",this._canvas)}},{key:"getOutputDimensionsForStack",value:function H(K,M){var N=this;var L=new l["default"](this._image.width,this._image.height);K.forEach(function(O){L=O.getNewDimensions(N,L)});if(M){L=M.calculateFinalDimensions(L)}return L}},{key:"getInitialDimensionsForStack",value:function J(K,L){return this.getOutputDimensionsForStack(K,L)}},{key:"setContext",value:function A(K){this._context=K}},{key:"reset",value:function G(){var K=arguments.length<=0||arguments[0]===undefined?false:arguments[0]}},{key:"postRender",value:function u(K){}},{key:"setSize",value:function B(K){this._size.copy(K)}},{key:"identifier",get:function F(){return null}}],[{key:"isSupported",value:function I(){throw new Error("Renderer#isSupported is abstract and not implemented in inherited class.")}}]);return w})(m["default"]);i["default"]=g;d.exports=i["default"]},function(c,b){c.exports=a},function(c,b,d){(function(f){Object.defineProperty(b,"__esModule",{value:true});var e=typeof f!=="undefined"?f:typeof window!=="undefined"?window:null;var g=e.Promise;if(!g){g=d(9)}b["default"]=g;c.exports=b["default"]}.call(b,(function(){return this}())))},function(c,b,d){var e;(function(h,g){
/*!
	 * Native Promise Only
	 * v0.8.0-a (c) Kyle Simpson
	 * MIT License: http://getify.mit-license.org
	 * @license
	 */
"use strict";(function i(j,l,k){l[j]=l[j]||k();if(typeof c!="undefined"&&c.exports){c.exports=l[j]}else{if(true){!(e=function m(){return l[j]}.call(b,d,b,c),e!==undefined&&(c.exports=e))}}})("Promise",typeof h!="undefined"?h:undefined,function f(){var o,s,E,t=Object.prototype.toString,q=typeof g!="undefined"?function q(F){return g(F)}:setTimeout;try{Object.defineProperty({},"x",{});o=function o(H,G,I,F){return Object.defineProperty(H,G,{value:I,writable:true,configurable:F!==false})}}catch(n){o=function o(G,F,H){G[F]=H;return G}}E=(function C(){var K,I,H;function G(M,L){this.fn=M;this.self=L;this.next=void 0}return{add:function J(M,L){H=new G(M,L);if(I){I.next=H}else{K=H}I=H;H=void 0},drain:function F(){var L=K;K=I=s=void 0;while(L){L.fn.call(L.self);L=L.next}}}})();function A(G,F){E.add(G,F);if(!s){s=q(E.drain)}}function D(H){var G,F=typeof H;if(H!=null&&(F=="object"||F=="function")){G=H.then}return typeof G=="function"?G:false}function r(){for(var F=0;F<this.chain.length;F++){j(this,this.state===1?this.chain[F].success:this.chain[F].failure,this.chain[F])}this.chain.length=0}function j(G,F,I){var H,K;try{if(F===false){I.reject(G.msg)}else{if(F===true){H=G.msg}else{H=F.call(void 0,G.msg)}if(H===I.promise){I.reject(TypeError("Promise-chain cycle"))}else{if(K=D(H)){K.call(H,I.resolve,I.reject)}else{I.resolve(H)}}}}catch(J){I.reject(J)}}function w(I){var H,F=this;if(F.triggered){return}F.triggered=true;if(F.def){F=F.def}try{if(H=D(I)){A(function(){var K=new p(F);try{H.call(I,function M(){w.apply(K,arguments)},function J(){m.apply(K,arguments)})}catch(L){m.call(K,L)}})}else{F.msg=I;F.state=1;if(F.chain.length>0){A(r,F)}}}catch(G){m.call(new p(F),G)}}function m(G){var F=this;if(F.triggered){return}F.triggered=true;if(F.def){F=F.def}F.msg=G;F.state=2;if(F.chain.length>0){A(r,F)}}function u(J,G,I,H){for(var F=0;F<G.length;F++){(function K(L){J.resolve(G[L]).then(function M(N){I(L,N)},H)})(F)}}function p(F){this.def=F;this.triggered=false}function x(F){this.promise=F;this.state=0;this.triggered=false;this.chain=[];this.msg=void 0}function l(L){if(typeof L!="function"){throw TypeError("Not a function")}if(this.__NPO__!==0){throw TypeError("Not a promise")}this.__NPO__=1;var J=new x(this);this["then"]=function K(P,M){var O={success:typeof P=="function"?P:true,failure:typeof M=="function"?M:false};O.promise=new this.constructor(function N(R,Q){if(typeof R!="function"||typeof Q!="function"){throw TypeError("Not a function")}O.resolve=R;O.reject=Q});J.chain.push(O);if(J.state!==0){A(r,J)}return O.promise};this["catch"]=function G(M){return this.then(void 0,M)};try{L.call(void 0,function I(M){w.call(J,M)},function F(M){m.call(J,M)})}catch(H){m.call(J,H)}}var k=o({},"constructor",l,false);l.prototype=k;o(k,"__NPO__",0,false);o(l,"resolve",function z(G){var F=this;if(G&&typeof G=="object"&&G.__NPO__===1){return G}return new F(function H(J,I){if(typeof J!="function"||typeof I!="function"){throw TypeError("Not a function")}J(G)})});o(l,"reject",function B(F){return new this(function G(I,H){if(typeof I!="function"||typeof H!="function"){throw TypeError("Not a function")}H(F)})});o(l,"all",function v(F){var G=this;if(t.call(F)!="[object Array]"){return G.reject(TypeError("Not an array"))}if(F.length===0){return G.resolve([])}return new G(function H(M,L){if(typeof M!="function"||typeof L!="function"){throw TypeError("Not a function")}var I=F.length,K=Array(I),J=0;u(G,F,function N(O,P){K[O]=P;if(++J===I){M(K)}},L)})});o(l,"race",function y(F){var G=this;if(t.call(F)!="[object Array]"){return G.reject(TypeError("Not an array"))}return new G(function H(J,I){if(typeof J!="function"||typeof I!="function"){throw TypeError("Not a function")}u(G,F,function K(L,M){J(M)},I)})});return l})}.call(b,(function(){return this}()),d(10).setImmediate))},function(c,b,d){(function(h,i){var k=d(11).nextTick;var e=Function.prototype.apply;var j=Array.prototype.slice;var l={};var f=0;b.setTimeout=function(){return new g(e.call(setTimeout,window,arguments),clearTimeout)};b.setInterval=function(){return new g(e.call(setInterval,window,arguments),clearInterval)};b.clearTimeout=b.clearInterval=function(m){m.close()};function g(n,m){this._id=n;this._clearFn=m}g.prototype.unref=g.prototype.ref=function(){};g.prototype.close=function(){this._clearFn.call(window,this._id)};b.enroll=function(m,n){clearTimeout(m._idleTimeoutId);m._idleTimeout=n};b.unenroll=function(m){clearTimeout(m._idleTimeoutId);m._idleTimeout=-1};b._unrefActive=b.active=function(m){clearTimeout(m._idleTimeoutId);var o=m._idleTimeout;if(o>=0){m._idleTimeoutId=setTimeout(function n(){if(m._onTimeout){m._onTimeout()}},o)}};b.setImmediate=typeof h==="function"?h:function(o){var p=f++;var n=arguments.length<2?false:j.call(arguments,1);l[p]=true;k(function m(){if(l[p]){if(n){o.apply(null,n)}else{o.call(null)}b.clearImmediate(p)}});return p};b.clearImmediate=typeof i==="function"?i:function(m){delete l[m]}}.call(b,d(10).setImmediate,d(10).clearImmediate))},function(c,e){var b=c.exports={};var f=[];var j=false;var g;var h=-1;function i(){j=false;if(g.length){f=g.concat(f)}else{h=-1}if(f.length){l()}}function l(){if(j){return}var n=setTimeout(i);j=true;var m=f.length;while(m){g=f;f=[];while(++h<m){if(g){g[h].run()}}h=-1;m=f.length}g=null;j=false;clearTimeout(n)}b.nextTick=function(m){var n=new Array(arguments.length-1);if(arguments.length>1){for(var o=1;o<arguments.length;o++){n[o-1]=arguments[o]}}f.push(new d(m,n));if(f.length===1&&!j){setTimeout(l,0)}};function d(m,n){this.fun=m;this.array=n}d.prototype.run=function(){this.fun.apply(null,this.array)};b.title="browser";b.browser=true;b.env={};b.argv=[];b.version="";b.versions={};function k(){}b.on=k;b.addListener=k;b.once=k;b.off=k;b.removeListener=k;b.removeAllListeners=k;b.emit=k;b.binding=function(m){throw new Error("process.binding is not supported")};b.cwd=function(){return"/"};b.chdir=function(m){throw new Error("process.chdir is not supported")};b.umask=function(){return 0}},function(c,i,b){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var k=function e(y,v,u){var w=true;_function:while(w){var s=y,A=v,r=u;t=z=x=undefined;w=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;v=A;u=r;w=true;continue _function}}else{if("value" in t){return t.value}else{var x=t.get;if(x===undefined){return undefined}return x.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function p(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var m=b(6);var f=q(m);var h=b(4);var l=q(h);var o=b(8);var d=q(o);var n=(function(P){p(E,P);function E(){j(this,E);for(var U=arguments.length,V=Array(U),W=0;W<U;W++){V[W]=arguments[W]}k(Object.getPrototypeOf(E.prototype),"constructor",this).apply(this,V);this._contextLostCount=0;this._handleContextLoss();this._defaultProgram=this.setupGLSLProgram();this.reset();this.id=E.contextId;E.contextId++}g(E,[{key:"_handleContextLoss",value:function z(){var U=this;this._canvas.addEventListener("webglcontextlost",function(V){V.preventDefault();U._contextLostCount++;U.emit("error","context_lost")});this._canvas.addEventListener("webglcontextrestored",function(){if(U._contextLostCount>=3){return U.emit("error","context_lost_limit")}U.emit("reset");U.reset(true,true)})}},{key:"cache",value:function G(U){var X=undefined,W=undefined,V=undefined;if(!this._cache[U]){V=this._createFramebuffer()}else{V=this._cache[U]}X=V.fbo;W=V.texture;var Y=this._context;Y.useProgram(this._defaultProgram);this._setCoordinates(this._defaultProgram);Y.bindTexture(Y.TEXTURE_2D,W);Y.texImage2D(Y.TEXTURE_2D,0,Y.RGBA,this._size.x,this._size.y,0,Y.RGBA,Y.UNSIGNED_BYTE,null);Y.bindFramebuffer(Y.FRAMEBUFFER,X);Y.viewport(0,0,this._size.x,this._size.y);Y.bindTexture(Y.TEXTURE_2D,this._lastTexture);Y.drawArrays(Y.TRIANGLES,0,6);this._cache[U]={fbo:X,texture:W,size:this._size.clone()}}},{key:"drawCached",value:function C(Y){var ab=this._cache[Y];var Z=ab.texture;var ac=ab.size;var V=this.getCurrentFramebuffer();var aa=this.getCurrentTexture();var X=this._context;X.useProgram(this._defaultProgram);this._setCoordinates(this._defaultProgram);for(var W=0;W<this._textures.length;W++){var U=this._textures[W];X.bindTexture(X.TEXTURE_2D,U);X.texImage2D(X.TEXTURE_2D,0,X.RGBA,ac.x,ac.y,0,X.RGBA,X.UNSIGNED_BYTE,null)}X.bindFramebuffer(X.FRAMEBUFFER,V);X.bindTexture(X.TEXTURE_2D,aa);X.texImage2D(X.TEXTURE_2D,0,X.RGBA,ac.x,ac.y,0,X.RGBA,X.UNSIGNED_BYTE,null);X.bindTexture(X.TEXTURE_2D,Z);X.viewport(0,0,ac.x,ac.y);X.clear(X.COLOR_BUFFER_BIT|X.DEPTH_BUFFER_BIT);X.drawArrays(X.TRIANGLES,0,6);this.setLastTexture(aa);this.selectNextBuffer();this._size=ac.clone()}},{key:"_getContext",value:function K(){var U=this._canvas.getContext("webgl",this._contextOptions)||this._canvas.getContext("experimental-webgl",this._contextOptions);if(window.WebGLDebugUtils){U=window.WebGLDebugUtils.makeDebugContext(U)}U.disable(U.DEPTH_TEST);U.disable(U.CULL_FACE);this._maxTextureSize=U.getParameter(U.MAX_TEXTURE_SIZE);return U}},{key:"drawImage",value:function L(V){var U=this;var W=this._context;this._size=new l["default"](W.drawingBufferWidth,W.drawingBufferHeight);return new d["default"](function(ab,aa){W.useProgram(U._defaultProgram);U._setCoordinates(U._defaultProgram);var Z=U.getCurrentFramebuffer();var X=U.getCurrentTexture();W.bindFramebuffer(W.FRAMEBUFFER,Z);W.viewport(0,0,U._size.x,U._size.y);W.bindTexture(W.TEXTURE_2D,X);W.texImage2D(W.TEXTURE_2D,0,W.RGBA,U._size.x,U._size.y,0,W.RGBA,W.UNSIGNED_BYTE,null);var Y=U.createTexture();W.pixelStorei(W.UNPACK_FLIP_Y_WEBGL,true);U._inputTexture=Y;U.setLastTexture(Y);W.pixelStorei(W.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);W.texImage2D(W.TEXTURE_2D,0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,V);W.drawArrays(W.TRIANGLES,0,6);ab()})}},{key:"prepareImage",value:function D(Z){if(Z.width<=this._maxTextureSize&&Z.height<=this._maxTextureSize){return d["default"].resolve(Z)}var ab=new l["default"](this._maxTextureSize,this._maxTextureSize);var X=new l["default"](Z.width,Z.height);var aa=Math.min(ab.x/X.x,ab.y/X.y);var U=X.clone().multiply(aa);var V=this.createCanvas(U.x,U.y);var W=V.getContext("2d");W.drawImage(Z,0,0,X.x,X.y,0,0,U.x,U.y);var Y=V.toDataURL("image/jpeg");return new d["default"](function(ad,ac){var ae=new Image();ae.addEventListener("load",function(){ad(ae)});ae.src=Y})}},{key:"_clear",value:function x(U){U.clearColor(0,0,0,0);U.clear(U.COLOR_BUFFER_BIT)}},{key:"_setCoordinates",value:function A(Y,X,Z){var aa=this._context;var ab=aa.getAttribLocation(Y,"a_position");var U=aa.getAttribLocation(Y,"a_texCoord");X=X||new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]);var W=aa.createBuffer();aa.bindBuffer(aa.ARRAY_BUFFER,W);aa.bufferData(aa.ARRAY_BUFFER,X,aa.STATIC_DRAW);aa.enableVertexAttribArray(U);aa.vertexAttribPointer(U,2,aa.FLOAT,false,0,0);Z=Z||new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]);var V=aa.createBuffer();aa.bindBuffer(aa.ARRAY_BUFFER,V);aa.enableVertexAttribArray(ab);aa.vertexAttribPointer(ab,2,aa.FLOAT,false,0,0);aa.bufferData(aa.ARRAY_BUFFER,Z,aa.STATIC_DRAW)}},{key:"runProgram",value:function y(W,Y){var ab=this._context;ab.useProgram(W);this._setCoordinates(W,Y.textureCoordinates,Y.triangleCoordinates);var aa=this.getCurrentFramebuffer();var Z=this.getCurrentTexture();ab.bindFramebuffer(ab.FRAMEBUFFER,aa);ab.viewport(0,0,this._size.x,this._size.y);ab.bindTexture(ab.TEXTURE_2D,Z);ab.pixelStorei(ab.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);ab.texImage2D(ab.TEXTURE_2D,0,ab.RGBA,this._size.x,this._size.y,0,ab.RGBA,ab.UNSIGNED_BYTE,null);ab.bindTexture(ab.TEXTURE_2D,this._lastTexture);for(var X in Y.uniforms){var V=ab.getUniformLocation(W,X);var U=Y.uniforms[X];switch(U.type){case"i":case"1i":ab.uniform1i(V,U.value);break;case"f":case"1f":ab.uniform1f(V,U.value);break;case"2f":ab.uniform2f(V,U.value[0],U.value[1]);break;case"3f":ab.uniform3f(V,U.value[0],U.value[1],U.value[2]);break;case"4f":ab.uniform4f(V,U.value[0],U.value[1],U.value[2],U.value[3]);break;case"2fv":ab.uniform2fv(V,U.value);break;case"mat3fv":ab.uniformMatrix3fv(V,false,U.value);break;default:throw new Error("Unknown uniform type: "+U.type)}}ab.clear(ab.COLOR_BUFFER_BIT|ab.DEPTH_BUFFER_BIT);ab.drawArrays(ab.TRIANGLES,0,6);this.setLastTexture(Z);this.selectNextBuffer()}},{key:"runShader",value:function J(X,U,W){if(typeof W==="undefined"){W={}}if(typeof W.uniforms==="undefined"){W.uniforms={}}var V=this.setupGLSLProgram(X,U);this.runProgram(V,W)}},{key:"renderFinal",value:function N(){var V=this._context;var U=this._defaultProgram;V.useProgram(U);V.bindFramebuffer(V.FRAMEBUFFER,null);V.viewport(0,0,V.drawingBufferWidth,V.drawingBufferHeight);V.bindTexture(V.TEXTURE_2D,this._lastTexture);this._clear(V);V.drawArrays(V.TRIANGLES,0,6)}},{key:"setupGLSLProgram",value:function v(ab,W,V){var Z=this._context;var ac=[];ab=this._createShader(Z.VERTEX_SHADER,ab||E.prototype.defaultVertexShader);ac.push(ab);W=this._createShader(Z.FRAGMENT_SHADER,W||E.prototype.defaultFragmentShader);ac.push(W);var Y=Z.createProgram();for(var X=0;X<ac.length;X++){Z.attachShader(Y,ac[X])}Z.linkProgram(Y);var U=Z.getProgramParameter(Y,Z.LINK_STATUS);if(!U){var aa=Z.getProgramInfoLog(Y);Z.deleteProgram(Y);throw new Error("WebGL program linking error: "+aa)}return Y}},{key:"_createShader",value:function s(X,Z){var W=this._context;var U=W.createShader(X);W.shaderSource(U,Z);W.compileShader(U);var V=W.getShaderParameter(U,W.COMPILE_STATUS);if(!V){var Y=W.getShaderInfoLog(U);W.deleteShader(U);throw new Error("WebGL shader compilation error: "+Y)}return U}},{key:"createTexture",value:function t(){var V=this._context;var U=V.createTexture();V.bindTexture(V.TEXTURE_2D,U);V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE);V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE);V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.NEAREST);V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.NEAREST);return U}},{key:"_createFramebuffers",value:function F(){for(var U=0;U<2;U++){var X=this._createFramebuffer();var W=X.fbo;var V=X.texture;this._textures.push(V);this._framebuffers.push(W)}}},{key:"_createFramebuffer",value:function M(){var W=this._context;var V=this.createTexture();W.pixelStorei(W.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);W.texImage2D(W.TEXTURE_2D,0,W.RGBA,this._size.x,this._size.y,0,W.RGBA,W.UNSIGNED_BYTE,null);var U=W.createFramebuffer();W.bindFramebuffer(W.FRAMEBUFFER,U);W.framebufferTexture2D(W.FRAMEBUFFER,W.COLOR_ATTACHMENT0,W.TEXTURE_2D,V,0);return{fbo:U,texture:V}}},{key:"resizeTo",value:function I(U){var V=this._context;this._canvas.width=U.x;this._canvas.height=U.y}},{key:"getCurrentFramebuffer",value:function B(){return this._framebuffers[this._bufferIndex%2]}},{key:"getCurrentTexture",value:function w(){return this._textures[this._bufferIndex%2]}},{key:"selectNextBuffer",value:function r(){this._bufferIndex++}},{key:"getDefaultProgram",value:function H(){return this._defaultProgram}},{key:"getLastTexture",value:function S(){return this._lastTexture}},{key:"getTextures",value:function u(){return this._textures}},{key:"setLastTexture",value:function R(U){this._lastTexture=U}},{key:"reset",value:function Q(){var U=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var V=arguments.length<=1||arguments[1]===undefined?false:arguments[1];this._lastTexture=null;this._textures=[];this._framebuffers=[];this._bufferIndex=0;if(U){this._cache=[]}if(V){this._inputTexture=null;this._context=this._getContext();this._defaultProgram=this.setupGLSLProgram()}this._createFramebuffers();this.setLastTexture(this._inputTexture)}},{key:"_contextOptions",get:function O(){return{alpha:true,premultipliedAlpha:true}}},{key:"identifier",get:function O(){return"webgl"}},{key:"defaultVertexShader",get:function O(){var U="\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      varying vec2 v_texCoord;\n\n      void main() {\n        gl_Position = vec4(a_position, 0, 1);\n        v_texCoord = a_texCoord;\n      }\n    ";return U}},{key:"defaultFragmentShader",get:function O(){var U="\n      precision mediump float;\n      uniform sampler2D u_image;\n      varying vec2 v_texCoord;\n\n      void main() {\n        gl_FragColor = texture2D(u_image, v_texCoord);\n      }\n    ";return U}},{key:"maxTextureSize",get:function O(){return this._maxTextureSize}}],[{key:"isSupported",value:function T(){if(typeof window==="undefined"){return false}var U=document.createElement("canvas");var V=U.getContext("webgl")||U.getContext("experimental-webgl");return !!V}}]);return E})(f["default"]);n.contextId=0;i["default"]=n;c.exports=i["default"]},function(c,b,d){(function(e){Object.defineProperty(b,"__esModule",{value:true});var j=(function(){function q(u,s){for(var r=0;r<s.length;r++){var t=s[r];t.enumerable=t.enumerable||false;t.configurable=true;if("value" in t){t.writable=true}Object.defineProperty(u,t.key,t)}}return function(t,r,s){if(r){q(t.prototype,r)}if(s){q(t,s)}return t}})();function o(q){return q&&q.__esModule?q:{"default":q}}function l(q,r){if(!(q instanceof r)){throw new TypeError("Cannot call a class as a function")}}var f=d(14);var p=d(15);var g=o(p);var n=d(8);var h=o(n);var m=d(18);var i=o(m);var k=(function(){function s(){l(this,s)}j(s,null,[{key:"validateSettings",value:function r(u,v){var t={renderType:u,imageFormat:v};if(typeof t.renderType!=="undefined"&&t.renderType!==null&&g["default"].values(f.RenderType).indexOf(t.renderType)===-1){throw new Error("Invalid render type: "+t.renderType)}else{if(typeof u==="undefined"){t.renderType=f.RenderType.DATAURL}}if(typeof t.imageFormat!=="undefined"&&t.imageFormat!==null&&g["default"].values(f.ImageFormat).indexOf(t.imageFormat)===-1){throw new Error("Invalid image format: "+t.imageFormat)}else{if(typeof v==="undefined"){t.imageFormat=f.ImageFormat.PNG}}if(t.renderType===f.RenderType.BUFFER&&typeof e==="undefined"){throw new Error("Render type 'buffer' is only available when using node.js")}return t}},{key:"export",value:function q(v,x,t,u,w){var y=arguments.length<=5||arguments[5]===undefined?0.8:arguments[5];return new h["default"](function(E,D){var z=undefined;if(u===f.RenderType.IMAGE||u===f.RenderType.DATAURL){if(typeof window==="undefined"){z=t.toDataURL(w)}else{z=t.toDataURL(w,y)}if(i["default"].isJPEG(x.src)&&i["default"].isJPEG(z)){var C=v.exif;if(C){z=C.restoreExifTags(z)}}}if(u===f.RenderType.IMAGE){var A=undefined;if(typeof window==="undefined"){var B=d(7).Image;A=new B()}else{A=new Image()}A.src=z;E(A)}else{if(u===f.RenderType.DATAURL){E(z)}else{if(u===f.RenderType.BUFFER){E(t.toBuffer())}else{if(u===f.RenderType.MSBLOB){E(t.msToBlob())}else{if(u===f.RenderType.BLOB){t.toBlob(function(F){E(F)},w,y)}}}}}})}}]);return s})();b["default"]=k;c.exports=b["default"]}.call(b,d(11)))},function(e,d){Object.defineProperty(d,"__esModule",{value:true});var c={IMAGE:"image",DATAURL:"data-url",BUFFER:"buffer",BLOB:"blob",MSBLOB:"ms-blob"};d.RenderType=c;var b={PNG:"image/png",JPEG:"image/jpeg"};d.ImageFormat=b},function(e,i,d){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function o(s,q){for(var p=0;p<q.length;p++){var r=q[p];r.enumerable=r.enumerable||false;r.configurable=true;if("value" in r){r.writable=true}Object.defineProperty(s,r.key,r)}}return function(r,p,q){if(p){o(r.prototype,p)}if(q){o(r,q)}return r}})();function n(o){return o&&o.__esModule?o:{"default":o}}function j(o,p){if(!(o instanceof p)){throw new TypeError("Cannot call a class as a function")}}var c=d(16);var m=n(c);var b=d(4);var l=n(b);var h=d(17);var f=n(h);var k=(function(){function u(){j(this,u)}g(u,null,[{key:"isArray",value:function s(B){return Object.prototype.toString.call(B)==="[object Array]"}},{key:"select",value:function x(C){var B=arguments.length<=1||arguments[1]===undefined?null:arguments[1];if(B===null){return C}if(typeof B==="string"){B=B.split(",").map(function(D){return D.trim()})}if(u.isArray(B)){B={only:B}}if(typeof B.only!=="undefined"){if(typeof B.only==="string"){B.only=B.only.split(",").map(function(D){return D.trim()})}return C.filter(function(D){return B.only.indexOf(D)!==-1})}else{if(typeof B.except!=="undefined"){if(typeof B.except==="string"){B.except=B.except.split(",").map(function(D){return D.trim()})}return C.filter(function(D){return B.except.indexOf(D)===-1})}}throw new Error("Utils#select failed to filter items.")}},{key:"values",value:function y(C){var B=[];for(var D in C){B.push(C[D])}return B}},{key:"isDOMElement",value:function p(B){return typeof HTMLElement==="object"?B instanceof HTMLElement:B&&typeof B==="object"&&B!==null&&B.nodeType===1&&typeof B.nodeName==="string"}},{key:"getEventPosition",value:function w(C){var B=C.clientX;var D=C.clientY;if(C.type.indexOf("touch")!==-1){B=C.touches[0].clientX;D=C.touches[0].clientY}return new l["default"](B,D)}},{key:"isTouchEvent",value:function A(B){return B.type.indexOf("touch")!==-1}},{key:"resizeVectorToFit",value:function t(C,B){var E=Math.min(B.x/C.x,B.y/C.y);var D=C.clone().multiply(E);return D}},{key:"defaults",value:function r(D){var G={};for(var F in D){G[F]=D[F]}for(var B=arguments.length,C=Array(B>1?B-1:0),H=1;H<B;H++){C[H-1]=arguments[H]}for(var E=0;E<C.length;E++){var I=C[E];for(var F in I){if(typeof G[F]==="undefined"){G[F]=I[F]}}}return G}},{key:"extend",value:function v(E){var H={};for(var G in E){H[G]=E[G]}for(var B=arguments.length,D=Array(B>1?B-1:0),C=1;C<B;C++){D[C-1]=arguments[C]}for(var F=0;F<D.length;F++){var I=D[F];for(var G in I){H[G]=I[G]}}return H}},{key:"fetch",value:function o(C,G,B){G=G.replace(/\[(\w+)\]/g,".$1");G=G.replace(/^\./,"");var F=G.split(".");for(var D=0;D<F.length;D++){var E=F[D];C=C[E];if(!C){break}}if(typeof C==="undefined"){C=B}return C}},{key:"createBlobURIFromDataURI",value:function z(F){if(!window.Blob||!window.URL||!ArrayBuffer||!Uint8Array){return F}var H=m["default"].decode(F.split(",")[1]);var B=F.split(",")[0].split(":")[1].split(";")[0];var E=new ArrayBuffer(H.length);var G=new Uint8Array(E);for(var D=0;D<H.length;D++){G[D]=H[D]}var C=new window.Blob([E],{type:B});return window.URL.createObjectURL(C)}},{key:"classList",value:function q(B){return new f["default"](B)}}]);return u})();i["default"]=k;e.exports=i["default"]},function(d,c){
/*!
	 * Extracted from MinifyJpeg (Copyright (c) 2014 Hiroaki Matoba, MIT License):
	 * https://github.com/hMatoba/MinifyJpeg
	 */
"use strict";Object.defineProperty(c,"__esModule",{value:true});var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";c["default"]={encode:function e(j){var g="",q=undefined,o=undefined,m="",p=undefined,n=undefined,l=undefined,k="",h=0;do{q=j[h++];o=j[h++];m=j[h++];p=q>>2;n=(q&3)<<4|o>>4;l=(o&15)<<2|m>>6;k=m&63;if(isNaN(o)){l=k=64}else{if(isNaN(m)){k=64}}g=g+b.charAt(p)+b.charAt(n)+b.charAt(l)+b.charAt(k);q=o=m="";p=n=l=k=""}while(h<j.length);return g},decode:function f(k){var r=undefined,p=undefined,n="",q=undefined,o=undefined,m=undefined,l="",j=0,h=[];var g=/[^A-Za-z0-9\+\/\=]/g;if(g.exec(k)){throw new Error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.")}k=k.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{q=b.indexOf(k.charAt(j++));o=b.indexOf(k.charAt(j++));m=b.indexOf(k.charAt(j++));l=b.indexOf(k.charAt(j++));r=q<<2|o>>4;p=(o&15)<<4|m>>2;n=(m&3)<<6|l;h.push(r);if(m!==64){h.push(p)}if(l!==64){h.push(n)}r=p=n="";q=o=m=l=""}while(j<k.length);return h}};d.exports=c["default"]},function(d,b){Object.defineProperty(b,"__esModule",{value:true});var c=(function(){function g(l,j){for(var h=0;h<j.length;h++){var k=j[h];k.enumerable=k.enumerable||false;k.configurable=true;if("value" in k){k.writable=true}Object.defineProperty(l,k.key,k)}}return function(j,h,i){if(h){g(j.prototype,h)}if(i){g(j,i)}return j}})();function e(g,h){if(!(g instanceof h)){throw new TypeError("Cannot call a class as a function")}}var f=(function(){function i(j){e(this,i);this._el=j}c(i,[{key:"add",value:function h(j){var k=this._el.className.split(" ");k.push(j);this._el.className=k.join(" ")}},{key:"remove",value:function g(j){var k=this._el.className.split(" ");k=k.filter(function(l){return l!==j});this._el.className=k.join(" ")}}]);return i})();b["default"]=f;d.exports=b["default"]},function(e,h,d){
/*!
	 * Based on https://github.com/exif-js/exif-js by Jacob Seidelin
	 * Licensed under MIT
	 */
"use strict";Object.defineProperty(h,"__esModule",{value:true});var n=(function(){function q(v,u){var y=[];var r=true;var x=false;var w=undefined;try{for(var t=v[Symbol.iterator](),z;!(r=(z=t.next()).done);r=true){y.push(z.value);if(u&&y.length===u){break}}}catch(s){x=true;w=s}finally{try{if(!r&&t["return"]){t["return"]()}}finally{if(x){throw w}}}return y}return function(r,s){if(Array.isArray(r)){return r}else{if(Symbol.iterator in Object(r)){return q(r,s)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}})();var g=(function(){function q(u,s){for(var r=0;r<s.length;r++){var t=s[r];t.enumerable=t.enumerable||false;t.configurable=true;if("value" in t){t.writable=true}Object.defineProperty(u,t.key,t)}}return function(t,r,s){if(r){q(t.prototype,r)}if(s){q(t,s)}return t}})();function p(q){return q&&q.__esModule?q:{"default":q}}function i(q,r){if(!(q instanceof r)){throw new TypeError("Cannot call a class as a function")}}var b=d(16);var m=p(b);var f=d(19);var j=p(f);var l={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"};var o="data:image/jpeg;base64,";var k=new RegExp("^"+o,"i");var c=(function(){function r(B){i(this,r);this._buf=B;this._stream=new j["default"](this._buf);this._stream.setHead(0);this._segments=this._sliceIntoSegments(this._buf);this._exifBuffer=this._getExifBuffer();this._exifStream=new j["default"](this._exifBuffer);this._parseExif()}g(r,[{key:"getTags",value:function A(){return this._tags}},{key:"getTagData",value:function u(){return this._tagData}},{key:"restoreExifTags",value:function q(F){var I=F.replace(o,"");var E=m["default"].decode(I);var G=this._sliceIntoSegments(E);var D=n(G[1],2);var J=D[0];var B=D[1];var H=E.slice(0,J);var C=E.slice(J);var K=H.concat(this._exifBuffer);K=K.concat(C);return o+m["default"].encode(K)}},{key:"setOrientation",value:function z(B){if(this._tagData.Orientation){var C=this._tagData.Orientation.entryOffset;this._exifStream.setHead(C+8);this._exifStream.writeInt16(B)}}},{key:"_parseExif",value:function w(){this._exifStream.setHead(0);this._exifStream.readInt16();this._exifStream.readInt16();var H=this._exifStream.readString(4);if(H!=="Exif"){return}this._exifStream.readInt16();var F=this._exifStream.getHead();var G=false;var B=this._exifStream.readInt16();if(B===18761){G=false}else{if(B===19789){G=true}else{throw new Error("Invalid TIFF data: No endian type found")}}if(this._exifStream.readInt16(!G)!==42){throw new Error("Invalid TIFF data: No 0x002A")}var C=this._exifStream.readInt32(!G);if(C<8){throw new Error("Invalid TIFF data: First IFD offset < 8")}var E=F+C;var D=this._readTags(this._exifStream,F,E,G);this._tags=D.tags;this._tagData=D.tagData}},{key:"_readTags",value:function x(K,C,O,Q){K.setHead(O);var M=K.readInt16(!Q);var N={};var E=[];for(var R=0;R<M;R++){var D=O+R*12+2;K.setHead(D);var V=K.readInt16(!Q);var H=undefined;var L=undefined;var S=undefined;if(l[V]){V=l[V];H=K.readInt16(!Q);L=K.readInt32(!Q);S=K.readInt32(!Q)+C;var P=null;switch(H){case 1:case 7:if(L===1){P=K.readInt8(!Q)}else{P=[];for(var F=0;F<L;F++){P.push(K.readInt8(!Q))}}break;case 2:K.setHead(L>4?S:D+8);P=K.readString(L);break;case 3:K.setHead(L>2?S:D+8);if(L===1){P=K.readInt16(!Q)}else{P=[];for(var J=0;J<L;J++){P.push(K.readInt16(!Q))}}break;case 4:case 9:K.setHead(L>1?S:D+8);if(L===1){P=K.readInt32(!Q)}else{P=[];for(var I=0;I<L;I++){P.push(K.readInt32(!Q))}}break;case 5:case 10:K.setHead(S);if(L===1){var T=K.readInt32(!Q);var B=K.readInt32(!Q);P=T/B}else{P=[];for(var G=0;G<L;G++){var T=K.readInt32(!Q);var B=K.readInt32(!Q);var U=T/B;P.push(U)}}break}N[V]=P;E[V]={value:P,numValues:L,entryOffset:D,valueOffset:S,type:H}}}return{tags:N,tagData:E}}},{key:"_getExifBuffer",value:function v(){var E=this._segments;for(var F=0;F<E.length;F++){var B=n(E[F],2);var G=B[0];var D=B[1];this._stream.setHead(G);var C=this._stream.peekInt16();if(C===65505){return this._buf.slice(G,D)}}return false}},{key:"_sliceIntoSegments",value:function y(E){var F=new j["default"](E);var D=[];while(F.getHead()<E.length){var C=F.readInt16();if(C===65496){continue}if(C===65498){break}if(C>=65280&&C<=65535){var G=F.readInt16();var B=F.getHead()+G-2;D.push([F.getHead()-4,B]);F.setHead(B)}else{throw new Error("Invalid marker: 0x"+C.toString(16))}}this._stream.setHead(0);return D}}],[{key:"isJPEG",value:function t(B){return k.test(B)}},{key:"fromBase64String",value:function s(D){var B=D.replace(o,"");var C=m["default"].decode(B);return new r(C)}}]);return r})();h["default"]=c;e.exports=h["default"]},function(d,b){Object.defineProperty(b,"__esModule",{value:true});var c=(function(){function g(l,j){for(var h=0;h<j.length;h++){var k=j[h];k.enumerable=k.enumerable||false;k.configurable=true;if("value" in k){k.writable=true}Object.defineProperty(l,k.key,k)}}return function(j,h,i){if(h){g(j.prototype,h)}if(i){g(j,i)}return j}})();function f(g,h){if(!(g instanceof h)){throw new TypeError("Cannot call a class as a function")}}var e=(function(){function l(t){f(this,l);this._head=0;this._buf=t}c(l,[{key:"getHead",value:function p(){return this._head}},{key:"setHead",value:function i(t){this._head=t}},{key:"peekInt8",value:function m(){return this._buf[this._head]}},{key:"peekInt16",value:function n(){var v=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var u=this._buf[this._head];var t=this._buf[this._head+1];if(!v){return(u<<8)+t}else{return(t<<8)+u}}},{key:"peekInt24",value:function j(){var v=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var u=this._buf[this._head];var t=this._buf[this._head+1];var w=this._buf[this._head+2];if(!v){return(u<<16)+(t<<8)+w}else{return(w<<16)+(t<<8)+u}}},{key:"peekInt32",value:function g(){var v=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var u=this._buf[this._head];var t=this._buf[this._head+1];var x=this._buf[this._head+2];var w=this._buf[this._head+3];if(!v){return(u<<32)+(t<<16)+(x<<8)+w}else{return(w<<32)+(x<<16)+(t<<8)+u}}},{key:"writeInt16",value:function s(t){this._buf[this._head]=t>>8;this._buf[this._head+1]=t&255}},{key:"readInt8",value:function k(){var t=this.peekInt8();this._head+=1;return t}},{key:"readInt16",value:function h(){var u=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var t=this.peekInt16(u);this._head+=2;return t}},{key:"readInt24",value:function r(){var u=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var t=this.peekInt24(u);this._head+=3;return t}},{key:"readInt32",value:function o(){var u=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var t=this.peekInt32(u);this._head+=4;return t}},{key:"readString",value:function q(u){var w="";for(var t=0;t<u;t++){var v=this.readInt8();w+=String.fromCharCode(v)}return w}}]);return l})();b["default"]=e;d.exports=b["default"]},function(e,b){Object.defineProperty(b,"__esModule",{value:true});var d=(function(){function i(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(l,j,k){if(j){i(l.prototype,j)}if(k){i(l,k)}return l}})();function g(i,j){if(!(i instanceof j)){throw new TypeError("Cannot call a class as a function")}}var c="imglySDKVersionCallback";var h="https://www.photoeditorsdk.com/version.json?sdk=html5&jsoncallback="+c;var f=(function(){function j(k){g(this,j);this._version=k;this._check()}d(j,[{key:"_check",value:function i(){var l=this;window[c]=function(m){if(m.outdated){console.warn("imgly-sdk-html5: Your version "+l._version+" is outdated.");console.warn("imgly-sdk-html5: Current version is "+m.version+".")}};var k=document.createElement("script");k.src=h+"&version="+this._version;k.async=true;document.getElementsByTagName("head")[0].appendChild(k)}}]);return j})();b["default"]=f;e.exports=b["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function q(u,s){for(var r=0;r<s.length;r++){var t=s[r];t.enumerable=t.enumerable||false;t.configurable=true;if("value" in t){t.writable=true}Object.defineProperty(u,t.key,t)}}return function(t,r,s){if(r){q(t.prototype,r)}if(s){q(t,s)}return t}})();var j=function d(x,w,v){var t=true;_function:while(t){var r=x,z=w,q=v;s=y=u=undefined;t=false;if(r===null){r=Function.prototype}var s=Object.getOwnPropertyDescriptor(r,z);if(s===undefined){var y=Object.getPrototypeOf(r);if(y===null){return undefined}else{x=y;w=z;v=q;t=true;continue _function}}else{if("value" in s){return s.value}else{var u=s.get;if(u===undefined){return undefined}return u.call(q)}}}};function o(q){return q&&q.__esModule?q:{"default":q}}function i(q,r){if(!(q instanceof r)){throw new TypeError("Cannot call a class as a function")}}function n(r,q){if(typeof q!=="function"&&q!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof q)}r.prototype=Object.create(q&&q.prototype,{constructor:{value:r,enumerable:false,writable:true,configurable:true}});if(q){Object.setPrototypeOf?Object.setPrototypeOf(r,q):r.__proto__=q}}var l=b(22);var m=o(l);var g=b(4);var k=o(g);var p=(function(t){n(s,t);function s(){i(this,s);for(var v=arguments.length,w=Array(v),x=0;x<v;x++){w[x]=arguments[x]}j(Object.getPrototypeOf(s.prototype),"constructor",this).apply(this,w);this.vertexShader="\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      varying vec2 v_texCoord;\n      uniform mat3 u_matrix;\n\n      void main() {\n        gl_Position = vec4((u_matrix * vec3(a_position, 1)).xy, 0, 1);\n        v_texCoord = a_texCoord;\n      }\n    "}f(s,[{key:"_renderWebGL",value:function q(z){var v=this._options.degrees%360;var w=this.getNewDimensions(z);var A=v*(Math.PI/180);var B=Math.cos(A);var y=Math.sin(A);var x=[B,-y,0,y,B,0,0,0,1];z.runShader(this.vertexShader,null,{uniforms:{u_matrix:{type:"mat3fv",value:x}}})}},{key:"_renderCanvas",value:function r(A){var x=A.getCanvas();var v=this._options.degrees%360;var w=this.getNewDimensions(A);var y=A.createCanvas();y.width=w.x;y.height=w.y;var B=y.getContext("2d");B.save();B.translate(y.width/2,y.height/2);B.rotate(v*(Math.PI/180));var z=A.cloneCanvas();B.drawImage(z,-x.width/2,-x.height/2);B.restore();A.setCanvas(y)}},{key:"getNewDimensions",value:function u(x,w){w=w||x.getSize();var v=this._options.degrees%360;if(v%180!==0){w.flip()}return w}}]);return s})(m["default"]);p.prototype.identifier="rotation";p.prototype.availableOptions={degrees:{type:"number","default":0,validation:function e(q){if(q%90!==0){throw new Error("RotationOperation: `rotation` has to be a multiple of 90.")}}}};h["default"]=p;c.exports=h["default"]},function(d,w,g){Object.defineProperty(w,"__esModule",{value:true});var r=(function(){function x(B,z){for(var y=0;y<z.length;y++){var A=z[y];A.enumerable=A.enumerable||false;A.configurable=true;if("value" in A){A.writable=true}Object.defineProperty(B,A.key,A)}}return function(A,y,z){if(y){x(A.prototype,y)}if(z){x(A,z)}return A}})();var b=function u(E,D,A){var B=true;_function:while(B){var y=E,G=D,x=A;z=F=C=undefined;B=false;if(y===null){y=Function.prototype}var z=Object.getOwnPropertyDescriptor(y,G);if(z===undefined){var F=Object.getPrototypeOf(y);if(F===null){return undefined}else{E=F;D=G;A=x;B=true;continue _function}}else{if("value" in z){return z.value}else{var C=z.get;if(C===undefined){return undefined}return C.call(x)}}}};function c(x){return x&&x.__esModule?x:{"default":x}}function j(x,y){if(!(x instanceof y)){throw new TypeError("Cannot call a class as a function")}}function o(y,x){if(typeof x!=="function"&&x!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof x)}y.prototype=Object.create(x&&x.prototype,{constructor:{value:y,enumerable:false,writable:true,configurable:true}});if(x){Object.setPrototypeOf?Object.setPrototypeOf(y,x):y.__proto__=x}}var m=g(4);var e=c(m);var t=g(23);var h=c(t);var v=g(15);var q=c(v);var s=g(2);var k=c(s);var l=g(8);var f=c(l);var i=g(24);var p=c(i);var n=(function(x){o(E,x);function E(M,L){j(this,E);b(Object.getPrototypeOf(E.prototype),"constructor",this).call(this);this._kit=M;this.availableOptions=q["default"].extend(this.availableOptions||{},{numberFormat:{type:"string","default":"relative",available:["absolute","relative"]}});this._dirty=true;this._glslPrograms={};this._uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(P){var O=Math.random()*16|0;var N=P==="x"?O:O&3|8;return N.toString(16)});this._initOptions(L||{})}r(E,[{key:"validateSettings",value:function G(){var M=this;var L=this.identifier;return new f["default"](function(Q,P){for(var O in M.availableOptions){var N=M.availableOptions[O];if(N.required&&typeof M._options[O]==="undefined"){return P(new Error("Operation `"+L+"`: Option `"+O+"` is required."))}}Q()})}},{key:"render",value:function z(M){var L=undefined;if(M.identifier==="webgl"){L=this._renderWebGL.bind(this)}else{L=this._renderCanvas.bind(this)}if(this._dirty){L(M);M.cache(this._uuid);this._dirty=false}else{M.drawCached(this._uuid)}}},{key:"_renderWebGL",value:function C(){throw new Error("Operation#_renderWebGL is abstract and not implemented in inherited class.")}},{key:"_renderCanvas",value:function y(){throw new Error("Operation#_renderCanvas is abstract and not implemented in inherited class.")}},{key:"_initOptions",value:function J(Q){this._options={};var M,O,P;var L=this;for(M in this.availableOptions){P=M.charAt(0).toUpperCase()+M.slice(1);O=this.availableOptions[M];var N=function N(R,S){L["set"+P]=function(T){L._setOption(R,T)};L["get"+P]=function(){return L._getOption(R)}};N(M,O);if(typeof O["default"]!=="undefined"){this["set"+P](O["default"])}}for(M in Q){if(typeof this.availableOptions[M]==="undefined"){throw new Error("Invalid option: "+M)}P=M.charAt(0).toUpperCase()+M.slice(1);this["set"+P](Q[M])}}},{key:"set",value:function I(L){for(var M in L){this._setOption(M,L[M],false)}this.emit("update")}},{key:"_getOption",value:function K(L){return this._options[L]}},{key:"_setOption",value:function B(N,P){var Q=arguments.length<=2||arguments[2]===undefined?true:arguments[2];var L=this.availableOptions[N];var M=this.identifier;if(typeof L.setter!=="undefined"){P=L.setter.call(this,P)}if(typeof L.validation!=="undefined"){L.validation(P)}switch(L.type){case"string":if(typeof P!=="string"){throw new Error("Operation `"+M+"`: Option `"+N+"` has to be a string.")}var O=L.available;if(typeof O!=="undefined"&&O.indexOf(P)===-1){throw new Error("Operation `"+M+"`: Invalid value for `"+N+"` (valid values are: "+L.available.join(", ")+")")}this._options[N]=P;break;case"number":if(typeof P!=="number"){throw new Error("Operation `"+M+"`: Option `"+N+"` has to be a number.")}this._options[N]=P;break;case"boolean":if(typeof P!=="boolean"){throw new Error("Operation `"+M+"`: Option `"+N+"` has to be a boolean.")}this._options[N]=P;break;case"vector2":if(!(P instanceof e["default"])){throw new Error("Operation `"+M+"`: Option `"+N+"` has to be an instance of ImglyKit.Vector2.")}this._options[N]=P.clone();break;case"color":if(!(P instanceof h["default"])){throw new Error("Operation `"+M+"`: Option `"+N+"` has to be an instance of ImglyKit.Color.")}this._options[N]=P;break;case"object":this._options[N]=P;break;case"array":this._options[N]=P.slice(0);break}this._dirty=true;if(Q){this.emit("update")}}},{key:"getNewDimensions",value:function D(N,M){var L=N.getCanvas();M=M||new e["default"](L.width,L.height);return M}},{key:"_onDirty",value:function H(){}},{key:"reset",value:function F(){this._dirty=true;this._glslPrograms={}}},{key:"dirty",set:function I(L){this._dirty=L;this._onDirty&&this._onDirty()},get:function A(){return this._dirty}}]);return E})(k["default"]);n.prototype.identifier=null;n.extend=p["default"];w["default"]=n;d.exports=w["default"]},function(d,b){Object.defineProperty(b,"__esModule",{value:true});var c=(function(){function g(l,j){for(var h=0;h<j.length;h++){var k=j[h];k.enumerable=k.enumerable||false;k.configurable=true;if("value" in k){k.writable=true}Object.defineProperty(l,k.key,k)}}return function(j,h,i){if(h){g(j.prototype,h)}if(i){g(j,i)}return j}})();function f(g,h){if(!(g instanceof h)){throw new TypeError("Cannot call a class as a function")}}var e=(function(){function j(u,t,q,s){f(this,j);if(typeof s==="undefined"){s=1}this.r=u;this.g=t;this.b=q;this.a=s}c(j,[{key:"toRGBA",value:function l(){var q=[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255),this.a];return"rgba("+q.join(",")+")"}},{key:"toHex",value:function n(){var q=[this._componentToHex(Math.round(this.r*255)),this._componentToHex(Math.round(this.g*255)),this._componentToHex(Math.round(this.b*255))];return"#"+q.join("")}},{key:"toGLColor",value:function i(){return[this.r,this.g,this.b,this.a]}},{key:"toRGBGLColor",value:function h(){return[this.r,this.g,this.b]}},{key:"toHSV",value:function p(){var q=Math.max(this.r,this.g,this.b);var t=Math.min(this.r,this.g,this.b);var w=undefined;var u=undefined;var r=q;var x=q-t;u=q===0?0:x/q;if(q===t){w=0}else{switch(q){case this.r:w=(this.g-this.b)/x+(this.g<this.b?6:0);break;case this.g:w=(this.b-this.r)/x+2;break;case this.b:w=(this.r-this.g)/x+4;break}w/=6}return[w,u,r]}},{key:"fromHSV",value:function m(z,F,D){var u=this.r;var A=this.g;var C=this.b;var y=Math.floor(z*6);var B=z*6-y;var x=D*(1-F);var w=D*(1-B*F);var E=D*(1-(1-B)*F);switch(y%6){case 0:u=D;A=E;C=x;break;case 1:u=w;A=D;C=x;break;case 2:u=x;A=D;C=E;break;case 3:u=x;A=w;C=D;break;case 4:u=E;A=x;C=D;break;case 5:u=D;A=x;C=w;break}this.r=u;this.g=A;this.b=C}},{key:"clone",value:function o(){return new j(this.r,this.g,this.b,this.a)}},{key:"_componentToHex",value:function g(q){var r=q.toString(16);return r.length===1?"0"+r:r}},{key:"toString",value:function k(){return"Color("+this.r+", "+this.g+", "+this.b+", "+this.a+")"}}]);return j})();b["default"]=e;d.exports=b["default"]},function(c,b){c.exports=function(g,d){var f=this;var i;if(g&&g.hasOwnProperty("constructor")){i=g.constructor}else{i=function(){return f.apply(this,arguments)}}var e;for(e in f){i[e]=f[e]}if(typeof d!=="undefined"){for(e in d){i[e]=d[e]}}var h=function h(){this.constructor=i};h.prototype=f.prototype;i.prototype=new h();if(g){for(e in g){i.prototype[e]=g[e]}}i.__super__=f.prototype;return i}},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var i=b(22);var k=m(i);var j=(function(p){l(q,p);function q(){g(this,q);for(var r=arguments.length,s=Array(r),t=0;t<r;t++){s[t]=arguments[t]}h(Object.getPrototypeOf(q.prototype),"constructor",this).apply(this,s);this.fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      varying vec2 v_texCoord;\n      uniform bool u_flipVertical;\n      uniform bool u_flipHorizontal;\n\n      void main() {\n        vec2 texCoord = vec2(v_texCoord);\n        if (u_flipVertical) {\n          texCoord.y = 1.0 - texCoord.y;\n        }\n        if (u_flipHorizontal) {\n          texCoord.x = 1.0 - texCoord.x;\n        }\n        gl_FragColor = texture2D(u_image, texCoord);\n      }\n    "}e(q,[{key:"_renderWebGL",value:function n(r){r.runShader(null,this.fragmentShader,{uniforms:{u_flipVertical:{type:"f",value:this._options.vertical},u_flipHorizontal:{type:"f",value:this._options.horizontal}}})}},{key:"_renderCanvas",value:function o(w){var t=w.getCanvas();var u=w.getContext();var s=1,r=1;var y=0,x=0;if(this._options.horizontal){s=-1;y=t.width}if(this._options.vertical){r=-1;x=t.height}u.save();u.translate(y,x);u.scale(s,r);var v=w.cloneCanvas();u.drawImage(v,0,0);u.restore()}}]);return q})(k["default"]);j.prototype.identifier="flip";j.prototype.availableOptions={horizontal:{type:"boolean","default":false},vertical:{type:"boolean","default":false}};f["default"]=j;c.exports=f["default"]},function(c,b){},function(e,c,g){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function h(){f(this,h)}d(h,[{key:"render",value:function j(k){throw new Error("Filter#render is abstract and not implemented in inherited class.")}}],[{key:"identifier",get:function i(){return null}}]);return h})();b.extend=g(24);b.PrimitivesStack=g(28);b.Primitives={};b.Primitives.Saturation=g(29);b.Primitives.LookupTable=g(31);b.Primitives.ToneCurve=g(32);b.Primitives.SoftColorOverlay=g(33);b.Primitives.Desaturation=g(34);b.Primitives.X400=g(35);b.Primitives.Grayscale=g(36);b.Primitives.Contrast=g(37);b.Primitives.Glow=g(38);b.Primitives.Gobblin=g(39);b.Primitives.Brightness=g(40);c["default"]=b;e.exports=c["default"]},function(e,c){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function g(l,j){for(var h=0;h<j.length;h++){var k=j[h];k.enumerable=k.enumerable||false;k.configurable=true;if("value" in k){k.writable=true}Object.defineProperty(l,k.key,k)}}return function(j,h,i){if(h){g(j.prototype,h)}if(i){g(j,i)}return j}})();function f(g,h){if(!(g instanceof h)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function g(){f(this,g);this._stack=[]}d(g,[{key:"add",value:function i(j){this._stack.push(j)}},{key:"render",value:function h(l){for(var k=0;k<this._stack.length;k++){var j=this._stack[k];j.render(l)}}}]);return g})();c["default"]=b;e.exports=c["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function l(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var g=b(15);var o=n(g);var i=b(30);var m=n(i);var f=(function(p){l(r,p);function r(){j(this,r);for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}k(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,u);this._options=o["default"].defaults(this._options,{saturation:0});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_saturation;\n\n      const vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float luminance = dot(texColor.rgb, luminanceWeighting);\n\n        vec3 greyScaleColor = vec3(luminance);\n\n        gl_FragColor = vec4(mix(greyScaleColor, texColor.rgb, u_saturation) * texColor.a, texColor.a);\n      }\n    "}e(r,[{key:"renderWebGL",value:function s(t){if(!this._glslPrograms[t.id]){this._glslPrograms[t.id]=t.setupGLSLProgram(null,this._fragmentShader)}t.runProgram(this._glslPrograms[t.id],{uniforms:{u_saturation:{type:"f",value:this._options.saturation}}})}},{key:"renderCanvas",value:function q(A){var w=A.getCanvas();var C=A.getContext().getImageData(0,0,w.width,w.height);var z=this._options.saturation;for(var t=0;t<w.width;t++){for(var B=0;B<w.height;B++){var v=(w.width*B+t)*4;var u=C.data[v]*0.2125+C.data[v+1]*0.7154+C.data[v+2]*0.0721;C.data[v]=u*(1-z)+C.data[v]*z;C.data[v+1]=u*(1-z)+C.data[v+1]*z;C.data[v+2]=u*(1-z)+C.data[v+2]*z}}A.getContext().putImageData(C,0,0)}}]);return r})(m["default"]);h["default"]=f;c.exports=h["default"]},function(e,c){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function g(l,j){for(var h=0;h<j.length;h++){var k=j[h];k.enumerable=k.enumerable||false;k.configurable=true;if("value" in k){k.writable=true}Object.defineProperty(l,k.key,k)}}return function(j,h,i){if(h){g(j.prototype,h)}if(i){g(j,i)}return j}})();function f(g,h){if(!(g instanceof h)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function g(l){f(this,g);l=l||{};this._glslPrograms={};this._options=l}d(g,[{key:"render",value:function j(l){if(l.identifier==="webgl"){this.renderWebGL(l)}else{this.renderCanvas(l)}}},{key:"renderWebGL",value:function k(l){throw new Error("Primitive#renderWebGL is abstract and not implemented in inherited class.")}},{key:"renderCanvas",value:function h(l){throw new Error("Primitive#renderCanvas is abstract and not implemented in inherited class.")}},{key:"options",get:function i(){return this._options}}]);return g})();c["default"]=b;e.exports=c["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var j=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function i(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var h=c(30);var l=m(h);var b=(function(n){k(r,n);function r(){i(this,r);for(var s=arguments.length,t=Array(s),u=0;u<s;u++){t[u]=arguments[u]}j(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,t);this._textureIndex=3;this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_lookupTable;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float r = texture2D(u_lookupTable, vec2(texColor.r, 0.0)).r;\n        float g = texture2D(u_lookupTable, vec2(texColor.g, 0.0)).g;\n        float b = texture2D(u_lookupTable, vec2(texColor.b, 0.0)).b;\n\n        gl_FragColor = vec4(vec3(r, g, b) * texColor.a, texColor.a);\n      }\n    "}f(r,[{key:"renderWebGL",value:function q(s){this._updateTexture(s);s.runShader(null,this._fragmentShader,{uniforms:{u_lookupTable:{type:"i",value:3}}})}},{key:"renderCanvas",value:function o(z){var u=z.getCanvas();var s=z.getContext().getImageData(0,0,u.width,u.height);var D=this._options.data;for(var C=0;C<u.width;C++){for(var B=0;B<u.height;B++){var w=(u.width*B+C)*4;var t=s.data[w];s.data[w]=D[t*4];var v=s.data[w+1];s.data[w+1]=D[1+v*4];var A=s.data[w+2];s.data[w+2]=D[2+A*4]}}z.getContext().putImageData(s,0,0)}},{key:"_updateTexture",value:function p(t){var u=t.getContext();if(typeof this._options.data==="undefined"){throw new Error("LookupTable: No data specified.")}var s=new Uint8Array(this._options.data);u.activeTexture(u.TEXTURE0+this._textureIndex);if(!this._texture){this._texture=u.createTexture()}u.bindTexture(u.TEXTURE_2D,this._texture);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE);u.texImage2D(u.TEXTURE_2D,0,u.RGBA,256,1,0,u.RGBA,u.UNSIGNED_BYTE,s);u.activeTexture(u.TEXTURE0)}}]);return r})(l["default"]);g["default"]=b;d.exports=g["default"]},function(e,i,d){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function f(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function m(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var h=d(15);var o=n(h);var l=d(31);var b=n(l);var c=(function(r){m(u,r);function u(){j(this,u);for(var w=arguments.length,x=Array(w),y=0;y<w;y++){x[y]=arguments[y]}k(Object.getPrototypeOf(u.prototype),"constructor",this).apply(this,x);this._options=o["default"].defaults(this._options,{rgbControlPoints:{red:this._options.controlPoints,green:this._options.controlPoints,blue:this._options.controlPoints}});if(typeof this._options.rgbControlPoints!=="undefined"){this._updateLookupTable()}}g(u,[{key:"_updateLookupTable",value:function t(){var y=this._calculateSplineCurve(this._options.rgbControlPoints.red);var x=this._calculateSplineCurve(this._options.rgbControlPoints.green);var w=this._calculateSplineCurve(this._options.rgbControlPoints.blue);this._options.data=this._buildLookupTable(y,x,w)}},{key:"_buildLookupTable",value:function q(z,y,w){var A=[];for(var x=0;x<256;x++){A.push(Math.min(Math.max(x+z[x],0),255));A.push(Math.min(Math.max(x+y[x],0),255));A.push(Math.min(Math.max(x+w[x],0),255));A.push(255)}return A}},{key:"_calculateSplineCurve",value:function v(B){B=B.sort(function(F,E){return F[0]>E[0]});var w=this._getSplineCurve(B);var C=w[0];var z;if(C[0]>0){for(z=0;z<C[0];z++){w.unshift([0,0])}}var y=[];for(z=0;z<w.length;z++){var x=w[z];var A=[x[0],x[0]];var D=Math.sqrt(Math.pow(A[0]-x[0],2)+Math.pow(A[1]-x[1],2));if(A[1]>x[1]){D=-D}y.push(D)}return y}},{key:"_getSplineCurve",value:function s(K){var A=this._secondDerivative(K);var w=A.length;var E=[];var B;for(B=0;B<w;B++){E[B]=A[B]}var z=[];for(B=0;B<w-1;B++){var J=K[B];var D=K[B+1];for(var I=J[0];I<D[0];I++){var L=(I-J[0])/(D[0]-J[0]);var H=1-L;var G=L;var C=D[0]-J[0];var F=H*J[1]+G*D[1]+C*C/6*((H*H*H-H)*E[B]+(G*G*G-G)*E[B+1]);if(F>255){F=255}else{if(F<0){F=0}}z.push([I,F])}}if(z.length===255){z.push(K[K.length-1])}return z}},{key:"_secondDerivative",value:function p(C){var x=C.length;if(x<=0||x===1){return null}var B=[];var F=[];var z,y;B[0]=[0,1,0];for(z=1;z<x-1;z++){var w=C[z-1];var E=C[z];var D=C[z+1];B[z]=B[z]||[];B[z][0]=(E[0]-w[0])/6;B[z][1]=(D[0]-w[0])/3;B[z][2]=(D[0]-E[0])/6;F[z]=(D[1]-E[1])/(D[0]-E[0])-(E[1]-w[1])/(E[0]-w[0])}F[0]=0;F[x-1]=0;B[x-1]=[0,1,0];for(z=1;z<x;z++){y=B[1][0]/B[z-1][1];B[z][1]-=y*B[z-1][2];B[z][0]=0;F[z]-=y*F[z-1]}for(z=x-2;z>0;z--){y=B[z][2]/B[z+1][1];B[z][1]-=y*B[z+1][0];B[z][2]=0;F[z]-=y*F[z+1]}var A=[];for(z=0;z<x;z++){A[z]=F[z]/B[z][1]}return A}}]);return u})(b["default"]);i["default"]=c;e.exports=i["default"]},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var l=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function k(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function n(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var h=c(15);var q=p(h);var j=c(30);var o=p(j);var m=c(23);var b=p(m);var f=(function(s){n(r,s);function r(){k(this,r);for(var v=arguments.length,w=Array(v),x=0;x<v;x++){w[x]=arguments[x]}l(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,w);this._options=q["default"].defaults(this._options,{color:new b["default"](1,1,1)});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform vec3 u_overlay;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        vec4 overlayVec4 = vec4(u_overlay, texColor.a);\n        gl_FragColor = max(overlayVec4 * texColor.a, texColor);\n      }\n    "}g(r,[{key:"renderWebGL",value:function u(v){v.runShader(null,this._fragmentShader,{uniforms:{u_overlay:{type:"3f",value:this._options.color.toRGBGLColor()}}})}},{key:"renderCanvas",value:function t(A){var z=A.getCanvas();var C=A.getContext().getImageData(0,0,z.width,z.height);for(var v=0;v<z.width;v++){for(var B=0;B<z.height;B++){var w=(z.width*B+v)*4;C.data[w]=Math.max(this._options.color.r,C.data[w]);C.data[w+1]=Math.max(this._options.color.g,C.data[w+1]);C.data[w+2]=Math.max(this._options.color.b,C.data[w+2])}}A.getContext().putImageData(C,0,0)}}]);return r})(o["default"]);i["default"]=f;d.exports=i["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function l(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var g=b(15);var o=n(g);var i=b(30);var m=n(i);var f=(function(p){l(r,p);function r(){j(this,r);for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}k(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,u);this._options=o["default"].defaults(this._options,{desaturation:1});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_desaturation;\n\n      const vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        vec3 grayXfer = vec3(0.3, 0.59, 0.11);\n        vec3 gray = vec3(dot(grayXfer, texColor.xyz));\n        gl_FragColor = vec4(mix(texColor.xyz, gray, u_desaturation) * texColor.a, texColor.a);\n      }\n    "}e(r,[{key:"renderWebGL",value:function s(t){t.runShader(null,this._fragmentShader,{uniforms:{u_desaturation:{type:"f",value:this._options.desaturation}}})}},{key:"renderCanvas",value:function q(A){var w=A.getCanvas();var C=A.getContext().getImageData(0,0,w.width,w.height);var z=this._options.desaturation;for(var t=0;t<w.width;t++){for(var B=0;B<w.height;B++){var v=(w.width*B+t)*4;var u=C.data[v]*0.3+C.data[v+1]*0.59+C.data[v+2]*0.11;C.data[v]=u*(1-z)+C.data[v]*z;C.data[v+1]=u*(1-z)+C.data[v+1]*z;C.data[v+2]=u*(1-z)+C.data[v+2]*z}}A.getContext().putImageData(C,0,0)}}]);return r})(m["default"]);h["default"]=f;c.exports=h["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var g=b(30);var l=m(g);var j=(function(n){k(p,n);function p(){h(this,p);for(var r=arguments.length,s=Array(r),t=0;t<r;t++){s[t]=arguments[t]}i(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,s);this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float gray = texColor.r * 0.3 + texColor.g * 0.3 + texColor.b * 0.3;\n        gray -= 0.2;\n        gray = clamp(gray, 0.0, 1.0);\n        gray += 0.15;\n        gray *= 1.4;\n        gl_FragColor = vec4(vec3(gray) * texColor.a, texColor.a);\n      }\n    "}e(p,[{key:"renderWebGL",value:function q(r){r.runShader(null,this._fragmentShader)}},{key:"renderCanvas",value:function o(v){var u=v.getCanvas();var z=v.getContext().getImageData(0,0,u.width,u.height);for(var s=0;s<u.width;s++){for(var w=0;w<u.height;w++){var t=(u.width*w+s)*4;var r=z.data[t]/255*0.3+z.data[t+1]/255*0.3+z.data[t+2]/255*0.3;r-=0.2;r=Math.max(0,Math.min(1,r));r+=0.15;r*=1.4;r*=255;z.data[t]=r;z.data[t+1]=r;z.data[t+2]=r}}v.getContext().putImageData(z,0,0)}}]);return p})(l["default"]);f["default"]=j;c.exports=f["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var j=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function i(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var h=b(30);var l=m(h);var e=(function(n){k(p,n);function p(){i(this,p);for(var r=arguments.length,s=Array(r),t=0;t<r;t++){s[t]=arguments[t]}j(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,s);this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      vec3 W = vec3(0.2125, 0.7154, 0.0721);\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float luminance = dot(texColor.rgb, W);\n        gl_FragColor = vec4(vec3(luminance) * texColor.a, texColor.a);\n      }\n    "}f(p,[{key:"renderWebGL",value:function q(r){r.runShader(null,this._fragmentShader)}},{key:"renderCanvas",value:function o(v){var u=v.getCanvas();var z=v.getContext().getImageData(0,0,u.width,u.height);for(var r=0;r<u.width;r++){for(var w=0;w<u.height;w++){var t=(u.width*w+r)*4;var s=z.data[t]*0.2125+z.data[t+1]*0.7154+z.data[t+2]*0.0721;z.data[t]=s;z.data[t+1]=s;z.data[t+2]=s}}v.getContext().putImageData(z,0,0)}}]);return p})(l["default"]);g["default"]=e;c.exports=g["default"]},function(d,h,c){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function e(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function l(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var g=c(15);var o=n(g);var i=c(30);var m=n(i);var b=(function(p){l(r,p);function r(){j(this,r);for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}k(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,u);this._options=o["default"].defaults(this._options,{contrast:1});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_contrast;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        gl_FragColor = vec4(((texColor.rgb - vec3(0.5)) * u_contrast + vec3(0.5) * texColor.a), texColor.a);\n      }\n    "}f(r,[{key:"renderWebGL",value:function s(t){if(!this._glslPrograms[t.id]){this._glslPrograms[t.id]=t.setupGLSLProgram(null,this._fragmentShader)}t.runProgram(this._glslPrograms[t.id],{uniforms:{u_contrast:{type:"f",value:this._options.contrast}}})}},{key:"renderCanvas",value:function q(z){var v=z.getCanvas();var B=z.getContext().getImageData(0,0,v.width,v.height);var w=this._options.contrast;for(var t=0;t<v.width;t++){for(var A=0;A<v.height;A++){var u=(v.width*A+t)*4;B.data[u]=(B.data[u]-127)*w+127;B.data[u+1]=(B.data[u+1]-127)*w+127;B.data[u+2]=(B.data[u+2]-127)*w+127}}z.getContext().putImageData(B,0,0)}}]);return r})(m["default"]);h["default"]=b;d.exports=h["default"]},function(e,i,d){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var l=function f(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function k(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function n(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var h=d(15);var q=p(h);var j=d(30);var o=p(j);var m=d(23);var c=p(m);var b=(function(r){n(t,r);function t(){k(this,t);for(var v=arguments.length,w=Array(v),x=0;x<v;x++){w[x]=arguments[x]}l(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,w);this._options=q["default"].defaults(this._options,{color:new c["default"](1,1,1)});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n\n      uniform vec3 u_color;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n\n        vec2 textureCoord = v_texCoord - vec2(0.5, 0.5);\n        textureCoord /= 0.75;\n\n        float d = 1.0 - dot(textureCoord, textureCoord);\n        d = clamp(d, 0.2, 1.0);\n        vec3 newColor = texColor.rgb * d * u_color.rgb;\n        gl_FragColor = vec4(vec3(newColor) * texColor.a, texColor.a);\n      }\n    "}g(t,[{key:"renderWebGL",value:function u(v){v.runShader(null,this._fragmentShader,{uniforms:{u_color:{type:"3f",value:this._options.color.toRGBGLColor()}}})}},{key:"renderCanvas",value:function s(I){var w=I.getCanvas();var v=I.getContext().getImageData(0,0,w.width,w.height);var A=this._options.color;var H;for(var K=0;K<w.width;K++){for(var J=0;J<w.height;J++){var E=(w.width*J+K)*4;var z=K/w.width;var C=J/w.height;var D=(z-0.5)/0.75;var B=(C-0.5)/0.75;var G=D*D;var F=B*B;H=1-(G+F);H=Math.min(Math.max(H,0.1),1);v.data[E]=v.data[E]*(H*A.r);v.data[E+1]=v.data[E+1]*(H*A.g);v.data[E+2]=v.data[E+2]*(H*A.b);v.data[E+3]=255}}I.getContext().putImageData(v,0,0)}}]);return t})(o["default"]);i["default"]=b;e.exports=i["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var g=b(30);var l=m(g);var j=(function(n){k(q,n);function q(){h(this,q);for(var r=arguments.length,s=Array(r),t=0;t<r;t++){s[t]=arguments[t]}i(Object.getPrototypeOf(q.prototype),"constructor",this).apply(this,s);this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        texColor.b = texColor.g * 0.33;\n        texColor.r = texColor.r * 0.6;\n        texColor.b += texColor.r * 0.33;\n        texColor.g = texColor.g * 0.7;\n        gl_FragColor = texColor;\n      }\n    "}e(q,[{key:"renderWebGL",value:function p(r){r.runShader(null,this._fragmentShader)}},{key:"renderCanvas",value:function o(u){var t=u.getCanvas();var w=u.getContext().getImageData(0,0,t.width,t.height);for(var r=0;r<t.width;r++){for(var v=0;v<t.height;v++){var s=(t.width*v+r)*4;w.data[s+2]=w.data[s+1]*0.33;w.data[s]=w.data[s]*0.6;w.data[s+2]+=w.data[s]*0.33;w.data[s+1]=w.data[s+1]*0.7;w.data[s+3]=255}}u.getContext().putImageData(w,0,0)}}]);return q})(l["default"]);f["default"]=j;c.exports=f["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var j=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function i(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function l(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var f=b(15);var o=n(f);var h=b(30);var m=n(h);var k=(function(p){l(r,p);function r(){i(this,r);for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}j(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,u);this._options=o["default"].defaults(this._options,{brightness:1});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_brightness;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        gl_FragColor = vec4((texColor.rgb + vec3(u_brightness) * texColor.a), texColor.a);;\n      }\n    "}e(r,[{key:"renderWebGL",value:function s(t){if(!this._glslPrograms[t.id]){this._glslPrograms[t.id]=t.setupGLSLProgram(null,this._fragmentShader)}t.runProgram(this._glslPrograms[t.id],{uniforms:{u_brightness:{type:"f",value:this._options.brightness}}})}},{key:"renderCanvas",value:function q(w){var v=w.getCanvas();var B=w.getContext().getImageData(0,0,v.width,v.height);var z=this._options.brightness;for(var t=0;t<v.width;t++){for(var A=0;A<v.height;A++){var u=(v.width*A+t)*4;B.data[u]=B.data[u]+z*255;B.data[u+1]=B.data[u+1]+z*255;B.data[u+2]=B.data[u+2]+z*255}}w.getContext().putImageData(B,0,0)}}]);return r})(m["default"]);g["default"]=k;c.exports=g["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var e=(function(){function q(u,s){for(var r=0;r<s.length;r++){var t=s[r];t.enumerable=t.enumerable||false;t.configurable=true;if("value" in t){t.writable=true}Object.defineProperty(u,t.key,t)}}return function(t,r,s){if(r){q(t.prototype,r)}if(s){q(t,s)}return t}})();var i=function d(x,w,v){var t=true;_function:while(t){var r=x,z=w,q=v;s=y=u=undefined;t=false;if(r===null){r=Function.prototype}var s=Object.getOwnPropertyDescriptor(r,z);if(s===undefined){var y=Object.getPrototypeOf(r);if(y===null){return undefined}else{x=y;w=z;v=q;t=true;continue _function}}else{if("value" in s){return s.value}else{var u=s.get;if(u===undefined){return undefined}return u.call(q)}}}};function o(q){return q&&q.__esModule?q:{"default":q}}function h(q,r){if(!(q instanceof r)){throw new TypeError("Cannot call a class as a function")}}function n(r,q){if(typeof q!=="function"&&q!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof q)}r.prototype=Object.create(q&&q.prototype,{constructor:{value:r,enumerable:false,writable:true,configurable:true}});if(q){Object.setPrototypeOf?Object.setPrototypeOf(r,q):r.__proto__=q}}var j=b(22);var m=o(j);var p=b(42);var l=o(p);var k=(function(s){n(t,s);function t(){h(this,t);i(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}e(t,[{key:"_renderWebGL",value:function q(v){this._render(v)}},{key:"_renderCanvas",value:function r(v){this._render(v)}},{key:"_render",value:function u(v){this._selectedFilter.render(v)}}]);return t})(m["default"]);k.prototype.identifier="filters";k.prototype.availableOptions={filter:{type:"object","default":l["default"],setter:function f(q){this._selectedFilter=new q();return q}}};g["default"]=k;c.exports=g["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var i=b(27);var l=m(i);var j=(function(q){k(p,q);function p(){g(this,p);h(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,arguments)}e(p,[{key:"render",value:function o(){}},{key:"name",get:function n(){return"Original"}}],[{key:"identifier",get:function n(){return"identity"}}]);return p})(l["default"]);f["default"]=j;c.exports=f["default"]},function(e,i,d){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var k=function f(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function p(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var m=d(22);var o=q(m);var h=d(4);var l=q(h);var b=d(12);var n=q(b);var c=(function(t){p(u,t);function u(){j(this,u);for(var w=arguments.length,x=Array(w),y=0;y<w;y++){x[y]=arguments[y]}k(Object.getPrototypeOf(u.prototype),"constructor",this).apply(this,x)}g(u,[{key:"_renderWebGL",value:function r(A){var B=this._options.start.clone();var y=this._options.end.clone();var z=y.clone().subtract(B);var x=null;if(!this._glslPrograms[A.id]){this._glslPrograms[A.id]=A.setupGLSLProgram(null,x,w)}var w=new Float32Array([B.x,1-y.y,y.x,1-y.y,B.x,1-B.y,B.x,1-B.y,y.x,1-y.y,y.x,1-B.y]);A.runProgram(this._glslPrograms[A.id],{textureCoordinates:w})}},{key:"_renderCanvas",value:function s(B){var x=B.getCanvas();var A=new l["default"](x.width,x.height);var w=this.getNewDimensions(B);var y=B.createCanvas();y.width=w.x;y.height=w.y;var C=y.getContext("2d");var z=this._options.start.clone();if(this._options.numberFormat==="relative"){z.multiply(A)}C.drawImage(x,z.x,z.y,w.x,w.y,0,0,w.x,w.y);B.setCanvas(y)}},{key:"getNewDimensions",value:function v(z,y){var x=z.getCanvas();y=y||new l["default"](x.width,x.height);var w=this._options.end.clone().subtract(this._options.start);if(this._options.numberFormat==="relative"){w.multiply(y)}return w}}]);return u})(o["default"]);c.prototype.identifier="crop";c.prototype.availableOptions={start:{type:"vector2",required:true,"default":new l["default"](0,0)},end:{type:"vector2",required:true,"default":new l["default"](1,1)}};i["default"]=c;e.exports=i["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var i=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function h(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function m(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var k=c(22);var l=q(k);var j=c(28);var n=q(j);var p=c(29);var o=q(p);var b=(function(t){m(v,t);function v(){h(this,v);i(Object.getPrototypeOf(v.prototype),"constructor",this).apply(this,arguments)}f(v,[{key:"_renderWebGL",value:function r(w){this._render(w)}},{key:"_renderCanvas",value:function s(w){this._render(w)}},{key:"_render",value:function u(w){if(!this._stack){this._stack=new n["default"]();this._primitive=new o["default"]({saturation:this._options.saturation});this._stack.add(this._primitive)}this._primitive.options.saturation=this._options.saturation;this._stack.render(w)}}]);return v})(l["default"]);b.prototype.identifier="saturation";b.prototype.availableOptions={saturation:{type:"number","default":1}};g["default"]=b;d.exports=g["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var i=function d(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function h(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function n(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var k=b(22);var m=p(k);var j=b(28);var o=p(j);var e=b(37);var l=p(e);var q=(function(u){n(s,u);function s(){h(this,s);i(Object.getPrototypeOf(s.prototype),"constructor",this).apply(this,arguments)}f(s,[{key:"_renderWebGL",value:function r(w){this._render(w)}},{key:"_renderCanvas",value:function t(w){this._render(w)}},{key:"_render",value:function v(w){if(!this._stack){this._stack=new o["default"]();this._primitive=new l["default"]({contrast:this._options.contrast});this._stack.add(this._primitive)}this._primitive.options.contrast=this._options.contrast;this._stack.render(w)}}]);return s})(m["default"]);q.prototype.identifier="contrast";q.prototype.availableOptions={contrast:{type:"number","default":1}};g["default"]=q;c.exports=g["default"]},function(d,h,c){Object.defineProperty(h,"__esModule",{value:true});var g=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var j=function f(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function i(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function n(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var l=c(22);var m=p(l);var k=c(28);var o=p(k);var e=c(40);var b=p(e);var q=(function(t){n(u,t);function u(){i(this,u);j(Object.getPrototypeOf(u.prototype),"constructor",this).apply(this,arguments)}g(u,[{key:"_renderWebGL",value:function r(w){this._render(w)}},{key:"_renderCanvas",value:function s(w){this._render(w)}},{key:"_render",value:function v(w){if(!this._stack){this._stack=new o["default"]();this._primitive=new b["default"]({brightness:this._options.brightness});this._stack.add(this._primitive)}this._primitive.options.brightness=this._options.brightness;this._stack.render(w)}}]);return u})(m["default"]);q.prototype.identifier="brightness";q.prototype.availableOptions={brightness:{type:"number","default":0}};h["default"]=q;d.exports=h["default"]},function(f,s,h){Object.defineProperty(s,"__esModule",{value:true});var p=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var o=function k(t,x,w,v){var y=Object.getOwnPropertyDescriptor(t,x);if(y===undefined){var u=Object.getPrototypeOf(t);if(u!==null){k(u,x,w,v)}}else{if("value" in y&&y.writable){y.value=w}else{var z=y.set;if(z!==undefined){z.call(v,w)}}}return w};var c=function q(A,z,y){var w=true;_function:while(w){var u=A,C=z,t=y;v=B=x=undefined;w=false;if(u===null){u=Function.prototype}var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;y=t;w=true;continue _function}}else{if("value" in v){return v.value}else{var x=v.get;if(x===undefined){return undefined}return x.call(t)}}}};function d(t){return t&&t.__esModule?t:{"default":t}}function i(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function n(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){Object.setPrototypeOf?Object.setPrototypeOf(u,t):u.__proto__=t}}var j=h(22);var e=d(j);var l=h(4);var g=d(l);var r=h(48);var b=d(r);var m=(function(y){n(A,y);function A(){i(this,A);for(var C=arguments.length,D=Array(C),E=0;E<C;E++){D[E]=arguments[E]}c(Object.getPrototypeOf(A.prototype),"constructor",this).apply(this,D);this._fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      uniform float blurRadius;\n      uniform float gradientRadius;\n      uniform vec2 start;\n      uniform vec2 end;\n      uniform vec2 delta;\n      uniform vec2 texSize;\n      varying vec2 v_texCoord;\n\n      float random(vec3 scale, float seed) {\n        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n      }\n\n      void main() {\n          vec4 color = vec4(0.0);\n          float total = 0.0;\n\n          float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n          vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n          float radius = smoothstep(0.0, 1.0, abs(dot(v_texCoord * texSize - start, normal)) / gradientRadius) * blurRadius;\n          for (float t = -30.0; t <= 30.0; t++) {\n              float percent = (t + offset - 0.5) / 30.0;\n              float weight = 1.0 - abs(percent);\n              vec4 sample = texture2D(u_image, v_texCoord + delta * percent * radius / texSize);\n\n              sample.rgb *= sample.a;\n\n              color += sample * weight;\n              total += weight;\n          }\n\n          gl_FragColor = color / total;\n          gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n      }\n    ";this._cachedBlurredCanvas=null;this._lastBlurRadius=this._options.blurRadius;this._lastGradientRadius=this._options.gradientRadius}p(A,[{key:"_renderWebGL",value:function w(G){var F=G.getCanvas();var D=new g["default"](F.width,F.height);var J=this._options.start.clone();var E=this._options.end.clone();if(this._options.numberFormat==="relative"){J.multiply(D);E.multiply(D)}J.y=D.y-J.y;E.y=D.y-E.y;var I=E.clone().subtract(J);var H=Math.sqrt(I.x*I.x+I.y*I.y);var C={blurRadius:{type:"f",value:this._options.blurRadius},gradientRadius:{type:"f",value:this._options.gradientRadius},start:{type:"2f",value:[J.x,J.y]},end:{type:"2f",value:[E.x,E.y]},delta:{type:"2f",value:[I.x/H,I.y/H]},texSize:{type:"2f",value:[F.width,F.height]}};if(!this._glslPrograms[G.id]){this._glslPrograms[G.id]=G.setupGLSLProgram(null,this._fragmentShader)}G.runProgram(this._glslPrograms[G.id],{uniforms:C});C.delta.value=[-I.y/H,I.x/H];G.runProgram(this._glslPrograms[G.id],{uniforms:C})}},{key:"_renderCanvas",value:function t(G){var E=G.getCanvas();var C=this._options.blurRadius!==this._lastBlurRadius||this._options.gradientRadius!==this._lastGradientRadius;var D=undefined;if(C||this._cachedBlurredCanvas===null){D=this._blurCanvas(G);this._cachedBlurredCanvas=D;this._lastBlurRadius=this._options.blurRadius;this._lastGradientRadius=this._options.gradientRadius}else{D=this._cachedBlurredCanvas}var F=this._createMask(G);this._applyMask(E,D,F)}},{key:"_blurCanvas",value:function v(F){var E=F.cloneCanvas();var D=E.getContext("2d");var C=D.getImageData(0,0,E.width,E.height);b["default"].stackBlurCanvasRGBA(C,0,0,E.width,E.height,this._options.blurRadius);D.putImageData(C,0,0);return E}},{key:"_createMask",value:function B(J){var D=J.getCanvas();var P=new g["default"](D.width,D.height);var E=this._options.gradientRadius;var G=J.createCanvas(D.width,D.height);var M=G.getContext("2d");var C=this._options.start.clone();var H=this._options.end.clone();if(this._options.numberFormat==="relative"){C.multiply(P);H.multiply(P)}var L=H.clone().subtract(C);var Q=C.clone().add(L.clone().divide(2));var I=Math.sqrt(Math.pow(L.x,2)+Math.pow(L.y,2));var K=L.clone().divide(I);var O=Q.clone().add(E*K.y,-E*K.x);var F=Q.clone().add(-E*K.y,E*K.x);var N=M.createLinearGradient(O.x,O.y,F.x,F.y);N.addColorStop(0,"#000000");N.addColorStop(0.5,"#FFFFFF");N.addColorStop(1,"#000000");M.fillStyle=N;M.fillRect(0,0,D.width,D.height);return G}},{key:"_applyMask",value:function x(E,G,F){var J=E.getContext("2d");var K=G.getContext("2d");var L=F.getContext("2d");var M=J.getImageData(0,0,E.width,E.height);var C=M.data;var I=K.getImageData(0,0,E.width,E.height).data;var N=L.getImageData(0,0,E.width,E.height).data;for(var H=0;H<N.length;H++){var D=N[H]/255;C[H]=D*C[H]+(1-D)*I[H]}J.putImageData(M,0,0)}},{key:"dirty",set:function z(C){o(Object.getPrototypeOf(A.prototype),"dirty",C,this);this._cachedBlurredCanvas=null},get:function u(){return c(Object.getPrototypeOf(A.prototype),"dirty",this)}}]);return A})(e["default"]);m.prototype.identifier="tilt-shift";m.prototype.availableOptions={start:{type:"vector2","default":new g["default"](0,0.5)},end:{type:"vector2","default":new g["default"](1,0.5)},blurRadius:{type:"number","default":30},gradientRadius:{type:"number","default":50}};s["default"]=m;f.exports=s["default"]},function(d,c){
/*!

	StackBlur - a fast almost Gaussian Blur For Canvas

	Version:  0.5
	Author:   Mario Klingemann
	Contact:  mario@quasimondo.com
	Website:  http://www.quasimondo.com/StackBlurForCanvas
	Twitter:  @quasimondo

	In case you find this class useful - especially in commercial projects -
	I am not totally unhappy for a small donation to my PayPal account
	mario@quasimondo.de

	Or support me on flattr:
	https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript

	Copyright (c) 2010 Mario Klingemann

	Permission is hereby granted, free of charge, to any person
	obtaining a copy of this software and associated documentation
	files (the "Software"), to deal in the Software without
	restriction, including without limitation the rights to use,
	copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the
	Software is furnished to do so, subject to the following
	conditions:

	The above copyright notice and this permission notice shall be
	included in all copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
	EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
	OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
	NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
	HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
	WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
	FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
	OTHER DEALINGS IN THE SOFTWARE.
	*/
var b=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259];var g=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function f(Y,L,J,h,k,T){if(isNaN(T)||T<1){return}T|=0;var o=Y.data;var R,Q,aa,X,z,C,t,m,n,I,W,v,K,G,j,O,S,A,u,s,B,D,E,N;var ab=T+T+1;var w=h-1;var V=k-1;var r=T+1;var U=r*(r+1)/2;var M=new e();var q;var H=M;for(aa=1;aa<ab;aa++){H=H.next=new e();if(aa==r){q=H}}H.next=M;var Z=null;var P=null;t=C=0;var F=b[T];var l=g[T];for(Q=0;Q<k;Q++){O=S=A=u=m=n=I=W=0;v=r*(s=o[C]);K=r*(B=o[C+1]);G=r*(D=o[C+2]);j=r*(E=o[C+3]);m+=U*s;n+=U*B;I+=U*D;W+=U*E;H=M;for(aa=0;aa<r;aa++){H.r=s;H.g=B;H.b=D;H.a=E;H=H.next}for(aa=1;aa<r;aa++){X=C+((w<aa?w:aa)<<2);m+=(H.r=s=o[X])*(N=r-aa);n+=(H.g=B=o[X+1])*N;I+=(H.b=D=o[X+2])*N;W+=(H.a=E=o[X+3])*N;O+=s;S+=B;A+=D;u+=E;H=H.next}Z=M;P=q;for(R=0;R<h;R++){o[C+3]=E=W*F>>l;if(E!==0){E=255/E;o[C]=(m*F>>l)*E;o[C+1]=(n*F>>l)*E;o[C+2]=(I*F>>l)*E}else{o[C]=o[C+1]=o[C+2]=0}m-=v;n-=K;I-=G;W-=j;v-=Z.r;K-=Z.g;G-=Z.b;j-=Z.a;X=t+((X=R+T+1)<w?X:w)<<2;O+=Z.r=o[X];S+=Z.g=o[X+1];A+=Z.b=o[X+2];u+=Z.a=o[X+3];m+=O;n+=S;I+=A;W+=u;Z=Z.next;v+=s=P.r;K+=B=P.g;G+=D=P.b;j+=E=P.a;O-=s;S-=B;A-=D;u-=E;P=P.next;C+=4}t+=h}for(R=0;R<h;R++){S=A=u=O=n=I=W=m=0;C=R<<2;v=r*(s=o[C]);K=r*(B=o[C+1]);G=r*(D=o[C+2]);j=r*(E=o[C+3]);m+=U*s;n+=U*B;I+=U*D;W+=U*E;H=M;for(aa=0;aa<r;aa++){H.r=s;H.g=B;H.b=D;H.a=E;H=H.next}z=h;for(aa=1;aa<=T;aa++){C=z+R<<2;m+=(H.r=s=o[C])*(N=r-aa);n+=(H.g=B=o[C+1])*N;I+=(H.b=D=o[C+2])*N;W+=(H.a=E=o[C+3])*N;O+=s;S+=B;A+=D;u+=E;H=H.next;if(aa<V){z+=h}}C=R;Z=M;P=q;for(Q=0;Q<k;Q++){X=C<<2;o[X+3]=E=W*F>>l;if(E>0){E=255/E;o[X]=(m*F>>l)*E;o[X+1]=(n*F>>l)*E;o[X+2]=(I*F>>l)*E}else{o[X]=o[X+1]=o[X+2]=0}m-=v;n-=K;I-=G;W-=j;v-=Z.r;K-=Z.g;G-=Z.b;j-=Z.a;X=R+((X=Q+r)<V?X:V)*h<<2;m+=O+=Z.r=o[X];n+=S+=Z.g=o[X+1];I+=A+=Z.b=o[X+2];W+=u+=Z.a=o[X+3];Z=Z.next;v+=s=P.r;K+=B=P.g;G+=D=P.b;j+=E=P.a;O-=s;S-=B;A-=D;u-=E;P=P.next;C+=h}}}function e(){this.r=0;this.g=0;this.b=0;this.a=0;this.next=null}d.exports={stackBlurCanvasRGBA:f}},function(f,s,h){Object.defineProperty(s,"__esModule",{value:true});var p=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var n=function k(t,x,w,v){var y=Object.getOwnPropertyDescriptor(t,x);if(y===undefined){var u=Object.getPrototypeOf(t);if(u!==null){k(u,x,w,v)}}else{if("value" in y&&y.writable){y.value=w}else{var z=y.set;if(z!==undefined){z.call(v,w)}}}return w};var c=function q(A,z,y){var w=true;_function:while(w){var u=A,C=z,t=y;v=B=x=undefined;w=false;if(u===null){u=Function.prototype}var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;y=t;w=true;continue _function}}else{if("value" in v){return v.value}else{var x=v.get;if(x===undefined){return undefined}return x.call(t)}}}};function d(t){return t&&t.__esModule?t:{"default":t}}function i(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function m(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){Object.setPrototypeOf?Object.setPrototypeOf(u,t):u.__proto__=t}}var j=h(22);var e=d(j);var l=h(4);var g=d(l);var r=h(48);var b=d(r);var o=(function(z){m(x,z);function x(){i(this,x);for(var C=arguments.length,D=Array(C),E=0;E<C;E++){D[E]=arguments[E]}c(Object.getPrototypeOf(x.prototype),"constructor",this).apply(this,D);this._fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      uniform float blurRadius;\n      uniform float gradientRadius;\n      uniform vec2 position;\n      uniform vec2 delta;\n      uniform vec2 texSize;\n      varying vec2 v_texCoord;\n\n      float random(vec3 scale, float seed) {\n        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n      }\n\n      void main() {\n          vec4 color = vec4(0.0);\n          float total = 0.0;\n\n          float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n          float radius = smoothstep(0.0, 1.0, abs(distance(v_texCoord * texSize, position)) / (gradientRadius * 2.0)) * blurRadius;\n          for (float t = -30.0; t <= 30.0; t++) {\n              float percent = (t + offset - 0.5) / 30.0;\n              float weight = 1.0 - abs(percent);\n              vec4 sample = texture2D(u_image, v_texCoord + delta * percent * radius / texSize);\n\n              sample.rgb *= sample.a;\n\n              color += sample * weight;\n              total += weight;\n          }\n\n          gl_FragColor = color / total;\n          gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n      }\n    ";this._cachedBlurredCanvas=null;this._lastBlurRadius=this._options.blurRadius;this._lastGradientRadius=this._options.gradientRadius}p(x,[{key:"_renderWebGL",value:function w(G){var F=G.getCanvas();var E=new g["default"](F.width,F.height);var D=this._options.position.clone();D.y=1-D.y;if(this._options.numberFormat==="relative"){D.multiply(E)}var C={blurRadius:{type:"f",value:this._options.blurRadius},gradientRadius:{type:"f",value:this._options.gradientRadius},position:{type:"2f",value:[D.x,D.y]},texSize:{type:"2f",value:[F.width,F.height]},delta:{type:"2f",value:[1,1]}};if(!this._glslPrograms[G.id]){this._glslPrograms[G.id]=G.setupGLSLProgram(null,this._fragmentShader)}G.runProgram(this._glslPrograms[G.id],{uniforms:C});C.delta.value=[-1,1];G.runProgram(this._glslPrograms[G.id],{uniforms:C})}},{key:"_renderCanvas",value:function t(F){var D=F.getCanvas();var G=this._options.blurRadius!==this._lastBlurRadius;var C=undefined;if(G||this._cachedBlurredCanvas===null){C=this._blurCanvas(F);this._cachedBlurredCanvas=C;this._lastBlurRadius=this._options.blurRadius;this._lastGradientRadius=this._options.gradientRadius}else{C=this._cachedBlurredCanvas}var E=this._createMask(F);this._applyMask(D,C,E)}},{key:"_blurCanvas",value:function v(F){var E=F.cloneCanvas();var D=E.getContext("2d");var C=D.getImageData(0,0,E.width,E.height);b["default"].stackBlurCanvasRGBA(C,0,0,E.width,E.height,this._options.blurRadius);D.putImageData(C,0,0);return E}},{key:"_createMask",value:function B(I){var E=I.getCanvas();var D=new g["default"](E.width,E.height);var F=this._options.gradientRadius;var H=I.createCanvas(E.width,E.height);var G=H.getContext("2d");var C=this._options.position.clone();if(this._options.numberFormat==="relative"){C.multiply(D)}var J=G.createRadialGradient(C.x,C.y,0,C.x,C.y,F);J.addColorStop(0,"#FFFFFF");J.addColorStop(1,"#000000");G.fillStyle=J;G.fillRect(0,0,E.width,E.height);return H}},{key:"_applyMask",value:function y(E,G,F){var J=E.getContext("2d");var K=G.getContext("2d");var L=F.getContext("2d");var M=J.getImageData(0,0,E.width,E.height);var C=M.data;var H=K.getImageData(0,0,E.width,E.height).data;var O=L.getImageData(0,0,E.width,E.height).data;var I,D;for(var N=0;N<E.height;N++){for(var P=0;P<E.width;P++){I=(N*E.width+P)*4;D=O[I]/255;C[I]=D*C[I]+(1-D)*H[I];C[I+1]=D*C[I+1]+(1-D)*H[I+1];C[I+2]=D*C[I+2]+(1-D)*H[I+2]}}J.putImageData(M,0,0)}},{key:"dirty",set:function A(C){n(Object.getPrototypeOf(x.prototype),"dirty",C,this);this._cachedBlurredCanvas=null},get:function u(){return c(Object.getPrototypeOf(x.prototype),"dirty",this)}}]);return x})(e["default"]);o.prototype.identifier="radial-blur";o.prototype.availableOptions={position:{type:"vector2","default":new g["default"](0.5,0.5)},gradientRadius:{type:"number","default":50},blurRadius:{type:"number","default":20}};s["default"]=o;f.exports=s["default"]},function(d,h,c){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var j=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function i(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function p(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var m=c(22);var o=q(m);var g=c(4);var l=q(g);var n=c(23);var b=q(n);var k=(function(v){p(u,v);function u(){i(this,u);for(var z=arguments.length,A=Array(z),B=0;B<z;B++){A[B]=arguments[B]}j(Object.getPrototypeOf(u.prototype),"constructor",this).apply(this,A);this._textureIndex=1;this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textImage;\n      uniform vec2 u_position;\n      uniform vec2 u_size;\n\n      void main() {\n        vec4 color0 = texture2D(u_image, v_texCoord);\n        vec2 relative = (v_texCoord - u_position) / u_size;\n\n        if (relative.x >= 0.0 && relative.x <= 1.0 &&\n          relative.y >= 0.0 && relative.y <= 1.0) {\n\n            vec4 color1 = texture2D(u_textImage, relative);\n\n            // GL_SOURCE_ALPHA, GL_ONE_MINUS_SOURCE_ALPHA\n            gl_FragColor = color1 + color0 * (1.0 - color1.a);\n\n        } else {\n\n          gl_FragColor = color0;\n\n        }\n      }\n    "}f(u,[{key:"_renderWebGL",value:function s(E){var B=this._renderTextCanvas(E);var C=E.getCanvas();var F=E.getContext();var A=this._options.position.clone();var z=new l["default"](C.width,C.height);var D=new l["default"](B.width,B.height).divide(z);if(this._options.numberFormat==="absolute"){A.divide(z)}A.y=1-A.y;A.y-=D.y;if(this._options.verticalAlignment==="center"){A.y+=D.y/2}else{if(this._options.verticalAlignment==="bottom"){A.y+=D.y}}if(this._options.alignment==="center"){A.x-=D.x/2}else{if(this._options.alignment==="right"){A.x-=D.x}}F.activeTexture(F.TEXTURE0+this._textureIndex);this._texture=F.createTexture();F.bindTexture(F.TEXTURE_2D,this._texture);F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MIN_FILTER,F.LINEAR);F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MAG_FILTER,F.LINEAR);F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_S,F.CLAMP_TO_EDGE);F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_T,F.CLAMP_TO_EDGE);F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);F.texImage2D(F.TEXTURE_2D,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,B);F.activeTexture(F.TEXTURE0);E.runShader(null,this._fragmentShader,{uniforms:{u_textImage:{type:"i",value:this._textureIndex},u_position:{type:"2f",value:[A.x,A.y]},u_size:{type:"2f",value:[D.x,D.y]}}})}},{key:"_renderCanvas",value:function t(D){var A=this._renderTextCanvas(D);var B=D.getCanvas();var C=D.getContext();var z=new l["default"](B.width,B.height);var E=this._options.position.clone();if(this._options.numberFormat==="relative"){E.multiply(z)}if(this._options.verticalAlignment==="center"){E.y-=A.height/2}else{if(this._options.verticalAlignment==="bottom"){E.y-=A.height}}if(this._options.alignment==="center"){E.x-=A.width/2}else{if(this._options.alignment==="right"){E.x-=A.width}}C.drawImage(A,E.x,E.y)}},{key:"_renderTextCanvas",value:function r(E){var K=undefined,D=undefined;var B=E.createCanvas();var z=B.getContext("2d");var H=E.getCanvas();var I=new l["default"](H.width,H.height);var G=this._options.maxWidth;var A=this._options.fontSize*I.y;var F=this._options.lineHeight*A;if(this._options.numberFormat==="relative"){G*=E.getCanvas().width}this._applyTextOptions(E,z);var C=new l["default"]();var J=this._options.text.split("\n");if(typeof G!=="undefined"){C.x=G;J=this._buildOutputLines(z,G)}else{for(D=0;D<J.length;D++){K=J[D];C.x=Math.max(C.x,z.measureText(K).width)}}C.y=F*J.length;B.width=C.x;B.height=C.y;z=B.getContext("2d");z.fillStyle=this._options.backgroundColor.toRGBA();z.fillRect(0,0,B.width,B.height);this._applyTextOptions(E,z);for(D=0;D<J.length;D++){K=J[D];this._drawText(z,K,F*D)}return B}},{key:"_applyTextOptions",value:function x(D,B){var A=D.getCanvas();var z=new l["default"](A.width,A.height);var C=this._options.fontSize*z.y;B.font=this._options.fontWeight+" "+C+"px "+this._options.fontFamily;B.textBaseline="top";B.textAlign=this._options.alignment;B.fillStyle=this._options.color.toRGBA()}},{key:"_buildOutputLines",value:function w(A,H){var B=this._options.text.split("\n");var J=[];var F=[];for(var D=0;D<B.length;D++){var E=B[D];var z=E.split("");if(z.length===0){J.push("")}for(var L=0;L<z.length;L++){var K=z[L];F.push(K);var G=F.join("");var C=A.measureText(G).width;if(C>H&&F.length===1){J.push(F[0]);F=[]}else{if(C>H){var I=F.pop();J.push(F.join(""));F=[];F=[I]}else{if(L===z.length-1){J.push(F.join(""));F=[]}}}}if(F.length){J.push(F.join(""));F=[]}}return J}},{key:"_drawText",value:function y(A,B,C){var z=A.canvas;if(this._options.alignment==="center"){A.fillText(B,z.width/2,C)}else{if(this._options.alignment==="left"){A.fillText(B,0,C)}else{if(this._options.alignment==="right"){A.fillText(B,z.width,C)}}}}}]);return u})(o["default"]);k.prototype.identifier="text";k.prototype.availableOptions={fontSize:{type:"number","default":0.1},lineHeight:{type:"number","default":1.1},fontFamily:{type:"string","default":"Times New Roman"},fontWeight:{type:"string","default":"normal"},alignment:{type:"string","default":"left",available:["left","center","right"]},verticalAlignment:{type:"string","default":"top",available:["top","center","bottom"]},color:{type:"color","default":new b["default"](1,1,1,1)},backgroundColor:{type:"color","default":new b["default"](0,0,0,0)},position:{type:"vector2","default":new l["default"](0,0)},text:{type:"string",required:true},maxWidth:{type:"number","default":1}};h["default"]=k;d.exports=h["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var j=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function i(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function p(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var l=b(22);var o=q(l);var g=b(4);var k=q(g);var n=b(8);var d=q(n);var m=(function(z){p(y,z);function y(){i(this,y);for(var A=arguments.length,B=Array(A),C=0;C<A;C++){B[C]=arguments[C]}j(Object.getPrototypeOf(y.prototype),"constructor",this).apply(this,B);this._textureIndex=1;this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_stickerImage;\n      uniform vec2 u_position;\n      uniform vec2 u_size;\n\n      void main() {\n        vec4 color0 = texture2D(u_image, v_texCoord);\n        vec2 relative = (v_texCoord - u_position) / u_size;\n\n        if (relative.x >= 0.0 && relative.x <= 1.0 &&\n          relative.y >= 0.0 && relative.y <= 1.0) {\n\n            vec4 color1 = texture2D(u_stickerImage, relative);\n\n            // GL_SOURCE_ALPHA, GL_ONE_MINUS_SOURCE_ALPHA\n            gl_FragColor = color1 + color0 * (1.0 - color1.a);\n\n        } else {\n\n          gl_FragColor = color0;\n\n        }\n      }\n    ";this._loadedStickers={}}f(y,[{key:"render",value:function s(B){var A=this;return this._loadSticker().then(function(C){if(B.identifier==="webgl"){return A._renderWebGL(B,C)}else{return A._renderCanvas(B,C)}})}},{key:"_renderWebGL",value:function x(F,G){var C=F.getCanvas();var H=F.getContext();var B=this._options.position.clone();var A=new k["default"](C.width,C.height);if(this._options.numberFormat==="absolute"){B.divide(A)}var D=new k["default"](G.width,G.height);if(typeof this._options.size!=="undefined"){D.copy(this._options.size);if(this._options.numberFormat==="relative"){D.multiply(A)}var E=G.height/G.width;D.y=D.x*E}D.divide(A);B.y=1-B.y;B.y-=D.y;H.activeTexture(H.TEXTURE0+this._textureIndex);this._texture=H.createTexture();H.bindTexture(H.TEXTURE_2D,this._texture);H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,H.LINEAR);H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,H.LINEAR);H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_S,H.CLAMP_TO_EDGE);H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_T,H.CLAMP_TO_EDGE);H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);H.texImage2D(H.TEXTURE_2D,0,H.RGBA,H.RGBA,H.UNSIGNED_BYTE,G);H.activeTexture(H.TEXTURE0);F.runShader(null,this._fragmentShader,{uniforms:{u_stickerImage:{type:"i",value:this._textureIndex},u_position:{type:"2f",value:[B.x,B.y]},u_size:{type:"2f",value:[D.x,D.y]}}})}},{key:"_renderCanvas",value:function r(E,F){var B=E.getCanvas();var D=E.getContext();var A=new k["default"](B.width,B.height);var G=this._options.position.clone();if(this._options.numberFormat==="relative"){G.multiply(A)}var C=new k["default"](F.width,F.height);if(typeof this._options.size!=="undefined"){C.copy(this._options.size);if(this._options.numberFormat==="relative"){C.multiply(A)}}D.drawImage(F,0,0,F.width,F.height,G.x,G.y,C.x,C.y)}},{key:"_loadSticker",value:function v(){var A=typeof window!=="undefined";if(A){return this._loadImageBrowser(this._options.sticker)}else{return this._loadImageNode(this._options.sticker)}}},{key:"_loadImageBrowser",value:function u(B){var A=this;return new d["default"](function(D,C){if(A._loadedStickers[B]){return D(A._loadedStickers[B])}var E=new Image();E.addEventListener("load",function(){A._loadedStickers[B]=E;D(E)});E.addEventListener("error",function(){C(new Error("Could not load sticker: "+B))});E.src=A._kit.getAssetPath(B)})}},{key:"_loadImageNode",value:function w(F){var B=b(7);var A=b(26);var C=this;var E=new B.Image();var D=C._kit.getAssetPath(F);return new d["default"](function(H,G){A.readFile(D,function(J,I){if(J){return G(J)}E.src=I;H(E)})})}},{key:"stickers",get:function t(){return this._stickers}}]);return y})(o["default"]);m.prototype.identifier="stickers";m.prototype.availableOptions={sticker:{type:"string"},position:{type:"vector2","default":new k["default"](0,0)},size:{type:"vector2","default":new k["default"](0,0)}};h["default"]=m;c.exports=h["default"]},function(e,h,d){Object.defineProperty(h,"__esModule",{value:true});var g=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var j=function f(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function i(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var k=d(22);var m=o(k);var l=d(23);var c=o(l);var b=(function(r){n(s,r);function s(){i(this,s);for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}j(Object.getPrototypeOf(s.prototype),"constructor",this).apply(this,u);this._textureIndex=1;this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_frameImage;\n      uniform vec4 u_color;\n      uniform vec2 u_thickness;\n\n      void main() {\n        vec4 fragColor = texture2D(u_image, v_texCoord);\n        if (v_texCoord.x < u_thickness.x || v_texCoord.x > 1.0 - u_thickness.x ||\n          v_texCoord.y < u_thickness.y || v_texCoord.y > 1.0 - u_thickness.y) {\n            fragColor = mix(fragColor, u_color, u_color.a);\n          }\n\n        gl_FragColor = fragColor;\n      }\n    "}g(s,[{key:"_renderWebGL",value:function p(y){var w=y.getCanvas();var u=this._options.color;var x=this._options.thickness*w.height;var v=[x/w.width,x/w.height];var t={u_color:{type:"4f",value:u.toGLColor()},u_thickness:{type:"2f",value:v}};if(!this._glslPrograms[y.id]){this._glslPrograms[y.id]=y.setupGLSLProgram(null,this._fragmentShader)}y.runProgram(this._glslPrograms[y.id],{uniforms:t})}},{key:"_renderCanvas",value:function q(x){var u=x.getCanvas();var w=x.getContext();var t=this._options.color;var v=this._options.thickness*u.height;w.save();w.beginPath();w.lineWidth=v*2;w.strokeStyle=t.toRGBA();w.rect(0,0,u.width,u.height);w.stroke();w.restore()}}]);return s})(m["default"]);b.prototype.identifier="frames";b.prototype.availableOptions={color:{type:"color","default":new c["default"](0,0,0,1)},thickness:{type:"number","default":0.02}};h["default"]=b;e.exports=h["default"]},function(e,s,g){Object.defineProperty(s,"__esModule",{value:true});var o=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var b=function q(A,z,w){var x=true;_function:while(x){var u=A,C=z,t=w;v=B=y=undefined;x=false;if(u===null){u=Function.prototype}var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;w=t;x=true;continue _function}}else{if("value" in v){return v.value}else{var y=v.get;if(y===undefined){return undefined}return y.call(t)}}}};function c(t){return t&&t.__esModule?t:{"default":t}}function i(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function n(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){Object.setPrototypeOf?Object.setPrototypeOf(u,t):u.__proto__=t}}var k=g(22);var d=c(k);var l=g(4);var f=c(l);var p=g(23);var h=c(p);var r=0.02;var j=new h["default"](1,0,0,1);var m=(function(z){n(A,z);function A(){i(this,A);for(var F=arguments.length,G=Array(F),H=0;H<F;H++){G[H]=arguments[H]}b(Object.getPrototypeOf(A.prototype),"constructor",this).apply(this,G);this._textureIndex=1;this._vertexShader="\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      varying vec2 v_texCoord;\n\n      void main() {\n        gl_Position = vec4(a_position, 0, 1);\n        v_texCoord = a_texCoord;\n      }\n    ";this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textImage;\n      uniform vec2 u_position;\n      uniform vec2 u_size;\n\n      void main() {\n        vec4 color0 = texture2D(u_image, v_texCoord);\n        vec2 relative = (v_texCoord - u_position) / u_size;\n\n        if (relative.x >= 0.0 && relative.x <= 1.0 &&\n          relative.y >= 0.0 && relative.y <= 1.0) {\n\n            vec4 color1 = texture2D(u_textImage, relative);\n\n            // GL_SOURCE_ALPHA, GL_ONE_MINUS_SOURCE_ALPHA\n            gl_FragColor = color1 + color0 * (1.0 - color1.a);\n\n        } else {\n\n          gl_FragColor = color0;\n\n        }\n      }\n    ";this._brushCanvas=document.createElement("canvas")}o(A,[{key:"_renderWebGL",value:function v(H){this.renderBrushCanvas(H.getCanvas());var I=H.getContext();this._setupProgram(H);this._uploadCanvasToTexture(I,this._brushCanvas);var F=new f["default"](0,0);var G=new f["default"](1,1);H.runShader(null,this._fragmentShader,{uniforms:{u_textImage:{type:"i",value:this._textureIndex},u_position:{type:"2f",value:[F.x,F.y]},u_size:{type:"2f",value:[G.x,G.y]}}})}},{key:"_uploadCanvasToTexture",value:function y(G,F){G.activeTexture(G.TEXTURE0+this._textureIndex);this._texture=G.createTexture();G.bindTexture(G.TEXTURE_2D,this._texture);G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MIN_FILTER,G.LINEAR);G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MAG_FILTER,G.LINEAR);G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE);G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE);G.pixelStorei(G.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);G.texImage2D(G.TEXTURE_2D,0,G.RGBA,G.RGBA,G.UNSIGNED_BYTE,F);G.activeTexture(G.TEXTURE0)}},{key:"_setupProgram",value:function x(F){if(!this._glslPrograms[F.id]){this._glslPrograms[F.id]=F.setupGLSLProgram(this._vertexShader,this._fragmentShader)}}},{key:"_renderCanvas",value:function t(G){this.renderBrushCanvas(G.getCanvas());var F=G.getContext();F.drawImage(this._brushCanvas,0,0)}},{key:"renderBrushCanvas",value:function E(I){var F=arguments.length<=1||arguments[1]===undefined?this._brushCanvas:arguments[1];if(this._dirty){var H=F.getContext("2d");H.clearRect(0,0,F.width,F.height)}if(F.width!==I.width||F.height!==I.height){F.width=I.width;F.height=I.height}var K=this._options.paths;for(var G=0;G<K.length;G++){var J=K[G];J.renderToCanvas(F)}}},{key:"createPath",value:function w(G,F){var H=new A.Path(this,G,F);this._options.paths.push(H);return H}},{key:"_getLongerSideSize",value:function u(F){return Math.max(F.width,F.height)}},{key:"getLastColor",value:function D(){var F=this._options.paths[this._options.paths.length-1];if(!F){return j}return F.getColor()}},{key:"getLastThickness",value:function C(){var F=this._options.paths[this._options.paths.length-1];if(!F){return r}return F.getThickness()}},{key:"_onDirty",value:function B(){this._options.paths.forEach(function(F){F.setDirty()})}}]);return A})(d["default"]);m.prototype.identifier="brush";m.prototype.availableOptions={paths:{type:"array","default":[]}};m.Path=(function(){function v(A,B,z){i(this,v);this._thickness=B;this._color=z;this._controlPoints=[]}o(v,[{key:"renderToCanvas",value:function w(A){if(this._controlPoints.length<2){return}var C=this._controlPoints[0];var z=C;for(var B=1;B<this._controlPoints.length;B++){z=this._controlPoints[B];z.renderToCanvas(A,C);C=z}}},{key:"addControlPoint",value:function u(z){var A=new m.ControlPoint(this,z);this._controlPoints.push(A)}},{key:"getColor",value:function y(){return this._color}},{key:"getThickness",value:function t(){return this._thickness}},{key:"setDirty",value:function x(){this._controlPoints.forEach(function(z){z.setDirty()})}}]);return v})();m.ControlPoint=(function(){function t(y,x){i(this,t);this._path=y;this._drawnCanvases=[];this._position=x}o(t,[{key:"renderToCanvas",value:function v(B,D){if(this._drawnCanvases.indexOf(B)!==-1){return}var C=B.getContext("2d");var z=new f["default"](B.width,B.height);var y=Math.max(z.x,z.y);var x=this._position.clone().multiply(z);var A=D.getPosition().clone().multiply(z);C.beginPath();C.lineJoin="round";C.strokeStyle=this._path.getColor().toHex();C.lineWidth=this._path.getThickness()*y;C.moveTo(A.x,A.y);C.lineTo(x.x,x.y);C.closePath();C.stroke();this._drawnCanvases.push(B)}},{key:"getPosition",value:function u(){return this._position.clone()}},{key:"setDirty",value:function w(){this._drawnCanvases=[]}}]);return t})();s["default"]=m;e.exports=s["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var d=(function(q){k(n,q);function n(){h(this,n);i(Object.getPrototypeOf(n.prototype),"constructor",this).apply(this,arguments)}f(n,[{key:"render",value:function p(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.Contrast({contrast:0.63}));r.add(new l["default"].Primitives.Brightness({brightness:0.12}));r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,38],[94,94],[148,142],[175,187],[255,255]],green:[[0,0],[77,53],[171,190],[255,255]],blue:[[0,10],[48,85],[174,228],[255,255]]}}));r.render(s)}},{key:"name",get:function o(){return"15"}}],[{key:"identifier",get:function o(){return"a15"}}]);return n})(l["default"]);g["default"]=d;c.exports=g["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=c(27);var l=m(j);var b=(function(q){k(p,q);function p(){h(this,p);i(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,arguments)}f(p,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.Desaturation({desaturation:0.5}));r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[170,170],[212,219],[234,242],[255,255]],green:[[0,0],[170,168],[234,231],[255,255]],blue:[[0,0],[170,170],[212,208],[255,255]]}}));r.render(s)}},{key:"name",get:function n(){return"Breeze"}}],[{key:"identifier",get:function n(){return"breeze"}}]);return p})(l["default"]);g["default"]=b;d.exports=g["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var i=(function(q){k(o,q);function o(){g(this,o);h(Object.getPrototypeOf(o.prototype),"constructor",this).apply(this,arguments)}e(o,[{key:"render",value:function p(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.Grayscale());r.render(s)}},{key:"name",get:function n(){return"B&W"}}],[{key:"identifier",get:function n(){return"bw"}}]);return o})(l["default"]);f["default"]=i;c.exports=f["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=c(27);var l=m(j);var b=(function(q){k(o,q);function o(){h(this,o);i(Object.getPrototypeOf(o.prototype),"constructor",this).apply(this,arguments)}f(o,[{key:"render",value:function p(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.Grayscale());r.add(new l["default"].Primitives.Contrast({contrast:1.5}));r.render(s)}},{key:"name",get:function n(){return"1920"}}],[{key:"identifier",get:function n(){return"bwhard"}}]);return o})(l["default"]);g["default"]=b;d.exports=g["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var d=(function(q){k(o,q);function o(){h(this,o);i(Object.getPrototypeOf(o.prototype),"constructor",this).apply(this,arguments)}f(o,[{key:"render",value:function p(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,69],[55,110],[202,230],[255,255]],green:[[0,44],[89,93],[185,141],[255,189]],blue:[[0,76],[39,82],[218,138],[255,171]]}}));r.render(s)}},{key:"name",get:function n(){return"Celsius"}}],[{key:"identifier",get:function n(){return"celsius"}}]);return o})(l["default"]);g["default"]=d;c.exports=g["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var f=(function(p){k(q,p);function q(){h(this,q);i(Object.getPrototypeOf(q.prototype),"constructor",this).apply(this,arguments)}e(q,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[44,44],[124,143],[221,204],[255,255]],green:[[0,0],[130,127],[213,199],[255,255]],blue:[[0,0],[51,52],[219,204],[255,255]]}}));r.render(s)}},{key:"name",get:function n(){return"Chest"}}],[{key:"identifier",get:function n(){return"chest"}}]);return q})(l["default"]);g["default"]=f;c.exports=g["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var i=b(27);var l=m(i);var j=(function(q){k(n,q);function n(){g(this,n);h(Object.getPrototypeOf(n.prototype),"constructor",this).apply(this,arguments)}e(n,[{key:"render",value:function p(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[44,28],[63,48],[128,132],[235,248],[255,255]],green:[[0,0],[20,10],[60,45],[190,209],[211,231],[255,255]],blue:[[0,31],[41,62],[150,142],[234,212],[255,224]]}}));r.render(s)}},{key:"name",get:function o(){return"Fixie"}}],[{key:"identifier",get:function o(){return"fixie"}}]);return n})(l["default"]);f["default"]=j;c.exports=f["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var f=(function(q){k(p,q);function p(){h(this,p);i(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,arguments)}e(p,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.Saturation({saturation:1.35}));r.add(new l["default"].Primitives.Contrast({contrast:1.1}));r.render(s)}},{key:"name",get:function n(){return"Food"}}],[{key:"identifier",get:function n(){return"food"}}]);return p})(l["default"]);g["default"]=f;c.exports=g["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=c(27);var l=m(j);var b=(function(q){k(n,q);function n(){h(this,n);i(Object.getPrototypeOf(n.prototype),"constructor",this).apply(this,arguments)}f(n,[{key:"render",value:function p(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,9],[21,11],[45,24],[255,220]],green:[[0,12],[21,21],[42,42],[150,150],[170,173],[255,210]],blue:[[0,28],[43,72],[128,185],[255,220]]}}));r.render(s)}},{key:"name",get:function o(){return"Fridge"}}],[{key:"identifier",get:function o(){return"fridge"}}]);return n})(l["default"]);g["default"]=b;d.exports=g["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function j(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var i=b(27);var l=m(i);var k=(function(q){j(n,q);function n(){g(this,n);h(Object.getPrototypeOf(n.prototype),"constructor",this).apply(this,arguments)}e(n,[{key:"render",value:function p(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,65],[28,67],[67,113],[125,183],[187,217],[255,229]],green:[[0,52],[42,59],[104,134],[169,209],[255,240]],blue:[[0,52],[65,68],[93,104],[150,153],[255,198]]}}));r.render(s)}},{key:"name",get:function o(){return"Front"}}],[{key:"identifier",get:function o(){return"front"}}]);return n})(l["default"]);f["default"]=k;c.exports=f["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function j(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var i=b(27);var l=m(i);var k=(function(q){j(p,q);function p(){g(this,p);h(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,arguments)}e(p,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.Contrast({contrast:1.1}));r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[127,127],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}));r.render(s)}},{key:"name",get:function n(){return"Glam"}}],[{key:"identifier",get:function n(){return"glam"}}]);return p})(l["default"]);f["default"]=k;c.exports=f["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=c(27);var l=m(j);var b=(function(q){k(n,q);function n(){h(this,n);i(Object.getPrototypeOf(n.prototype),"constructor",this).apply(this,arguments)}f(n,[{key:"render",value:function p(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.Gobblin());r.render(s)}},{key:"name",get:function o(){return"Gobblin"}}],[{key:"identifier",get:function o(){return"gobblin"}}]);return n})(l["default"]);g["default"]=b;d.exports=g["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var i=(function(q){k(o,q);function o(){g(this,o);h(Object.getPrototypeOf(o.prototype),"constructor",this).apply(this,arguments)}e(o,[{key:"render",value:function p(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({controlPoints:[[0,0],[53,32],[91,80],[176,205],[255,255]]}));r.add(new l["default"].Primitives.Saturation({saturation:0.9}));r.render(s)}},{key:"name",get:function n(){return"K1"}}],[{key:"identifier",get:function n(){return"k1"}}]);return o})(l["default"]);f["default"]=i;c.exports=f["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var i=function e(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function h(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function l(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var j=c(27);var n=o(j);var k=c(23);var b=o(k);var m=(function(s){l(r,s);function r(){h(this,r);i(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,arguments)}f(r,[{key:"render",value:function q(u){var t=new n["default"].PrimitivesStack();t.add(new n["default"].Primitives.ToneCurve({controlPoints:[[0,0],[54,33],[77,82],[94,103],[122,126],[177,193],[229,232],[255,255]]}));t.add(new n["default"].Primitives.SoftColorOverlay({color:new b["default"](40/255,40/255,40/255)}));t.render(u)}},{key:"name",get:function p(){return"K2"}}],[{key:"identifier",get:function p(){return"k2"}}]);return r})(n["default"]);g["default"]=m;d.exports=g["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=c(27);var l=m(j);var b=(function(q){k(p,q);function p(){h(this,p);i(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,arguments)}f(p,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.Saturation({saturation:0.5}));r.render(s)}},{key:"name",get:function n(){return"K6"}}],[{key:"identifier",get:function n(){return"k6"}}]);return p})(l["default"]);g["default"]=b;d.exports=g["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var i=(function(q){k(p,q);function p(){g(this,p);h(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,arguments)}e(p,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({controlPoints:[[0,0],[17,27],[46,69],[90,112],[156,200],[203,243],[255,255]]}));r.add(new l["default"].Primitives.Saturation({saturation:0.7}));r.render(s)}},{key:"name",get:function n(){return"KDynamic"}}],[{key:"identifier",get:function n(){return"kdynamic"}}]);return p})(l["default"]);f["default"]=i;c.exports=f["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var f=(function(q){k(p,q);function p(){h(this,p);i(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,arguments)}e(p,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.Desaturation({desaturation:0.4}));r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,20],[40,20],[106,111],[129,153],[190,223],[255,255]],green:[[0,20],[40,20],[62,41],[106,108],[132,159],[203,237],[255,255]],blue:[[0,40],[40,40],[73,60],[133,160],[191,297],[203,237],[237,239],[255,255]]}}));r.render(s)}},{key:"name",get:function n(){return"Lenin"}}],[{key:"identifier",get:function n(){return"lenin"}}]);return p})(l["default"]);g["default"]=f;c.exports=g["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=c(27);var l=m(j);var b=(function(q){k(p,q);function p(){h(this,p);i(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,arguments)}f(p,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({controlPoints:[[0,0],[87,20],[131,156],[183,205],[255,200]]}));r.render(s)}},{key:"name",get:function n(){return"Lomo"}}],[{key:"identifier",get:function n(){return"lomo"}}]);return p})(l["default"]);g["default"]=b;d.exports=g["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var i=b(27);var l=m(i);var j=(function(q){k(p,q);function p(){g(this,p);h(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,arguments)}e(p,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[41,84],[87,134],[255,255]],green:[[0,0],[255,216]],blue:[[0,0],[255,131]]}}));r.render(s)}},{key:"name",get:function n(){return"Mellow"}}],[{key:"identifier",get:function n(){return"mellow"}}]);return p})(l["default"]);f["default"]=j;c.exports=f["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var i=(function(p){k(q,p);function q(){g(this,q);h(Object.getPrototypeOf(q.prototype),"constructor",this).apply(this,arguments)}e(q,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,40],[255,230]],green:[[0,10],[255,225]],blue:[[0,20],[255,181]]}}));r.add(new l["default"].Primitives.Glow());r.render(s)}},{key:"name",get:function n(){return"Morning"}}],[{key:"identifier",get:function n(){return"morning"}}]);return q})(l["default"]);f["default"]=i;c.exports=f["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var i=(function(q){k(o,q);function o(){g(this,o);h(Object.getPrototypeOf(o.prototype),"constructor",this).apply(this,arguments)}e(o,[{key:"render",value:function p(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[115,130],[195,215],[255,255]],green:[[0,0],[148,153],[172,215],[255,255]],blue:[[0,46],[58,75],[178,205],[255,255]]}}));r.add(new l["default"].Primitives.ToneCurve({controlPoints:[[0,0],[117,151],[189,217],[255,255]]}));r.add(new l["default"].Primitives.Desaturation({desaturation:0.65}));r.render(s)}},{key:"name",get:function n(){return"Orchid"}}],[{key:"identifier",get:function n(){return"orchid"}}]);return o})(l["default"]);f["default"]=i;c.exports=f["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var e=(function(q){k(p,q);function p(){h(this,p);i(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,arguments)}f(p,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[34,34],[99,76],[176,190],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}));r.add(new l["default"].Primitives.Saturation({saturation:0.8}));r.add(new l["default"].Primitives.Contrast({contrast:1.5}));r.render(s)}},{key:"name",get:function n(){return"Pola SX"}}],[{key:"identifier",get:function n(){return"pola"}}]);return p})(l["default"]);g["default"]=e;c.exports=g["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=c(27);var l=m(j);var b=(function(q){k(n,q);function n(){h(this,n);i(Object.getPrototypeOf(n.prototype),"constructor",this).apply(this,arguments)}f(n,[{key:"render",value:function p(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[56,18],[196,209],[255,255]],green:[[0,38],[71,84],[255,255]],blue:[[0,0],[131,133],[204,211],[255,255]]}}));r.add(new l["default"].Primitives.Saturation({saturation:0.8}));r.add(new l["default"].Primitives.Contrast({contrast:1.5}));r.render(s)}},{key:"name",get:function o(){return"Pola 669"}}],[{key:"identifier",get:function o(){return"pola669"}}]);return n})(l["default"]);g["default"]=b;d.exports=g["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var d=(function(q){k(o,q);function o(){h(this,o);i(Object.getPrototypeOf(o.prototype),"constructor",this).apply(this,arguments)}f(o,[{key:"render",value:function p(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.Desaturation({desaturation:0.65}));r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,50],[40,78],[118,170],[181,211],[255,255]],green:[[0,27],[28,45],[109,157],[157,195],[179,208],[206,212],[255,240]],blue:[[0,50],[12,55],[46,103],[103,162],[194,182],[241,201],[255,219]]}}));r.render(s)}},{key:"name",get:function n(){return"Quozi"}}],[{key:"identifier",get:function n(){return"quozi"}}]);return o})(l["default"]);g["default"]=d;c.exports=g["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var i=(function(p){k(q,p);function q(){g(this,q);h(Object.getPrototypeOf(q.prototype),"constructor",this).apply(this,arguments)}e(q,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,129],[75,153],[181,227],[255,255]],green:[[0,8],[111,85],[212,158],[255,226]],blue:[[0,5],[75,22],[193,90],[255,229]]}}));r.add(new l["default"].Primitives.Glow());r.render(s)}},{key:"name",get:function n(){return"Semi Red"}}],[{key:"identifier",get:function n(){return"semired"}}]);return q})(l["default"]);f["default"]=i;c.exports=f["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=c(27);var l=m(j);var b=(function(q){k(p,q);function p(){h(this,p);i(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,arguments)}f(p,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[62,82],[141,154],[255,255]],green:[[0,39],[56,96],[192,176],[255,255]],blue:[[0,0],[174,99],[255,235]]}}));r.add(new l["default"].Primitives.ToneCurve({controlPoints:[[0,0],[55,20],[158,191],[255,255]]}));r.render(s)}},{key:"name",get:function n(){return"Sunny"}}],[{key:"identifier",get:function n(){return"sunny"}}]);return p})(l["default"]);g["default"]=b;d.exports=g["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var i=(function(p){k(q,p);function q(){g(this,q);h(Object.getPrototypeOf(q.prototype),"constructor",this).apply(this,arguments)}e(q,[{key:"render",value:function o(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,72],[89,99],[176,212],[255,237]],green:[[0,49],[255,192]],blue:[[0,72],[255,151]]}}));r.render(s)}},{key:"name",get:function n(){return"Texas"}}],[{key:"identifier",get:function n(){return"texas"}}]);return q})(l["default"]);f["default"]=i;c.exports=f["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(27);var l=m(j);var d=(function(q){k(n,q);function n(){h(this,n);i(Object.getPrototypeOf(n.prototype),"constructor",this).apply(this,arguments)}f(n,[{key:"render",value:function p(s){var r=new l["default"].PrimitivesStack();r.add(new l["default"].Primitives.X400());r.render(s)}},{key:"name",get:function o(){return"X400"}}],[{key:"identifier",get:function o(){return"x400"}}]);return n})(l["default"]);g["default"]=d;c.exports=g["default"]},function(e,F,g){Object.defineProperty(F,"__esModule",{value:true});var z=(function(){function G(K,I){for(var H=0;H<I.length;H++){var J=I[H];J.enumerable=J.enumerable||false;J.configurable=true;if("value" in J){J.writable=true}Object.defineProperty(K,J.key,J)}}return function(J,H,I){if(H){G(J.prototype,H)}if(I){G(J,I)}return J}})();var b=function D(N,K,J){var L=true;_function:while(L){var H=N,P=K,G=J;I=O=M=undefined;L=false;if(H===null){H=Function.prototype}var I=Object.getOwnPropertyDescriptor(H,P);if(I===undefined){var O=Object.getPrototypeOf(H);if(O===null){return undefined}else{N=O;K=P;J=G;L=true;continue _function}}else{if("value" in I){return I.value}else{var M=I.get;if(M===undefined){return undefined}return M.call(G)}}}};function d(G){return G&&G.__esModule?G:{"default":G}}function i(G,H){if(!(G instanceof H)){throw new TypeError("Cannot call a class as a function")}}function w(H,G){if(typeof G!=="function"&&G!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof G)}H.prototype=Object.create(G&&G.prototype,{constructor:{value:H,enumerable:false,writable:true,configurable:true}});if(G){Object.setPrototypeOf?Object.setPrototypeOf(H,G):H.__proto__=G}}var m=g(9);var n=d(m);var E=g(15);var y=d(E);var u=g(4);var f=d(u);var C=g(83);var x=d(C);var t=g(85);var h=d(t);var j=g(86);var r=d(j);var k=g(87);var v=d(k);var l=g(88);var p=d(l);var q=g(89);var c=d(q);var B=g(90);var s=d(B);var A=g(14);var o=(function(ae){w(au,ae);function au(){i(this,au);for(var aw=arguments.length,ax=Array(aw),ay=0;ay<aw;ay++){ax[ay]=arguments[ay]}b(Object.getPrototypeOf(au.prototype),"constructor",this).apply(this,ax);this._operationsMap={};this._template=function(aB){var aA='<div class="imglykit"> <div class="imglykit-loadingOverlay"> <div class="imglykit-loadingOverlay-content"> <img src="'+(aB.helpers.assetPath("ui/night/loading.gif"))+'" /> <span>'+(aB.helpers.translate("generic.loading"))+'...</span> </div> </div> <div class="imglykit-flashOverlay"> <div class="imglykit-flashOverlay-close"> <img src="'+(aB.helpers.assetPath("ui/night/close.png"))+'" /> </div> <div class="imglykit-flashOverlay-headline"></div> <div class="imglykit-flashOverlay-text"></div> </div> <div class="imglykit-container"> ';if(!aB.options.ui.hideHeader){aA+=' <div class="imglykit-header-row"> <div class="imglykit-header"> img.ly Photo Editor SDK ';if(aB.options.ui.showCloseButton){aA+=' <div class="imglykit-close-button"> <img src="'+(aB.helpers.assetPath("ui/night/close.png"))+'" /> </div> '}aA+=" </div> </div> "}aA+=" ";if(aB.renderControls){aA+=' <div class="imglykit-top-controls-row"> <div class="imglykit-top-controls"> <div class="imglykit-top-controls-left"> ';if(aB.options.ui.showNewButton){aA+=' <div class="imglykit-new"> <img src="'+(aB.helpers.assetPath("ui/night/top/new.png"))+'" /> '+(aB.helpers.translate("top-controls.new"))+" </div> "}aA+=" ";if(aB.options.ui.showExportButton){aA+=' <div class="imglykit-export"> <img src="'+(aB.helpers.assetPath("ui/night/top/export.png"))+'" /> '+(aB.helpers.translate("top-controls.export"))+" </div> "}aA+=' <div class="imglykit-undo"> <img src="'+(aB.helpers.assetPath("ui/night/top/undo.png"))+'" /> '+(aB.helpers.translate("top-controls.undo"))+' </div> </div> <div class="imglykit-top-controls-right"> <div class="imglykit-zoom-fit"></div> <div class="imglykit-zoom-level">'+(aB.helpers.translate("top-controls.zoom"))+': <span class="imglykit-zoom-level-num">100</span>%</div> <div class="imglykit-zoom-in"> <img src="'+(aB.helpers.assetPath("ui/night/top/zoom-in.png"))+'" /> </div> <div class="imglykit-zoom-out"> <img src="'+(aB.helpers.assetPath("ui/night/top/zoom-out.png"))+'" /> </div> </div> </div> </div> '}aA+=' <div class="imglykit-canvas-container-row"> <div class="imglykit-canvas-container"> ';if(aB.renderWebcam){aA+=' <div class="imglykit-canvas-inner-container"> <video class="imglykit-webcam-video" autoplay></video> </div> '}aA+=" ";if(!(aB.renderSplashScreen||aB.renderWebcam)){aA+=' <div class="imglykit-canvas-inner-container"> <canvas class="imglykit-canvas-draggable"></canvas> <div class="imglykit-canvas-controls imglykit-canvas-controls-disabled"></div> </div> '}aA+=" ";if(aB.renderSplashScreen){aA+=' <div class="imglykit-splash-container"> ';if(aB.options.ui.showUploadButton){aA+=' <div class="imglykit-splash-row imglykit-splash-row--upload"> <div class="imglykit-splash-cell"> <input type="file" class="imglykit-upload-hidden-input" /> <img src="'+(aB.helpers.assetPath("ui/night/upload.png"))+'" /> <div class="imglykit-splash-content"> <div class="imglykit-splash-button">'+(aB.helpers.translate("splash.upload.headline"))+'</div> <div class="imglykit-splash-text">'+(aB.helpers.translate("splash.upload.description"))+"</div> </div> </div> </div> "}aA+=" ";if(aB.options.ui.showUploadButton&&aB.options.ui.showWebcamButton){aA+=' <div class="imglykit-splash-row imglykit-splash-row--or"> <div class="imglykit-splash-or"> <div class="imglykit-splash-or-line"></div> <div class="imglykit-splash-or-word">'+(aB.helpers.translate("splash.or"))+'</div> <div class="imglykit-splash-or-line"></div> </div> </div> '}aA+=" ";if(aB.options.ui.showWebcamButton){aA+=' <div class="imglykit-splash-row imglykit-splash-row--camera"> <div class="imglykit-splash-cell"> <img src="'+(aB.helpers.assetPath("ui/night/shutter.png"))+'" /> <div class="imglykit-splash-content"> <div class="imglykit-splash-button">'+(aB.helpers.translate("splash.webcam.headline"))+'</div> <div class="imglykit-splash-text">'+(aB.helpers.translate("splash.webcam.description"))+"</div> </div> </div> </div> "}aA+=" </div> "}aA+=" </div> </div> ";if(aB.renderWebcam){aA+=' <div class="imglykit-controls-row"> <div class="imglykit-controls-container"> <div class="imglykit-controls"> <div class="imglykit-webcam-button"> <img src="'+(aB.helpers.assetPath("ui/night/shutter-button.png"))+'" /> </div> </div> </div> </div> '}aA+=" ";if(aB.renderControls){aA+=' <div class="imglykit-controls-row"> <div class="imglykit-controls-container"> <div class="imglykit-controls"> <div> <div class="imglykit-controls-overview"> <ul class="imglykit-controls-list"> ';for(var az in aB.controls){aA+=" ";var aC=aB.controls[az];aA+=' <li class="imglykit-controls-item--with-label" data-identifier="'+(aC.identifier)+'"';if(aB.controlsDisabled){aA+=" data-disabled"}aA+='> <img src="'+(aB.helpers.assetPath("ui/night/operations/"+aC.identifier+".png"))+'" /> <div class="imglykit-controls-label">'+(aB.helpers.translate("operations."+aC.identifier))+"</div> </li> "}aA+=" </ul> </div> </div> </div> </div> </div> "}aA+=" </div></div>";return aA};this._registeredControls={};this._history=[];this._imageResized=false;this._preferredOperationOrder=["rotation","crop","flip","filters","contrast","brightness","saturation","radial-blur","tilt-shift","frames","stickers","text","brush"];this._paused=false;this._options.ui=y["default"].defaults(this._options.ui,{showNewButton:!this._options.image,showUploadButton:true,showWebcamButton:true,showHeader:true,showCloseButton:false,showExportButton:false,language:"en",maxMegaPixels:10,"export":{}});this._options.ui["export"]=y["default"].defaults(this._options.ui["export"],{type:A.ImageFormat.JPEG,quality:0.8})}z(au,[{key:"run",value:function ab(){this._fixOperationsStack();this._registerControls();this._registerLanguages();this._loadLanguage();b(Object.getPrototypeOf(au.prototype),"run",this).call(this);var aw=this._options.container;this.hideFlashMessage=this.hideFlashMessage.bind(this);this._controlsContainer=aw.querySelector(".imglykit-controls");this._canvasControlsContainer=aw.querySelector(".imglykit-canvas-controls");this._overviewControlsContainer=aw.querySelector(".imglykit-controls-overview");this._loadingOverlay=aw.querySelector(".imglykit-loadingOverlay");this._loadingSpan=aw.querySelector(".imglykit-loadingOverlay span");this._flashOverlay=aw.querySelector(".imglykit-flashOverlay");this._flashHeadline=this._flashOverlay.querySelector(".imglykit-flashOverlay-headline");this._flashText=this._flashOverlay.querySelector(".imglykit-flashOverlay-text");this._flashCloseButton=this._flashOverlay.querySelector(".imglykit-flashOverlay-close");this._flashCloseButton.addEventListener("click",this.hideFlashMessage);this._handleOverview();if(this._options.image){this._resizeImageIfNecessary()}if(this._options.image){this._initCanvas()}if(this.context.renderSplashScreen){this._initFileLoader();if(this._options.ui.showWebcamButton){this._handleWebcamButton()}}if(this.context.renderWebcam){this._initWebcam()}this._initTopControls();this._initControls();if(this._options.image){this.showZoom()}if(this._options.ui.showCloseButton){this._handleCloseButton()}if(this._topControls){this._topControls.updateExportButton()}if(this._canvas){this._canvas.run()}}},{key:"_loadLanguage",value:function ao(){this._language=this._languages[this._options.ui.language];if(!this._language){var aw=Object.keys(this._languages).join(", ");throw new Error("Unknown language '"+this._options.ui.language+"'. Available languages are: "+aw)}}},{key:"_fixOperationsStack",value:function ag(){var aB=this._kit.operationsStack;var aw=[];for(var aA=0;aA<aB.length;aA++){var ay=aB[aA];var az=ay.identifier;var ax=this._preferredOperationOrder.indexOf(az);aw[ax]=ay;this._operationsMap[az]=ay}this._kit.operationsStack=aw}},{key:"_initWebcam",value:function ap(){this._webcam=new p["default"](this._kit,this);this._webcam.on("image",this._onWebcamImageTaken.bind(this))}},{key:"_onWebcamImageTaken",value:function L(aw){this._options.ui.startWithWebcam=false;this._setImage(aw)}},{key:"_handleWebcamButton",value:function af(){var ay=this;var aw=this._options.container;var ax=aw.querySelector(".imglykit-splash-row--camera");ax.addEventListener("click",function(){ay._options.ui.startWithWebcam=true;ay.run()})}},{key:"_initFileLoader",value:function ar(){this._fileLoader=new r["default"](this._kit,this);this._fileLoader.on("file",this._onFileLoaded.bind(this))}},{key:"_onFileLoaded",value:function ac(ax){var ay=this;var aw=new FileReader();aw.onload=(function(){return function(aB){var az=aB.target.result;var aA=new Image();aA.addEventListener("load",function(){ay._setImage(aA)});aA.src=az}})(ax);aw.readAsDataURL(ax)}},{key:"_setImage",value:function aa(aw){this._kit.setImage(aw);this.run()}},{key:"_initTopControls",value:function T(){var aw=this;if(!this.context.renderControls){return}this._topControls=new c["default"](this._kit,this);this._topControls.run();this._topControls.on("new",function(){aw._options.image=null;aw.run()});this._topControls.on("undo",function(){aw.undo()});this._topControls.on("export",function(){aw["export"]()});this._topControls.on("zoom-in",function(){aw._canvas.zoomIn().then(function(){if(aw._currentControl){aw._currentControl.onZoom()}})});this._topControls.on("zoom-out",function(){aw._canvas.zoomOut().then(function(){if(aw._currentControl){aw._currentControl.onZoom()}})})}},{key:"_resizeImageIfNecessary",value:function W(){var aA=this._options.image;var az=new f["default"](aA.width,aA.height);var aC=az.x*az.y/1000000;if(aC>this._options.ui.maxMegaPixels){var ay=this._options.ui.maxMegaPixels*1000000;var aw=az.x/az.y;var aB=az.y/az.x;var ax=new f["default"](Math.sqrt(ay*aw),Math.sqrt(ay*aB)).floor();this.displayFlashMessage(this.translate("generic.warning_headline"),this.translate("warnings.image_resized",this._options.ui.maxMegaPixels,ax.x,ax.y),"warning");this._imageResized=true;this._options.image=v["default"].resize(this._options.image,ax)}}},{key:"_initCanvas",value:function U(){var aw=this;this._canvas=new h["default"](this._kit,this,this._options);this._canvas.on("zoom",function(){aw._topControls.updateZoomLevel()});this._canvas.on("error",function(ax){aw.displayErrorMessage(ax)})}},{key:"displayErrorMessage",value:function ah(aw){var ax=this.translate("errors."+aw);this.displayFlashMessage("An error has occurred!",ax+" ("+aw+")","error")}},{key:"displayFlashMessage",value:function at(aw,ay){var ax=arguments.length<=2||arguments[2]===undefined?"notice":arguments[2];this._flashText.textContent=ay;this._flashHeadline.textContent=aw;this._flashOverlay.style.display="block";this._flashOverlay.className="imglykit-flashOverlay imglykit-flashOverlay--"+ax}},{key:"hideFlashMessage",value:function O(){this._flashOverlay.style.display="none"}},{key:"selectOperations",value:function aj(aw){b(Object.getPrototypeOf(au.prototype),"selectOperations",this).call(this,aw)}},{key:"getOrCreateOperation",value:function V(ay){var aB=this._kit;var aA=aB.operationsStack;var aC=aB.registeredOperations;var aw=aC[ay];if(typeof this._operationsMap[ay]==="undefined"){var az=new aw(this._kit);this._operationsMap[ay]=az;var ax=this._preferredOperationOrder.indexOf(ay);if(ax===-1){ax=this._preferredOperationOrder.length}aA[ax]=az;return az}else{return this._operationsMap[ay]}}},{key:"removeOperation",value:function M(ay){if(!this._operationsMap[ay]){return}var aw=this._operationsMap[ay];delete this._operationsMap[ay];var ax=this._kit.operationsStack.indexOf(aw);this._kit.operationsStack[ax]=null}},{key:"_registerControls",value:function K(){this.registerControl("filters","filters",g(91));this.registerControl("rotation","rotation",g(93));this.registerControl("flip","flip",g(94));this.registerControl("brightness","brightness",g(95));this.registerControl("contrast","contrast",g(97));this.registerControl("saturation","saturation",g(98));this.registerControl("crop","crop",g(99));this.registerControl("radial-blur","radial-blur",g(100));this.registerControl("tilt-shift","tilt-shift",g(102));this.registerControl("frames","frames",g(103));this.registerControl("stickers","stickers",g(105));this.registerControl("text","text",g(106));this.registerControl("brush","brush",g(107))}},{key:"_registerLanguages",value:function J(){this.registerLanguage("en",g(108));this.registerLanguage("de",g(109))}},{key:"_handleOverview",value:function am(){var aw=this;if(!this.context.renderControls){return}var aA=this._overviewControlsContainer.querySelector("ul");if(!aA.parentNode===this._overviewControlsContainer){return}var ay=[].filter.call(aA.querySelectorAll("li"),function(aB){return aB.parentNode===aA});var az=function(aC){var aD=ay[aC];var aB=aD.getAttribute("data-identifier");aD.addEventListener("click",function(){aw.switchToControl(aB)})};for(var ax=0;ax<ay.length;ax++){az(ax)}}},{key:"_enableControls",value:function Y(){var az=this._overviewControlsContainer.querySelector("ul");if(!az.parentNode===this._overviewControlsContainer){return}var ay=[].filter.call(az.querySelectorAll("li"),function(aA){return aA.parentNode===az});for(var aw=0;aw<ay.length;aw++){var ax=ay[aw];ax.removeAttribute("data-disabled")}}},{key:"switchToControl",value:function av(aw){if(this.context.controlsDisabled){return}this._overviewControlsContainer.style.display="none";this._scrollbar.remove();if(this._currentControl){this._currentControl.leave()}this._currentControl=this._registeredControls[aw];this._currentControl.enter();this._currentControl.once("back",this._switchToOverview.bind(this))}},{key:"_switchToOverview",value:function H(){if(this._currentControl){this._currentControl.leave()}this._currentControl=null;this._overviewControlsContainer.style.display="";this._initScrollbar()}},{key:"registerControl",value:function an(ay,ax,az){if(!this.isOperationSelected(ax)){return}var aw=new az(this._kit,this);this._registeredControls[ay]=aw}},{key:"_initControls",value:function Z(){for(var aw in this._registeredControls){var ax=this._registeredControls[aw];ax.setContainers(this._controlsContainer,this._canvasControlsContainer);ax.init()}this._initScrollbar()}},{key:"_initScrollbar",value:function X(){if(!this.context.renderControls){return}var aw=this._controlsContainer.querySelector(".imglykit-controls-list").parentNode;this._scrollbar=new s["default"](aw)}},{key:"_handleCloseButton",value:function P(){var ax=this;var aw=this._options.container.querySelector(".imglykit-close-button");aw.addEventListener("click",function(ay){ay.preventDefault();ax.emit("close")})}},{key:"render",value:function ai(){if(this._canvas){this._canvas.render()}}},{key:"pause",value:function G(){this._paused=true}},{key:"resume",value:function R(){var aw=arguments.length<=0||arguments[0]===undefined?true:arguments[0];this._paused=false;if(aw){this.render()}}},{key:"addHistory",value:function al(aw,ax,az){var ay={operation:aw,options:ax,existent:az};this._history.push(ay);this._topControls.updateUndoButton();return ay}},{key:"hideZoom",value:function I(){this._topControls.hideZoom()}},{key:"showZoom",value:function ak(){this._topControls.showZoom()}},{key:"undo",value:function ad(){var aw=this;var az=this._history.pop();var aB=n["default"].resolve();if(az){var ax=az.operation;var aA=az.existent;var ay=az.options;if(!aA){this.removeOperation(ax.identifier)}else{ax=this.getOrCreateOperation(ax.identifier);ax.set(ay)}aB=this.canvas.zoomToFit(true)}this._topControls.updateUndoButton();aB.then(function(){if(aw._currentControl){aw._currentControl.update()}})}},{key:"export",value:function Q(){var aw=this;this.displayLoadingMessage(this.translate("generic.exporting")+"...");var ay=A.RenderType.DATAURL;var ax=document.createElement("canvas");if(typeof ax.msToBlob!=="undefined"){ay=A.RenderType.MSBLOB}setTimeout(function(){aw._kit.render(ay,aw._options.ui["export"].type,aw._options.ui["export"].dimensions,aw._options.ui["export"].quality).then(function(aB){switch(ay){case A.RenderType.DATAURL:var az=y["default"].createBlobURIFromDataURI(aB);var aA=document.createElement("a");var aC=aw._options.ui["export"].type.split("/").pop();aA.download="imglykit-export."+aC;aA.href=az;document.body.appendChild(aA);aA.click();document.body.removeChild(aA);break;case A.RenderType.MSBLOB:navigator.msSaveBlob(aB,"imglykit-export.png");break}aw.hideLoadingMessage()})},1000)}},{key:"displayLoadingMessage",value:function N(aw){this._loadingSpan.textContent=aw;this._loadingOverlay.style.display="block"}},{key:"hideLoadingMessage",value:function S(){this._loadingOverlay.style.display="none"}},{key:"identifier",get:function aq(){return"night"}},{key:"operations",get:function aq(){return this._operationsMap}},{key:"controls",get:function aq(){return this._registeredControls}},{key:"context",get:function aq(){var aw=b(Object.getPrototypeOf(au.prototype),"context",this);aw.controls=this._registeredControls;aw.renderSplashScreen=!this._options.image&&!this._options.ui.startWithWebcam;aw.renderControls=!!this._options.image;aw.renderWebcam=this._options.ui.startWithWebcam;return aw}},{key:"history",get:function aq(){return this._history}},{key:"fileLoader",get:function aq(){return this._fileLoader}},{key:"imageResized",get:function aq(){return this._imageResized}}]);return au})(x["default"]);o.Control=g(92);F["default"]=o;e.exports=F["default"]},function(e,i,d){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var k=function f(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var h=d(15);var q=p(h);var c=d(2);var l=p(c);var b=d(84);var m=p(b);var n=(function(r){o(B,r);function B(D,C){j(this,B);k(Object.getPrototypeOf(B.prototype),"constructor",this).call(this);this._kit=D;this._options=C;this._options.ui=this._options.ui||{};this._operations=[];this._helpers=new m["default"](this.kit,this,C);this._languages={};this.selectOperations(null)}g(B,[{key:"run",value:function y(){this._attach()}},{key:"registerLanguage",value:function t(D,C){this._languages[D]=C}},{key:"translate",value:function v(G){var I=q["default"].fetch(this._language,G,"translation-missing");for(var D=arguments.length,E=Array(D>1?D-1:0),H=1;H<D;H++){E[H-1]=arguments[H]}for(var F=0;F<E.length;F++){var C=E[F];I=I.replace("$"+(F+1),C)}return I}},{key:"_attach",value:function s(){if(this._options.container===null){throw new Error("BaseUI#attach: No container set.")}var C=this._render();this._options.container.innerHTML=C;this._options.container.style.position="relative"}},{key:"_render",value:function z(){if(typeof this._template==="undefined"){throw new Error("BaseUI#_render: No template set.")}return this._template(this.context)}},{key:"selectOperations",value:function A(C){var F=this._kit.registeredOperations;var E=Object.keys(F);var D=q["default"].select(E,C);this._operations=D.map(function(G){return F[G]})}},{key:"addOperation",value:function x(C){this._operations.push(C)}},{key:"isOperationSelected",value:function w(C){var D=this._operations.map(function(E){return E.prototype.identifier});return D.indexOf(C)!==-1}},{key:"identifier",get:function u(){return null}},{key:"context",get:function u(){return{operations:this._operations,helpers:this._helpers,options:this._options}}},{key:"container",get:function u(){return this._options.container}},{key:"operations",get:function u(){return this._operations}},{key:"options",get:function u(){return this._options}},{key:"canvas",get:function u(){return this._canvas}},{key:"helpers",get:function u(){return this._helpers}},{key:"image",get:function u(){return this._options.image}}]);return B})(l["default"]);i["default"]=n;e.exports=i["default"]},function(e,b){Object.defineProperty(b,"__esModule",{value:true});var d=(function(){function g(l,j){for(var h=0;h<j.length;h++){var k=j[h];k.enumerable=k.enumerable||false;k.configurable=true;if("value" in k){k.writable=true}Object.defineProperty(l,k.key,k)}}return function(j,h,i){if(h){g(j.prototype,h)}if(i){g(j,i)}return j}})();function f(g,h){if(!(g instanceof h)){throw new TypeError("Cannot call a class as a function")}}var c=(function(){function h(k,l,j){f(this,h);this._kit=k;this._ui=l;this._options=j}d(h,[{key:"assetPath",value:function g(j){var l=this._options.assetsUrl+"/"+j;var k=this._ui.options.ui.assetPathResolver;if(typeof k!=="undefined"){l=k(l)}return l}},{key:"translate",value:function i(j){return this._ui.translate(j)}}]);return h})();b["default"]=c;e.exports=b["default"]},function(d,w,g){Object.defineProperty(w,"__esModule",{value:true});var s=(function(){function x(B,z){for(var y=0;y<z.length;y++){var A=z[y];A.enumerable=A.enumerable||false;A.configurable=true;if("value" in A){A.writable=true}Object.defineProperty(B,A.key,A)}}return function(A,y,z){if(y){x(A.prototype,y)}if(z){x(A,z)}return A}})();var b=function u(C,B,A){var D=true;_function:while(D){var y=C,G=B,x=A;z=F=E=undefined;D=false;if(y===null){y=Function.prototype}var z=Object.getOwnPropertyDescriptor(y,G);if(z===undefined){var F=Object.getPrototypeOf(y);if(F===null){return undefined}else{C=F;B=G;A=x;D=true;continue _function}}else{if("value" in z){return z.value}else{var E=z.get;if(E===undefined){return undefined}return E.call(x)}}}};function c(x){return x&&x.__esModule?x:{"default":x}}function i(x,y){if(!(x instanceof y)){throw new TypeError("Cannot call a class as a function")}}function p(y,x){if(typeof x!=="function"&&x!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof x)}y.prototype=Object.create(x&&x.prototype,{constructor:{value:y,enumerable:false,writable:true,configurable:true}});if(x){Object.setPrototypeOf?Object.setPrototypeOf(y,x):y.__proto__=x}}var l=g(12);var h=c(l);var t=g(5);var j=c(t);var n=g(4);var e=c(n);var v=g(15);var r=c(v);var q=g(2);var k=c(q);var m=g(8);var f=c(m);var o=(function(S){p(Q,S);function Q(ab,ac,aa){i(this,Q);b(Object.getPrototypeOf(Q.prototype),"constructor",this).call(this);this._kit=ab;this._ui=ac;this._options=aa;var Z=this._ui.container;this._canvasContainer=Z.querySelector(".imglykit-canvas-container");this._canvasInnerContainer=Z.querySelector(".imglykit-canvas-inner-container");this._canvas=this._canvasContainer.querySelector("canvas");this._image=this._options.image;this._roundZoomBy=0.1;this._isFirstRender=true;this._dragOnMousedown=this._dragOnMousedown.bind(this);this._dragOnMousemove=this._dragOnMousemove.bind(this);this._dragOnMouseup=this._dragOnMouseup.bind(this)}s(Q,[{key:"run",value:function N(){this._initRenderer();this._zoomLevel=this._getInitialZoomLevel();this._size=null;this.render();this._centerCanvas();this._handleDrag()}},{key:"getProcessedDimensions",value:function D(){var ab=this;var Z=this.sanitizedStack;var aa=new e["default"](this._image.width,this._image.height);Z.forEach(function(ac){aa=ac.getNewDimensions(ab._renderer,aa)});return aa}},{key:"render",value:function Y(){var ad=this;var ae=this._renderer.getInitialDimensionsForStack(this.sanitizedStack).multiply(this._zoomLevel);this._setCanvasSize(ae);this._renderer.setSize(ae);this._renderer.reset();var Z=this.sanitizedStack;this._updateStackDirtyStates(Z);var ac=[];for(var ab=0;ab<Z.length;ab++){var aa=Z[ab];ac.push(aa.validateSettings())}return f["default"].all(ac).then(function(){if(ad._isFirstRender&&ad._renderer.identifier==="webgl"){if(ad._image.width>ad._renderer.maxTextureSize||ad._image.height>ad._renderer.maxTextureSize){ad._ui.displayLoadingMessage("Resizing...");return new f["default"](function(ag,af){setTimeout(function(){ad._renderer.prepareImage(ad._image).then(function(ah){ad._ui.hideLoadingMessage();ad._options.image=ah;ad._image=ad._options.image;ag()})["catch"](function(ah){af(ah)})},100)})}}}).then(function(){if(ad._isFirstRender||ad._renderer.constructor.identifier==="canvas"){ad._isFirstRender=false;return ad._renderer.drawImage(ad._image)}}).then(function(){var ah=[];for(var ag=0;ag<Z.length;ag++){var af=Z[ag];ah.push(af.render(ad._renderer))}return f["default"].all(ah)}).then(function(){return ad._renderer.renderFinal()}).then(function(){ad._storeCanvasSize();ad._updateContainerSize();ad._updateCanvasMargins();ad._applyBoundaries()})["catch"](function(af){console.log(af)})}},{key:"setImage",value:function x(Z){this._image=Z;this.reset();this.render();this._centerCanvas()}},{key:"zoomIn",value:function T(){this._isInitialZoom=false;var aa=Math.round(this._zoomLevel*100);var Z=Math.round(this._roundZoomBy*100);var ab=Math.round(this._getInitialZoomLevel()*100);if(aa%Z!==0){aa=Math.ceil(aa/Z)*Z}else{aa+=Z}aa=Math.min(ab*2,aa);return this.setZoomLevel(aa/100)}},{key:"zoomOut",value:function M(){this._isInitialZoom=false;var aa=Math.round(this._zoomLevel*100);var Z=Math.round(this._roundZoomBy*100);var ab=Math.round(this._getInitialZoomLevel()*100);if(aa%Z!==0){aa=Math.floor(aa/Z)*Z}else{aa-=Z}aa=Math.max(ab,aa);return this.setZoomLevel(aa/100)}},{key:"_setCanvasSize",value:function A(Z){Z=Z||new e["default"](this._canvas.width,this._canvas.height);Z=Z.clone().floor();if(this._canvas.width===Z.x&&this._canvas.height===Z.y){return}this._canvas.width=Z.x;this._canvas.height=Z.y;this._storeCanvasSize();this._updateContainerSize()}},{key:"_updateContainerSize",value:function F(){var Z=this._size;this._canvasInnerContainer.style.width=Z.x+"px";this._canvasInnerContainer.style.height=Z.y+"px"}},{key:"_storeCanvasSize",value:function z(){this._size=new e["default"](this._canvas.width,this._canvas.height)}},{key:"_centerCanvas",value:function J(){var Z=this._maxSize.divide(2);this._canvasInnerContainer.style.left=Z.x+"px";this._canvasInnerContainer.style.top=Z.y+"px";this._updateCanvasMargins()}},{key:"_updateCanvasMargins",value:function V(){var Z=new e["default"](this._canvas.width,this._canvas.height);var aa=Z.divide(2).multiply(-1);this._canvasInnerContainer.style.marginLeft=aa.x+"px";this._canvasInnerContainer.style.marginTop=aa.y+"px"}},{key:"setZoomLevel",value:function I(ac){var ab=this;var aa=arguments.length<=1||arguments[1]===undefined?true:arguments[1];var Z=arguments.length<=2||arguments[2]===undefined?false:arguments[2];this._zoomLevel=ac;this._isInitialZoom=Z;if(aa){this.setAllOperationsToDirty();return this.render().then(function(){ab._updateCanvasMargins();ab._applyBoundaries();ab.emit("zoom")})}else{this._updateCanvasMargins();this._applyBoundaries();this.emit("zoom")}}},{key:"setAllOperationsToDirty",value:function K(){var ab=this._kit.operationsStack;for(var aa=0;aa<ab.length;aa++){var Z=ab[aa];if(!Z){continue}Z.dirty=true}}},{key:"resetAllOperations",value:function O(){var ab=this._kit.operationsStack;for(var aa=0;aa<ab.length;aa++){var Z=ab[aa];if(!Z){continue}Z.reset()}}},{key:"_getInitialZoomLevel",value:function H(){var Z=this._renderer.getOutputDimensionsForStack(this.sanitizedStack);var aa=r["default"].resizeVectorToFit(Z,this._maxSize);return aa.divide(Z).x}},{key:"_initRenderer",value:function X(){var Z=this;if(h["default"].isSupported()&&this._options.renderer!=="canvas"){this._renderer=new h["default"](null,this._canvas,this._image);this._webglEnabled=true}else{if(j["default"].isSupported()){this._renderer=new j["default"](null,this._canvas,this._image);this._webglEnabled=false}}if(this._renderer===null){throw new Error("Neither Canvas nor WebGL renderer are supported.")}this._renderer.on("new-canvas",function(aa){Z._setCanvas(aa)});this._renderer.on("error",function(){for(var aa=arguments.length,ab=Array(aa),ac=0;ac<aa;ac++){ab[ac]=arguments[ac]}Z.emit.apply(Z,["error"].concat(ab))});this._renderer.on("reset",function(){Z.resetAllOperations();Z._isFirstRender=true;Z.render()})}},{key:"_setCanvas",value:function E(Z){var aa=this._canvas.parentNode;aa.removeChild(this._canvas);this._canvas=Z;aa.appendChild(this._canvas);this._updateCanvasMargins();this._applyBoundaries();this._updateContainerSize()}},{key:"_handleDrag",value:function P(){this._canvas.addEventListener("mousedown",this._dragOnMousedown);this._canvas.addEventListener("touchstart",this._dragOnMousedown)}},{key:"_dragOnMousedown",value:function G(ab){if(ab.type==="mousedown"&&ab.button!==0){return}ab.preventDefault();var aa=parseInt(this._canvasInnerContainer.style.left,10);var Z=parseInt(this._canvasInnerContainer.style.top,10);document.addEventListener("mousemove",this._dragOnMousemove);document.addEventListener("touchmove",this._dragOnMousemove);document.addEventListener("mouseup",this._dragOnMouseup);document.addEventListener("touchend",this._dragOnMouseup);this._initialMousePosition=r["default"].getEventPosition(ab);this._initialCanvasPosition=new e["default"](aa,Z)}},{key:"_dragOnMousemove",value:function L(ab){ab.preventDefault();var aa=r["default"].getEventPosition(ab);var ac=aa.clone().subtract(this._initialMousePosition);var Z=this._initialCanvasPosition.clone().add(ac);this._canvasInnerContainer.style.left=Z.x+"px";this._canvasInnerContainer.style.top=Z.y+"px";this._applyBoundaries()}},{key:"_applyBoundaries",value:function C(){var Z=parseInt(this._canvasInnerContainer.style.left,10);var ac=parseInt(this._canvasInnerContainer.style.top,10);var ab=new e["default"](Z,ac);var aa=this._boundaries;ab.x=Math.min(aa.max.x,Math.max(aa.min.x,ab.x));ab.y=Math.min(aa.max.y,Math.max(aa.min.y,ab.y));this._canvasInnerContainer.style.left=ab.x+"px";this._canvasInnerContainer.style.top=ab.y+"px"}},{key:"_dragOnMouseup",value:function y(Z){Z.preventDefault();document.removeEventListener("mousemove",this._dragOnMousemove);document.removeEventListener("touchmove",this._dragOnMousemove);document.removeEventListener("mouseup",this._dragOnMouseup);document.removeEventListener("touchend",this._dragOnMouseup)}},{key:"_updateStackDirtyStates",value:function B(Z){var ab=false;for(var ac=0;ac<Z.length;ac++){var aa=Z[ac];if(!aa){continue}if(aa.dirty){ab=true}if(ab){aa.dirty=true}}}},{key:"zoomToFit",value:function R(){var Z=arguments.length<=0||arguments[0]===undefined?true:arguments[0];var aa=this._getInitialZoomLevel();return this.setZoomLevel(aa,Z,true)}},{key:"reset",value:function W(){this._renderer.reset(true);this._kit.operationsStack=[];this._isFirstRender=true}},{key:"_boundaries",get:function U(){var Z=new e["default"](this._canvas.width,this._canvas.height);var ad=this._maxSize;var ab=Z.clone().subtract(ad).multiply(-1);var aa={min:new e["default"](ab.x,ab.y),max:new e["default"](0,0)};if(Z.x<ad.x){aa.min.x=ab.x/2;aa.max.x=ab.x/2}if(Z.y<ad.y){aa.min.y=ab.y/2;aa.max.y=ab.y/2}var ac=Z.clone().divide(2);aa.min.add(ac);aa.max.add(ac);return aa}},{key:"_maxSize",get:function U(){return new e["default"](this._canvasContainer.offsetWidth,this._canvasContainer.offsetHeight)}},{key:"sanitizedStack",get:function U(){var ab=[];for(var aa=0;aa<this._kit.operationsStack.length;aa++){var Z=this._kit.operationsStack[aa];if(!Z){continue}ab.push(Z)}return ab}},{key:"zoomLevel",get:function U(){return this._zoomLevel}},{key:"size",get:function U(){return this._size}}]);return Q})(k["default"]);w["default"]=o;d.exports=w["default"]},function(d,h,c){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var j=function e(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function i(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function m(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var b=c(2);var l=n(b);var g=c(15);var o=n(g);var k=(function(p){m(x,p);function x(B,C){i(this,x);j(Object.getPrototypeOf(x.prototype),"constructor",this).call(this);this._kit=B;this._ui=C;this._dragCounter=0;this._container=this._ui.container.querySelector(".imglykit-splash-container");this._onDropAreaDragEnter=this._onDropAreaDragEnter.bind(this);this._onDropAreaDragOver=this._onDropAreaDragOver.bind(this);this._onDropAreaDragLeave=this._onDropAreaDragLeave.bind(this);this._onDropAreaDrop=this._onDropAreaDrop.bind(this);this._onDropAreaClick=this._onDropAreaClick.bind(this);this._onFileInputChange=this._onFileInputChange.bind(this);this._hiddenInputField=this._ui.container.querySelector(".imglykit-upload-hidden-input");this._hiddenInputField.addEventListener("change",this._onFileInputChange);this._handleDropArea();if(this._ui.options.image){this.removeDOM()}}f(x,[{key:"openFileDialog",value:function z(){this._hiddenInputField.click()}},{key:"_handleDropArea",value:function w(){this._dropArea=this._container.querySelector(".imglykit-splash-row--upload");this._dropArea.addEventListener("dragenter",this._onDropAreaDragEnter);this._dropArea.addEventListener("dragover",this._onDropAreaDragOver);this._dropArea.addEventListener("dragleave",this._onDropAreaDragLeave);this._dropArea.addEventListener("drop",this._onDropAreaDrop);this._dropArea.addEventListener("dragdrop",this._onDropAreaDrop);this._dropArea.addEventListener("click",this._onDropAreaClick)}},{key:"_onDropAreaClick",value:function u(B){B.stopPropagation();this.openFileDialog()}},{key:"_onDropAreaDragEnter",value:function A(B){B.preventDefault();this._dragCounter++;o["default"].classList(this._dropArea).add("imglykit-splash-active")}},{key:"_onDropAreaDragOver",value:function q(B){B.preventDefault()}},{key:"_onDropAreaDragLeave",value:function s(B){B.preventDefault();this._dragCounter--;if(this._dragCounter===0){o["default"].classList(this._dropArea).remove("imglykit-splash-active")}}},{key:"_onDropAreaDrop",value:function v(B){B.stopPropagation();B.preventDefault();B.returnValue=false;o["default"].classList(this._dropArea).remove("imglykit-splash-active");if(!B.dataTransfer){return}this._ui.displayLoadingMessage(this._ui.translate("generic.importing")+"...");this._handleFile(B.dataTransfer.files[0])}},{key:"_onFileInputChange",value:function r(){this._handleFile(this._hiddenInputField.files[0])}},{key:"_handleFile",value:function t(B){this.emit("file",B)}},{key:"removeDOM",value:function y(){this._dropArea.removeEventListener("dragenter",this._onDropAreaDragEnter);this._dropArea.removeEventListener("dragover",this._onDropAreaDragOver);this._dropArea.removeEventListener("dragleave",this._onDropAreaDragLeave);this._dropArea.removeEventListener("drop",this._onDropAreaDrop);this._dropArea.removeEventListener("dragdrop",this._onDropAreaDrop);this._dropArea.removeEventListener("click",this._onDropAreaClick);if(this._container){this._container.style.display="none"}}}]);return x})(l["default"]);h["default"]=k;d.exports=h["default"]},function(d,b){Object.defineProperty(b,"__esModule",{value:true});b["default"]={resize:function c(h,g){var f=document.createElement("canvas");f.width=g.x;f.height=g.y;var e=f.getContext("2d");e.drawImage(h,0,0,h.width,h.height,0,0,g.x,g.y);return f}};d.exports=b["default"]},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var k=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function o(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function n(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var b=c(2);var m=o(b);var g=c(15);var q=o(g);var h=c(4);var l=o(h);var p=(function(w){n(v,w);function v(z,A){j(this,v);k(Object.getPrototypeOf(v.prototype),"constructor",this).call(this);this._kit=z;this._ui=A;var y=this._ui.container;this._canvasContainer=y.querySelector(".imglykit-canvas-container");this._video=y.querySelector(".imglykit-webcam-video");this._webcamButton=y.querySelector(".imglykit-webcam-button");this._webcamButton.addEventListener("click",this._onWebcamButtonClick.bind(this));this._initVideoStream()}f(v,[{key:"_onWebcamButtonClick",value:function x(B){var C=this;B.preventDefault();var y=document.createElement("canvas");y.width=this._video.videoWidth;y.height=this._video.videoHeight;var z=y.getContext("2d");z.drawImage(this._video,0,0);this._stream.stop();this._video.pause();delete this._stream;delete this._video;var A=new Image();A.addEventListener("load",function(){C.emit("image",A)});A.src=y.toDataURL("image/png")}},{key:"_initVideoStream",value:function t(){var y=this;var z=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;if(!z){throw new Error("Webcam feature not supported! :(")}z.call(navigator,{video:true},function(A){y._stream=A;y._video.onloadedmetadata=y._onVideoReady.bind(y);y._video.src=window.URL.createObjectURL(A)},function(A){throw A})}},{key:"_onVideoReady",value:function u(){this._resizeVideo()}},{key:"_resizeVideo",value:function s(){var y=this._video;var E=y.videoWidth;var z=y.videoHeight;var A=new l["default"](E,z);var D=new l["default"](this._canvasContainer.offsetWidth,this._canvasContainer.offsetHeight);var C=q["default"].resizeVectorToFit(A,D);this._video.style.width=C.x+"px";this._video.style.height=C.y+"px";var B=D.clone().subtract(C).divide(2);this._video.style.marginLeft=B.x+"px";this._video.style.marginTop=B.y+"px"}},{key:"getUserMedia",get:function r(){return}}]);return v})(m["default"]);i["default"]=p;d.exports=i["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var b=c(2);var j=m(b);var k=(function(A){l(o,A);function o(F,G){h(this,o);i(Object.getPrototypeOf(o.prototype),"constructor",this).call(this);this._kit=F;this._ui=G;this.init()}f(o,[{key:"init",value:function B(){this._canvas=this._ui.canvas}},{key:"run",value:function u(){var F=this._ui.container;this._rightControls=F.querySelector(".imglykit-top-controls-right");this._leftControls=F.querySelector(".imglykit-top-controls-left");this._undoButton=F.querySelector(".imglykit-undo");this._zoomIn=F.querySelector(".imglykit-zoom-in");this._zoomOut=F.querySelector(".imglykit-zoom-out");this._zoomLevel=F.querySelector(".imglykit-zoom-level-num");this._newButton=F.querySelector(".imglykit-new");this._exportButton=F.querySelector(".imglykit-export");this._handleZoom();this._handleUndo();this._handleNew();this._handleExport()}},{key:"_handleZoom",value:function D(){this._zoomIn.addEventListener("click",this._onZoomInClick.bind(this));this._zoomOut.addEventListener("click",this._onZoomOutClick.bind(this))}},{key:"_handleUndo",value:function C(){this._undoButton.addEventListener("click",this._undo.bind(this));this._undo()}},{key:"_handleNew",value:function w(){if(!this._newButton){return}this._newButton.addEventListener("click",this._onNewClick.bind(this))}},{key:"_handleExport",value:function p(){if(!this._exportButton){return}this._exportButton.addEventListener("click",this._onExportClick.bind(this))}},{key:"_onNewClick",value:function y(F){F.preventDefault();F.stopPropagation();this.emit("new")}},{key:"_onExportClick",value:function n(F){F.preventDefault();F.stopPropagation();this.emit("export")}},{key:"_undo",value:function v(){this.emit("undo")}},{key:"updateUndoButton",value:function s(){var F=this._ui.history;if(F.length===0){this._undoButton.style.display="none"}else{this._undoButton.style.display="inline-block"}}},{key:"updateExportButton",value:function q(){if(!this._exportButton){return}var F=this._ui.image;if(F){this._exportButton.style.display="inline-block"}else{this._exportButton.style.display="none"}}},{key:"_onZoomInClick",value:function x(F){F.preventDefault();F.stopPropagation();this.emit("zoom-in");this.updateZoomLevel()}},{key:"_onZoomOutClick",value:function r(F){F.preventDefault();F.stopPropagation();this.emit("zoom-out");this.updateZoomLevel()}},{key:"showZoom",value:function t(){this._rightControls.style.display="inline-block"}},{key:"hideZoom",value:function E(){this._rightControls.style.display="none"}},{key:"updateZoomLevel",value:function z(){var F=this._canvas.zoomLevel;this._zoomLevel.innerHTML=Math.round(F*100)}}]);return o})(j["default"]);g["default"]=k;d.exports=g["default"]},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();function l(n){return n&&n.__esModule?n:{"default":n}}function j(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}var g=c(15);var m=l(g);var h=c(4);var k=l(h);var e=18;var b=(function(){function o(E){j(this,o);this._container=E;this._isDragging=false;this._isHovering=false;if(!this._browserSupported()){return}this._appendDOM();this._resizeButton();this._updateValues();this._onButtonDown=this._onButtonDown.bind(this);this._onButtonMove=this._onButtonMove.bind(this);this._onButtonUp=this._onButtonUp.bind(this);this._onContainerEnter=this._onContainerEnter.bind(this);this._onContainerLeave=this._onContainerLeave.bind(this);this._onBackgroundClick=this._onBackgroundClick.bind(this);this._container.addEventListener("mouseenter",this._onContainerEnter);this._container.addEventListener("mouseleave",this._onContainerLeave);this._container.addEventListener("mousemove",this._onContainerEnter);this._dom.button.addEventListener("mousedown",this._onButtonDown);this._dom.button.addEventListener("touchstart",this._onButtonDown);this._dom.background.addEventListener("click",this._onBackgroundClick);this._list.addEventListener("scroll",this._onListScroll.bind(this));this._onListScroll()}f(o,[{key:"_browserSupported",value:function q(){var E=navigator.appVersion.match(/MSIE ([\d.]+)/);if(E&&parseFloat(E[1])<=9){return false}return true}},{key:"_onBackgroundClick",value:function D(G){G.preventDefault();if(G.target!==this._dom.background){return}var E=m["default"].getEventPosition(G);var H=this._dom.background.getBoundingClientRect();H=new k["default"](H.left,H.top);var F=E.clone().subtract(H);F.x-=this._values.button.width*0.5;this._setButtonPosition(F.x)}},{key:"_onContainerEnter",value:function w(){this._isHovering=true;this.show()}},{key:"_onContainerLeave",value:function z(){this._isHovering=false;this.hide()}},{key:"show",value:function A(){if(!this._browserSupported()){return}if(!this._isScrollingNecessary){return}m["default"].classList(this._dom.background).add("visible")}},{key:"hide",value:function x(){if(!this._browserSupported()){return}if(this._isDragging){return}m["default"].classList(this._dom.background).remove("visible")}},{key:"_updateValues",value:function t(){this._values={list:{totalWidth:this._list.scrollWidth,visibleWidth:this._list.offsetWidth,scrollableWidth:this._list.scrollWidth-this._list.offsetWidth},button:{width:this._dom.button.offsetWidth,scrollableWidth:this._dom.background.offsetWidth-this._dom.button.offsetWidth}}}},{key:"_onButtonDown",value:function C(E){E.preventDefault();this._isDragging=true;this._initialMousePosition=m["default"].getEventPosition(E);this._initialButtonPosition=this._buttonPosition||0;document.addEventListener("mousemove",this._onButtonMove);document.addEventListener("touchmove",this._onButtonMove);document.addEventListener("mouseup",this._onButtonUp);document.addEventListener("touchend",this._onButtonUp)}},{key:"_onButtonMove",value:function u(E){E.preventDefault();var H=m["default"].getEventPosition(E);var F=H.clone().subtract(this._initialMousePosition);var G=this._initialButtonPosition+F.x;this._setButtonPosition(G)}},{key:"_setButtonPosition",value:function s(G){G=Math.max(0,G);G=Math.min(G,this._values.button.scrollableWidth);this._buttonPosition=G;this._dom.button.style.left=this._buttonPosition+"px";var F=G/this._values.button.scrollableWidth;var E=this._values.list.scrollableWidth*F;this._list.scrollLeft=E}},{key:"_onButtonUp",value:function n(){this._isDragging=false;document.removeEventListener("mousemove",this._onButtonMove);document.removeEventListener("touchmove",this._onButtonMove);document.removeEventListener("mouseup",this._onButtonUp);document.removeEventListener("touchend",this._onButtonUp)}},{key:"_onListScroll",value:function r(){if(this._isDragging){return}var H=this._list.scrollWidth-this._list.offsetWidth;var E=this._list.scrollLeft;var G=this._dom.background.offsetWidth-this._dom.button.offsetWidth;var F=E/H;this._buttonPosition=G*F;this._dom.button.style.left=this._buttonPosition+"px"}},{key:"_resizeButton",value:function y(){var E=this._list.scrollWidth;var F=this._list.offsetWidth;this._buttonWidth=F/E*F;this._dom.button.style.width=this._buttonWidth+"px"}},{key:"_appendDOM",value:function B(){var G=document.createElement("div");m["default"].classList(G).add("imglykit-scrollbar-background");G.style.bottom=e+"px";var F=document.createElement("div");m["default"].classList(F).add("imglykit-scrollbar-button");G.appendChild(F);this._container.appendChild(G);this._container.style.position="relative";this._list=this._container.querySelector(".imglykit-controls-list");this._dom={background:G,button:F};this._list.style.height="";var E=this._list.offsetHeight;E+=e;this._container.style.height=E+"px";this._list.style.height=E+"px"}},{key:"remove",value:function v(){if(!this._browserSupported()){return}this._dom.button.removeEventListener("mousedown",this._onButtonDown);this._dom.button.removeEventListener("touchstart",this._onButtonDown);this._dom.background.parentNode.removeChild(this._dom.background)}},{key:"_isScrollingNecessary",get:function p(){return this._list.scrollWidth>this._list.offsetWidth}}]);return o})();i["default"]=b;d.exports=i["default"]},function(c,i,b){Object.defineProperty(i,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function m(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var h=b(92);var l=n(h);var g=b(15);var o=n(g);var e=(function(p){m(t,p);function t(){j(this,t);k(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}f(t,[{key:"init",value:function A(){var B=function(H){var F='<div class="imglykit-controls-list-container"> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> ';for(var E in H.filters){F+=" ";var G=H.filters[E];F+=" ";var D=G.prototype.name;F+=" ";var C=H.activeFilter.identifier===E;F+=' <li data-identifier="'+(E)+'" class="imglykit-controls-item-with-label';if(C){F+=" imglykit-controls-item-active"}F+='"> <img src="'+(H.helpers.assetPath("ui/night/filters/"+E+".png"))+'" /> <div class="imglykit-controls-item-label">'+(D)+"</div> </li> "}F+=" </ul></div>";return F};this._controlsTemplate=B;this._availableFilters={};this._filters={};this._addDefaultFilters();this.selectFilters(null)}},{key:"_renderAllControls",value:function x(){this._operationExistedBefore=!!this._ui.operations.filters;this._operation=this._ui.getOrCreateOperation("filters");for(var B=arguments.length,C=Array(B),D=0;D<B;D++){C[D]=arguments[D]}k(Object.getPrototypeOf(t.prototype),"_renderAllControls",this).apply(this,C)}},{key:"_onEnter",value:function u(){var E=this;this._historyItem=null;this._initialFilter=this._operation.getFilter();this._defaultFilter=this._operation.availableOptions.filter["default"];var C=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(C);var D=function(F){var G=E._listItems[F];G.addEventListener("click",function(){E._onListItemClick(G)})};for(var B=0;B<this._listItems.length;B++){D(B)}}},{key:"_onBack",value:function y(){var B=this._operation.getFilter();if(B===this._defaultFilter){this._ui.removeOperation("filters")}this._ui.canvas.render()}},{key:"_onListItemClick",value:function v(D){this._deactivateAllItems();var C=D.getAttribute("data-identifier");this._operation.setFilter(this._filters[C]);this._ui.canvas.render();o["default"].classList(D).add("imglykit-controls-item-active");var B=this._operation.getFilter();if(B!==this._initialFilter&&!this._historyItem){this._historyItem=this._ui.addHistory(this._operation,{filter:this._initialFilter},this._operationExistedBefore)}}},{key:"_deactivateAllItems",value:function q(){for(var B=0;B<this._listItems.length;B++){var C=this._listItems[B];o["default"].classList(C).remove("imglykit-controls-item-active")}}},{key:"_addDefaultFilters",value:function z(){this.addFilter(b(42));this.addFilter(b(66));this.addFilter(b(67));this.addFilter(b(68));this.addFilter(b(69));this.addFilter(b(62));this.addFilter(b(55));this.addFilter(b(74));this.addFilter(b(59));this.addFilter(b(63));this.addFilter(b(60));this.addFilter(b(81));this.addFilter(b(56));this.addFilter(b(57));this.addFilter(b(70));this.addFilter(b(77));this.addFilter(b(76));this.addFilter(b(75));this.addFilter(b(61));this.addFilter(b(64));this.addFilter(b(58));this.addFilter(b(80));this.addFilter(b(73));this.addFilter(b(71));this.addFilter(b(65));this.addFilter(b(72));this.addFilter(b(79));this.addFilter(b(54));this.addFilter(b(78))}},{key:"addFilter",value:function w(B){this._availableFilters[B.identifier]=B}},{key:"selectFilters",value:function s(B){this._filters={};var F=Object.keys(this._availableFilters);var C=o["default"].select(F,B);for(var E=0;E<C.length;E++){var D=C[E];this._filters[D]=this._availableFilters[D]}if(this._active){this._renderControls()}}},{key:"context",get:function r(){return{filters:this._filters,activeFilter:this._operation.getFilter()}}}]);return t})(l["default"]);e.prototype.identifier="filters";i["default"]=e;c.exports=i["default"]},function(d,u,e){Object.defineProperty(u,"__esModule",{value:true});var o=(function(){function v(z,x){for(var w=0;w<x.length;w++){var y=x[w];y.enumerable=y.enumerable||false;y.configurable=true;if("value" in y){y.writable=true}Object.defineProperty(z,y.key,y)}}return function(y,w,x){if(w){v(y.prototype,w)}if(x){v(y,x)}return y}})();var b=function r(C,B,A){var y=true;_function:while(y){var w=C,E=B,v=A;x=D=z=undefined;y=false;if(w===null){w=Function.prototype}var x=Object.getOwnPropertyDescriptor(w,E);if(x===undefined){var D=Object.getPrototypeOf(w);if(D===null){return undefined}else{C=D;B=E;A=v;y=true;continue _function}}else{if("value" in x){return x.value}else{var z=x.get;if(z===undefined){return undefined}return z.call(v)}}}};function c(v){return v&&v.__esModule?v:{"default":v}}function g(v,w){if(!(v instanceof w)){throw new TypeError("Cannot call a class as a function")}}function l(w,v){if(typeof v!=="function"&&v!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof v)}w.prototype=Object.create(v&&v.prototype,{constructor:{value:w,enumerable:false,writable:true,configurable:true}});if(v){Object.setPrototypeOf?Object.setPrototypeOf(w,v):w.__proto__=v}}var i=e(84);var k=c(i);var p=e(2);var h=c(p);var s=e(15);var n=c(s);var q=e(90);var j=c(q);var f=e(24);var m=c(f);var t=(function(G){l(T,G);function T(V,W,U){g(this,T);b(Object.getPrototypeOf(T.prototype),"constructor",this).call(this);this._kit=V;this._ui=W;this._operation=U;this._helpers=new k["default"](this._kit,this._ui,this._ui.options);this._partialTemplates={doneButton:function(Y){var X='<div class="imglykit-controls-button imglykit-controls-done"> <img src="'+(Y.helpers.assetPath("ui/night/buttons/done.png"))+'" /> <div class="imglykit-controls-done-highlighted"> <img src="'+(Y.helpers.assetPath("ui/night/buttons/done-highlighted.png"))+'" /> </div></div>';return X}};this._template=function(Y){var X='<div class="imglykit-controls-'+(Y.identifier)+'"> <div class="imglykit-controls-button imglykit-controls-back"> <img src="'+(Y.helpers.assetPath("ui/night/buttons/back.png"))+'" /> </div> '+(Y.partials.control)+"</div>";return X};this._active=false;this._historyItem=null;this.init()}o(T,[{key:"setContainers",value:function S(V,U){this._controlsContainer=V;this._canvasControlsContainer=U}},{key:"init",value:function J(){}},{key:"update",value:function B(){this._renderAllControls();this._onEnter()}},{key:"_setInitialValues",value:function L(){}},{key:"_renderAllControls",value:function v(){this._renderControls();this._renderCanvasControls();this._initScrollbar();this._handleBackAndDoneButtons();this._enableCanvasControls()}},{key:"_renderControls",value:function E(){if(typeof this._controlsTemplate==="undefined"){throw new Error("Control#_renderOverviewControls: Control needs to define this._controlsTemplate.")}var U=this._template(this._context);if(typeof this._controls!=="undefined"&&this._controls.parentNode!==null){this._controls.parentNode.removeChild(this._controls)}this._controls=document.createElement("div");this._controls.innerHTML=U;this._controlsContainer.appendChild(this._controls)}},{key:"_renderCanvasControls",value:function y(){if(typeof this._canvasControlsTemplate==="undefined"){return}var U=this._canvasControlsTemplate(this._context);if(typeof this._canvasControls!=="undefined"&&this._canvasControls.parentNode!==null){this._canvasControls.parentNode.removeChild(this._canvasControls)}this._canvasControls=document.createElement("div");this._canvasControls.innerHTML=U;this._canvasControlsContainer.appendChild(this._canvasControls)}},{key:"_initScrollbar",value:function D(){var U=this._controls.querySelector(".imglykit-controls-list");if(U){this._scrollbar=new j["default"](U.parentNode)}}},{key:"_removeControls",value:function w(){this._controls.parentNode.removeChild(this._controls);if(this._canvasControls){this._canvasControls.parentNode.removeChild(this._canvasControls)}if(this._scrollbar){this._scrollbar.remove()}}},{key:"_handleBackAndDoneButtons",value:function C(){this._backButton=this._controls.querySelector(".imglykit-controls-back");if(this._backButton){this._backButton.addEventListener("click",this._onBackButtonClick.bind(this))}this._doneButton=this._controls.querySelector(".imglykit-controls-done");if(this._doneButton){this._doneButton.addEventListener("click",this._onDoneButtonClick.bind(this))}}},{key:"_onBackButtonClick",value:function H(){this._onBack();this.emit("back")}},{key:"_onDoneButtonClick",value:function P(){this._onDone();this.emit("back")}},{key:"_highlightDoneButton",value:function x(){if(!this._doneButton){return}n["default"].classList(this._doneButton).add("highlighted")}},{key:"enter",value:function N(){this._active=true;if(typeof this._canvasControlsTemplate!=="undefined"){this._ui.hideZoom()}this._renderAllControls();this._onEnter();this._setInitialValues()}},{key:"leave",value:function z(){this._active=false;this._ui.showZoom();this._removeControls();this._disableCanvasControls();this._onLeave()}},{key:"_enableCanvasControls",value:function M(){if(typeof this._canvasControlsTemplate==="undefined"){return}n["default"].classList(this._canvasControlsContainer).remove("imglykit-canvas-controls-disabled")}},{key:"_disableCanvasControls",value:function R(){if(typeof this._canvasControlsTemplate==="undefined"){return}n["default"].classList(this._canvasControlsContainer).add("imglykit-canvas-controls-disabled")}},{key:"_onEnter",value:function O(){}},{key:"_onLeave",value:function A(){}},{key:"_onBack",value:function K(){}},{key:"_onDone",value:function F(){}},{key:"onZoom",value:function I(){}},{key:"_context",get:function Q(){var V=this.context;V=n["default"].extend(V,{helpers:this._helpers,identifier:this.identifier});V.partials={};for(var U in this._partialTemplates){var X=this._partialTemplates[U];var W=n["default"].extend({},V,X.additionalContext||{});V.partials[U]=X(W)}V.partials.control=this._controlsTemplate(V);return V}},{key:"context",get:function Q(){return{}}}]);return T})(h["default"]);t.prototype.identifier=null;t.extend=m["default"];u["default"]=t;d.exports=u["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var j=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function i(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var f=b(92);var m=o(f);var g=b(4);var k=o(g);var l=(function(r){n(t,r);function t(){i(this,t);j(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}e(t,[{key:"init",value:function v(){var w=function(y){var x='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> <li data-degrees="-90"> <img src="'+(y.helpers.assetPath("ui/night/rotation/left.png"))+'" /> </li> <li data-degrees="90"> <img src="'+(y.helpers.assetPath("ui/night/rotation/right.png"))+'" /> </li> </ul></div>';return x};this._controlsTemplate=w}},{key:"_onEnter",value:function u(){var z=this;this._historyItem=null;this._operationExistedBefore=!!this._ui.operations.rotation;this._operation=this._ui.getOrCreateOperation("rotation");this._operation.dirty=true;this._cropOperation=this._ui.operations.crop;this._initialDegrees=this._operation.getDegrees();var x=this._controls.querySelectorAll("li");if(this._cropOperation){if(!this._initialStart&&!this._initialEnd){this._initialStart=this._cropOperation.getStart().clone();this._initialEnd=this._cropOperation.getEnd().clone()}}this._listItems=Array.prototype.slice.call(x);var y=function(A){var B=z._listItems[A];B.addEventListener("click",function(){z._onListItemClick(B)})};for(var w=0;w<this._listItems.length;w++){y(w)}}},{key:"_onListItemClick",value:function q(w){var y=w.getAttribute("data-degrees");y=parseInt(y,10);var x=this._operation.getDegrees();if(!this._historyItem){this._historyItem=this._ui.addHistory(this._operation,{degrees:this._initialDegrees},this._operationExistedBefore)}this._rotateCrop(y);this._operation.setDegrees(x+y);this._ui.canvas.zoomToFit()}},{key:"_rotateCrop",value:function p(y){if(!this._cropOperation){return}var z=this._cropOperation.getStart().clone();var w=this._cropOperation.getEnd().clone();var x=z.clone();switch(y){case 90:z=new k["default"](1-w.y,x.x);w=new k["default"](1-x.y,w.x);break;case -90:z=new k["default"](x.y,1-w.x);w=new k["default"](w.y,1-x.x);break}this._cropOperation.set({start:z,end:w})}},{key:"_onBack",value:function s(){var w=this._operation.getDegrees();if(w===0){this._ui.removeOperation("rotation")}}}]);return t})(m["default"]);l.prototype.identifier="rotation";h["default"]=l;c.exports=h["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var j=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function i(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function m(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var g=b(92);var l=n(g);var f=b(15);var o=n(f);var k=(function(r){m(t,r);function t(){i(this,t);j(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}e(t,[{key:"init",value:function v(){var w=function(y){var x='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> <li data-direction="horizontal"> <img src="'+(y.helpers.assetPath("ui/night/flip/horizontal.png"))+'" /> </li> <li data-direction="vertical"> <img src="'+(y.helpers.assetPath("ui/night/flip/vertical.png"))+'" /> </li> </ul></div>';return x};this._controlsTemplate=w}},{key:"_onEnter",value:function u(){var z=this;this._historyItem=null;this._operationExistedBefore=!!this._ui.operations.flip;this._operation=this._ui.getOrCreateOperation("flip");this._initialHorizontal=this._operation.getHorizontal();this._initialVertical=this._operation.getVertical();var x=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(x);var y=function(A){var B=z._listItems[A];B.addEventListener("click",function(){z._onListItemClick(B)});var C=B.getAttribute("data-direction");if(C==="horizontal"&&z._operation.getHorizontal()){z._toggleItem(B,true)}else{if(C==="vertical"&&z._operation.getVertical()){z._toggleItem(B,true)}}};for(var w=0;w<this._listItems.length;w++){y(w)}}},{key:"_onListItemClick",value:function q(x){var z=x.getAttribute("data-direction");var y=false;var w=this._operation.getHorizontal();var A=this._operation.getVertical();if(z==="horizontal"){this._operation.setHorizontal(!w);w=!w;this._ui.canvas.render();y=!w}else{if(z==="vertical"){this._operation.setVertical(!A);A=!A;this._ui.canvas.render();y=!A}}if((this._initialVertical!==A||this._initialHorizontal!==w)&&!this._historyItem){this._historyItem=this._ui.addHistory(this._operation,{vertical:this._initialVertical,horizontal:this._initialHorizontal},this._operationExistedBefore)}this._toggleItem(x,y)}},{key:"_toggleItem",value:function p(x,y){var w="imglykit-controls-item-active";if(y){o["default"].classList(x).add(w)}else{o["default"].classList(x).remove(w)}}},{key:"_onBack",value:function s(){var x=this._operation.getVertical();var w=this._operation.getHorizontal();if(!x&&!w){this._ui.removeOperation("flip")}this._ui.canvas.render()}}]);return t})(l["default"]);k.prototype.identifier="flip";h["default"]=k;c.exports=h["default"]},function(c,i,b){Object.defineProperty(i,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var l=function e(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function k(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var g=b(92);var m=o(g);var j=b(96);var h=o(j);var d=(function(q){n(u,q);function u(){k(this,u);l(Object.getPrototypeOf(u.prototype),"constructor",this).apply(this,arguments)}f(u,[{key:"init",value:function t(){var v=function(x){var w="<div> "+(x.partials.slider)+"</div>";return w};this._controlsTemplate=v;this._partialTemplates.slider=h["default"].template;this._onUpdate=this._onUpdate.bind(this)}},{key:"_onEnter",value:function s(){this._historyItem=null;this._operationExistedBefore=!!this._ui.operations.brightness;this._operation=this._ui.getOrCreateOperation("brightness");var v=this._operation.getBrightness();this._initialBrightness=v;var w=this._controls.querySelector(".imglykit-slider");this._slider=new h["default"](w,{minValue:-1,maxValue:1,defaultValue:v});this._slider.on("update",this._onUpdate);this._slider.setValue(v)}},{key:"_onBack",value:function r(){var v=this._operation.getBrightness();if(v===1){this._ui.removeOperation("brightness")}this._ui.canvas.render();this._slider=null}},{key:"_onUpdate",value:function p(v){this._operation.setBrightness(v);this._ui.canvas.render();if(!this._historyItem){this._historyItem=this._ui.addHistory(this._operation,{brightness:this._initialBrightness},this._operationExistedBefore)}}}]);return u})(m["default"]);d.prototype.identifier="brightness";i["default"]=d;c.exports=i["default"]},function(d,j,c){Object.defineProperty(j,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var l=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function k(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var b=c(2);var n=p(b);var g=c(15);var q=p(g);var i=c(4);var m=p(i);var h=(function(r){o(w,r);function w(E,D){k(this,w);l(Object.getPrototypeOf(w.prototype),"constructor",this).call(this);this._element=E;this._options=q["default"].defaults(D,{minValue:0,maxValue:1,defaultValue:0});this._value=this._options.defaultValue;this._sliderElement=this._element.querySelector(".imglykit-slider-slider");this._dotElement=this._element.querySelector(".imglykit-slider-dot");this._centerDotElement=this._element.querySelector(".imglykit-slider-center-dot");this._fillElement=this._element.querySelector(".imglykit-slider-fill");this._backgroundElement=this._element.querySelector(".imglykit-slider-background");this._onMouseDown=this._onMouseDown.bind(this);this._onMouseMove=this._onMouseMove.bind(this);this._onMouseUp=this._onMouseUp.bind(this);this._onCenterDotClick=this._onCenterDotClick.bind(this);this._onBackgroundClick=this._onBackgroundClick.bind(this);this._backgroundElement.addEventListener("click",this._onBackgroundClick);this._fillElement.addEventListener("click",this._onBackgroundClick);this._handleDot()}f(w,[{key:"setValue",value:function u(H){this._value=H;var D=this._options;var J=D.maxValue;var G=D.minValue;var I=J-G;var E=(H-G)/I;var F=this._sliderElement.offsetWidth;this._setX(F*E)}},{key:"_setX",value:function y(D){this._xPosition=D;this._dotElement.style.left=D+"px";var E=this._sliderElement.offsetWidth/2;var F=D-E;this._fillElement.style.width=Math.abs(F)+"px";if(F<0){this._fillElement.style.left=E-Math.abs(F)+"px"}else{this._fillElement.style.left=E+"px"}}},{key:"_handleDot",value:function v(){this._dotElement.addEventListener("mousedown",this._onMouseDown);this._dotElement.addEventListener("touchstart",this._onMouseDown);if(this._centerDotElement){this._centerDotElement.addEventListener("click",this._onCenterDotClick)}}},{key:"_onCenterDotClick",value:function z(){this.setValue(this._options.defaultValue);this.emit("update",this._value)}},{key:"_onBackgroundClick",value:function C(G){var D=q["default"].getEventPosition(G);var F=this._sliderElement.getBoundingClientRect();F=new m["default"](F.left,F.y);var E=D.clone().subtract(F);this._setX(E.x);this._updateValue()}},{key:"_onMouseDown",value:function A(F){if(F.type==="mousedown"&&F.button!==0){return}F.preventDefault();var G=q["default"].getEventPosition(F);document.addEventListener("mousemove",this._onMouseMove);document.addEventListener("touchmove",this._onMouseMove);document.addEventListener("mouseup",this._onMouseUp);document.addEventListener("touchend",this._onMouseUp);var E=this._dotElement.getBoundingClientRect();var D=this._sliderElement.getBoundingClientRect();this._initialSliderX=E.left-D.left;this._initialMousePosition=G}},{key:"_onMouseMove",value:function s(G){G.preventDefault();var I=q["default"].getEventPosition(G);var H=I.subtract(this._initialMousePosition);var F=this._dotElement.offsetWidth*0.5;var D=this._initialSliderX+H.x+F;var E=this._sliderElement.offsetWidth;D=Math.max(0,Math.min(D,E));this._setX(D);this._updateValue()}},{key:"_updateValue",value:function B(){var F=this._sliderElement.offsetWidth;var E=this._options;var H=E.minValue;var I=E.maxValue;var D=this._xPosition/F;var G=H+(I-H)*D;this.emit("update",G)}},{key:"_onMouseUp",value:function x(){document.removeEventListener("mousemove",this._onMouseMove);document.removeEventListener("touchmove",this._onMouseMove);document.removeEventListener("mouseup",this._onMouseUp);document.removeEventListener("touchend",this._onMouseUp)}}],[{key:"template",get:function t(){return function(E){var D='<div class="imglykit-slider" id="'+((typeof E.id==="undefined"?"":E.id))+'"> <div class="imglykit-slider-minus"> <img src="'+(E.helpers.assetPath("ui/night/slider/minus.png"))+'" /> </div> <div class="imglykit-slider-slider"> <div class="imglykit-slider-content"> <div class="imglykit-slider-background"></div> <div class="imglykit-slider-fill"></div> <div class="imglykit-slider-center-dot"></div> <div class="imglykit-slider-dot"></div> </div> </div> <div class="imglykit-slider-plus"> <img src="'+(E.helpers.assetPath("ui/night/slider/plus.png"))+'" /> </div></div>';return D}}}]);return w})(n["default"]);j["default"]=h;d.exports=j["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var l=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function k(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var f=b(92);var m=o(f);var j=b(96);var g=o(j);var i=(function(r){n(p,r);function p(){k(this,p);l(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,arguments)}e(p,[{key:"init",value:function u(){var v=function(x){var w="<div> "+(x.partials.slider)+"</div>";return w};this._controlsTemplate=v;this._partialTemplates.slider=g["default"].template}},{key:"_onEnter",value:function t(){this._historyItem=null;this._operationExistedBefore=!!this._ui.operations.contrast;this._operation=this._ui.getOrCreateOperation("contrast");var v=this._operation.getContrast();this._initialContrast=v;var w=this._controls.querySelector(".imglykit-slider");this._slider=new g["default"](w,{minValue:0,maxValue:2,defaultValue:v});this._slider.on("update",this._onUpdate.bind(this));this._slider.setValue(this._initialContrast)}},{key:"_onBack",value:function s(){var v=this._operation.getContrast();if(v===1){this._ui.removeOperation("contrast")}this._ui.canvas.render()}},{key:"_onUpdate",value:function q(w){this._operation.setContrast(w);this._ui.canvas.render();var v=this._operation.getContrast();if(this._initialContrast!==v&&!this._historyItem){this._historyItem=this._ui.addHistory(this._operation,{contrast:this._initialContrast},this._operationExistedBefore)}}}]);return p})(m["default"]);i.prototype.identifier="contrast";h["default"]=i;c.exports=h["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;if(q===null){q=Function.prototype}var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){Object.setPrototypeOf?Object.setPrototypeOf(q,p):q.__proto__=p}}var i=b(96);var g=o(i);var f=b(92);var l=o(f);var m=(function(q){n(s,q);function s(){j(this,s);k(Object.getPrototypeOf(s.prototype),"constructor",this).apply(this,arguments)}e(s,[{key:"init",value:function u(){var v=function(x){var w="<div> "+(x.partials.slider)+"</div>";return w};this._controlsTemplate=v;this._partialTemplates.slider=g["default"].template}},{key:"_onEnter",value:function t(){this._historyItem=null;this._operationExistedBefore=!!this._ui.operations.saturation;this._operation=this._ui.getOrCreateOperation("saturation");var v=this._operation.getSaturation();this._initialSaturation=v;var w=this._controls.querySelector(".imglykit-slider");this._slider=new g["default"](w,{minValue:0,maxValue:2,defaultValue:v});this._slider.on("update",this._onUpdate.bind(this));this._slider.setValue(this._initialSaturation)}},{key:"_onBack",value:function r(){var v=this._operation.getSaturation();if(v===1){this._ui.removeOperation("saturation")}this._ui.canvas.render()}},{key:"_onUpdate",value:function p(v){this._operation.setSaturation(v);this._ui.canvas.render();var w=this._operation.getSaturation();if(this._initialSaturation!==w&&!this._historyItem){this._historyItem=this._ui.addHistory(this._operation,{saturation:this._initialSaturation},this._operationExistedBefore)}}}]);return s})(l["default"]);m.prototype.identifier="saturation";h["default"]=m;c.exports=h["default"]},function(c,j,b){Object.defineProperty(j,"__esModule",{value:true});var e=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var l=function d(y,x,u){var v=true;_function:while(v){var s=y,A=x,r=u;t=z=w=undefined;v=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;u=r;v=true;continue _function}}else{if("value" in t){return t.value}else{var w=t.get;if(w===undefined){return undefined}return w.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function k(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var h=b(92);var n=p(h);var i=b(4);var m=p(i);var g=b(15);var q=p(g);var f=(function(y){o(A,y);function A(){k(this,A);l(Object.getPrototypeOf(A.prototype),"constructor",this).apply(this,arguments)}e(A,[{key:"init",value:function D(){this._availableRatios={};this._ratios={};var P=function(V){var T='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> ';for(var S in V.ratios){T+=" ";var U=V.ratios[S];T+=" ";var R=U.selected;T+=' <li data-identifier="'+(S)+'" data-ratio="'+(U.ratio)+'"';if(R){T+=" data-selected"}T+='> <img src="'+(V.helpers.assetPath("ui/night/crop/"+S+".png"))+'" /> </li> '}T+=" </ul></div>"+(V.partials.doneButton);return T};this._controlsTemplate=P;var Q=function(S){var R='<div class="imglykit-canvas-crop-container"> <div class="imglykit-canvas-crop-top"> <div class="imglykit-canvas-crop-top-left"></div> <div class="imglykit-canvas-crop-top-center"></div> <div class="imglykit-canvas-crop-top-right"></div> </div> <div class="imglykit-canvas-crop-center"> <div class="imglykit-canvas-crop-center-left"></div> <div class="imglykit-canvas-crop-center-center"> <div class="imglykit-canvas-crop-knobs"> <div data-corner="top-left"></div> <div data-corner="top-right"></div> <div data-corner="bottom-left"></div> <div data-corner="bottom-right"></div> </div> </div> <div class="imglykit-canvas-crop-center-right"></div> </div> <div class="imglykit-canvas-crop-bottom"> <div class="imglykit-canvas-crop-bottom-left"></div> <div class="imglykit-canvas-crop-bottom-center"></div> <div class="imglykit-canvas-crop-bottom-right"></div> </div></div>';return R};this._canvasControlsTemplate=Q;this._onKnobDown=this._onKnobDown.bind(this);this._onKnobDrag=this._onKnobDrag.bind(this);this._onKnobUp=this._onKnobUp.bind(this);this._onCenterDown=this._onCenterDown.bind(this);this._onCenterDrag=this._onCenterDrag.bind(this);this._onCenterUp=this._onCenterUp.bind(this);this._addDefaultRatios();this.selectRatios(null)}},{key:"selectRatios",value:function L(P){this._ratios={};var Q=Object.keys(this._availableRatios);var T=q["default"].select(Q,P);for(var S=0;S<T.length;S++){var R=T[S];this._ratios[R]=this._availableRatios[R]}if(this._active){this._renderControls()}}},{key:"_addDefaultRatios",value:function s(){this.addRatio("custom","*",true);this.addRatio("square","1");this.addRatio("4-3","1.33");this.addRatio("16-9","1.77")}},{key:"addRatio",value:function w(P,R,Q){this._availableRatios[P]={ratio:R,selected:Q}}},{key:"_onEnter",value:function I(){var S=this;l(Object.getPrototypeOf(A.prototype),"_onEnter",this).call(this);this._operationExistedBefore=!!this._ui.operations.crop;this._operation=this._ui.getOrCreateOperation("crop");this._defaultStart=new m["default"](0.1,0.1);this._defaultEnd=new m["default"](0.9,0.9);this._initialStart=this._operation.getStart().clone();this._initialEnd=this._operation.getEnd().clone();this._start=this._initialStart||this._defaultStart;this._end=this._initialEnd||this._defaultEnd;this._minimumSize=new m["default"](50,50);this._initialZoomLevel=this._ui.canvas.zoomLevel;this._ui.canvas.zoomToFit(false);var R=".imglykit-canvas-crop";var P=this._canvasControls;var Q=P.querySelector(R+"-knobs");this._operation.set({start:new m["default"](0,0),end:new m["default"](1,1)});this._knobs={topLeft:Q.querySelector("[data-corner=top-left]"),topRight:Q.querySelector("[data-corner=top-right]"),bottomLeft:Q.querySelector("[data-corner=bottom-left]"),bottomRight:Q.querySelector("[data-corner=bottom-right]")};this._areas={topLeft:this._canvasControls.querySelector(R+"-top-left"),topCenter:this._canvasControls.querySelector(R+"-top-center"),centerLeft:this._canvasControls.querySelector(R+"-center-left"),centerCenter:this._canvasControls.querySelector(R+"-center-center")};this._knobsContainer=this._canvasControls.querySelector(".imglykit-canvas-crop-knobs");this._handleControls();this._handleKnobs();this._handleKnobsContainer();this._ui.canvas.zoomToFit().then(function(){S._updateDOM()})}},{key:"_handleControls",value:function z(){var Q=this;var R=this._controls.querySelectorAll("ul > li");this._ratioItems=Array.prototype.slice.call(R);var S=function(U){var X=Q._ratioItems[U];var W=X.getAttribute("data-selected");var V=X.getAttribute("data-ratio");var T=X.getAttribute("data-identifier");if(typeof W!=="undefined"&&W!==null&&!Q._operationExistedBefore){Q._setRatio(T,V,false);Q._selectRatio(X)}X.addEventListener("click",function(Y){Y.preventDefault();Q._onRatioClick(X)})};for(var P=0;P<this._ratioItems.length;P++){S(P)}}},{key:"_onRatioClick",value:function M(P){this._unselectAllRatios();this._selectRatio(P)}},{key:"_unselectAllRatios",value:function J(){for(var P=0;P<this._ratioItems.length;P++){var Q=this._ratioItems[P];q["default"].classList(Q).remove("imglykit-controls-item-active")}}},{key:"_selectRatio",value:function r(R){q["default"].classList(R).add("imglykit-controls-item-active");var Q=R.getAttribute("data-ratio");var P=R.getAttribute("data-identifier");this._setRatio(P,Q)}},{key:"_setRatio",value:function O(S,U){var R=arguments.length<=2||arguments[2]===undefined?true:arguments[2];var Q=this._ui.canvas.size;this._selectedRatio=S;if(U==="*"){this._ratio=null;this._start=new m["default"](0.1,0.1);this._end=new m["default"](0.9,0.9)}else{if(U==="original"){this._ratio=Q.x/Q.y}else{U=parseFloat(U);this._ratio=U}if(R){if(Q.x/Q.y<=this._ratio){this._start.x=0.1;this._end.x=0.9;var P=1/Q.y*(Q.x/this._ratio*0.8);this._start.y=(1-P)/2;this._end.y=1-this._start.y}else{this._start.y=0.1;this._end.y=0.9;var T=1/Q.x*(this._ratio*Q.y*0.8);this._start.x=(1-T)/2;this._end.x=1-this._start.x}}}this._updateDOM()}},{key:"_updateDOM",value:function N(){var Q=this._ui.canvas.size;var S=this._start.clone().multiply(Q);var U=this._end.clone().multiply(Q);var R=U.clone().subtract(S);var W=Math.max(1,S.y);var V=Math.max(1,S.x);var T=Math.max(1,R.x);var P=Math.max(1,R.y);this._areas.topLeft.style.width=V+"px";this._areas.topCenter.style.width=T+"px";this._areas.topLeft.style.height=W+"px";this._areas.centerLeft.style.height=P+"px";this._knobsContainer.style.height=P+"px"}},{key:"_handleKnobs",value:function v(){var Q=this;var R=function(T){var S=Q._knobs[T];S.addEventListener("mousedown",function(U){Q._onKnobDown(U,S)});S.addEventListener("touchstart",function(U){Q._onKnobDown(U,S)})};for(var P in this._knobs){R(P)}}},{key:"_onKnobDown",value:function H(Q,P){Q.preventDefault();Q.stopPropagation();this._currentKnob=P;this._initialMousePosition=q["default"].getEventPosition(Q);this._startBeforeDrag=this._start.clone();this._endBeforeDrag=this._end.clone();document.addEventListener("mousemove",this._onKnobDrag);document.addEventListener("touchmove",this._onKnobDrag);document.addEventListener("mouseup",this._onKnobUp);document.addEventListener("touchend",this._onKnobUp)}},{key:"_onKnobDrag",value:function u(T){T.preventDefault();var Y=q["default"].getEventPosition(T);var S=Y.subtract(this._initialMousePosition);var W=this._currentKnob.getAttribute("data-corner");var Z=this._ui.canvas.size;var V=this._startBeforeDrag.clone().multiply(Z);var Q=this._endBeforeDrag.clone().multiply(Z);var P=undefined,X=undefined,R=undefined,U=undefined;switch(W){case"top-left":V.add(S);R=Q.clone().subtract(this._minimumSize);V.clamp(null,R);break;case"top-right":Q.x+=S.x;V.y+=S.y;Q.x=Math.max(V.x+this._minimumSize.x,Q.x);V.y=Math.min(Q.y-this._minimumSize.y,V.y);break;case"bottom-right":Q.add(S);U=V.clone().add(this._minimumSize);Q.clamp(U);break;case"bottom-left":V.x+=S.x;Q.y+=S.y;V.x=Math.min(Q.x-this._minimumSize.x,V.x);Q.y=Math.max(V.y+this._minimumSize.y,Q.y);break}this._start.copy(V).divide(Z);this._end.copy(Q).divide(Z);this._start.clamp(0,1);this._end.clamp(0,1);if(this._ratio!==null){switch(W){case"top-left":P=(this._end.x-this._start.x)*Z.x;X=P/this._ratio;this._start.y=this._end.y-X/Z.y;if(this._start.y<=0){this._start.y=0;X=(this._end.y-this._start.y)*Z.y;P=X*this._ratio;this._start.x=this._end.x-P/Z.x}break;case"top-right":P=(this._end.x-this._start.x)*Z.x;X=P/this._ratio;this._start.y=this._end.y-X/Z.y;if(this._start.y<=0){this._start.y=0;X=(this._end.y-this._start.y)*Z.y;P=X*this._ratio;this._end.x=this._start.x+P/Z.x}break;case"bottom-right":P=(this._end.x-this._start.x)*Z.x;X=P/this._ratio;this._end.y=this._start.y+X/Z.y;if(this._end.y>=1){this._end.y=1;X=(this._end.y-this._start.y)*Z.y;P=X*this._ratio;this._end.x=this._start.x+P/Z.x}break;case"bottom-left":P=(this._end.x-this._start.x)*Z.x;X=P/this._ratio;this._end.y=this._start.y+X/Z.y;if(this._end.y>=1){this._end.y=1;X=(this._end.y-this._start.y)*Z.y;P=X*this._ratio;this._start.x=this._end.x-P/Z.x}break}}this._updateDOM()}},{key:"_onKnobUp",value:function C(){this._currentKnob=null;document.removeEventListener("mousemove",this._onKnobDrag);document.removeEventListener("touchmove",this._onKnobDrag);document.removeEventListener("mouseup",this._onKnobUp);document.removeEventListener("touchend",this._onKnobUp)}},{key:"_handleKnobsContainer",value:function G(){this._knobsContainer.addEventListener("mousedown",this._onCenterDown);this._knobsContainer.addEventListener("touchstart",this._onCenterDown)}},{key:"_onCenterDown",value:function F(P){this._initialMousePosition=q["default"].getEventPosition(P);this._startBeforeDrag=this._start.clone();this._endBeforeDrag=this._end.clone();document.addEventListener("mousemove",this._onCenterDrag);document.addEventListener("touchmove",this._onCenterDrag);document.addEventListener("mouseup",this._onCenterUp);document.addEventListener("touchend",this._onCenterUp)}},{key:"_onCenterDrag",value:function t(S){var W=q["default"].getEventPosition(S);var Q=W.subtract(this._initialMousePosition);var X=this._ui.canvas.size;var T=this._endBeforeDrag.clone().subtract(this._startBeforeDrag);var R=T.clone().multiply(X);var U=this._startBeforeDrag.clone().multiply(X);var P=this._endBeforeDrag.clone().multiply(X);U.add(Q);var V=X.clone().subtract(R);U.clamp(new m["default"](0,0),V);P.copy(U).add(R);this._start.copy(U).divide(X);this._end.copy(P).divide(X);this._updateDOM()}},{key:"_onCenterUp",value:function x(){document.removeEventListener("mousemove",this._onCenterDrag);document.removeEventListener("touchmove",this._onCenterDrag);document.removeEventListener("mouseup",this._onCenterUp);document.removeEventListener("touchend",this._onCenterUp)}},{key:"_onBack",value:function E(){this._ui.canvas.setZoomLevel(this._initialZoomLevel,false);if(this._operationExistedBefore){this._operation.set({start:this._initialStart,end:this._initialEnd})}else{this._ui.removeOperation("crop")}this._ui.canvas.render()}},{key:"_onDone",value:function B(){this._operation.set({start:this._start,end:this._end});this._ui.canvas.zoomToFit(true);this._ui.addHistory(this._operation,{start:this._initialStart.clone(),end:this._initialEnd.clone()},this._operationExistedBefore)}},{key:"context",get:function K(){var P=l(Object.getPrototypeOf(A.prototype),"context",this);P.ratios=this._ratios;return P}},{key:"selectedRatio",get:function K(){return this._selectedRatio}}]);return A})(n["default"]);f.prototype.identifier="crop";j["default"]=f;c.exports=j["default"]},function(d,s,g){Object.defineProperty(s,"__esModule",{value:true});var o=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var b=function q(A,z,y){var w=true;_function:while(w){var u=A,C=z,t=y;v=B=x=undefined;w=false;if(u===null){u=Function.prototype}var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;y=t;w=true;continue _function}}else{if("value" in v){return v.value}else{var x=v.get;if(x===undefined){return undefined}return x.call(t)}}}};function c(t){return t&&t.__esModule?t:{"default":t}}function i(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function m(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){Object.setPrototypeOf?Object.setPrototypeOf(u,t):u.__proto__=t}}var p=g(92);var f=c(p);var l=g(4);var e=c(l);var r=g(15);var n=c(r);var k=g(101);var j=c(k);var h=(function(t){m(G,t);function G(){i(this,G);b(Object.getPrototypeOf(G.prototype),"constructor",this).apply(this,arguments)}o(G,[{key:"init",value:function I(){var J=function(M){var L='<div class="imglykit-controls-icon"> <img src="'+(M.helpers.assetPath("ui/night/blur/blur.png"))+'" /></div><div> '+(M.partials.slider)+"</div>"+(M.partials.doneButton);return L};this._controlsTemplate=J;var K=function(M){var L='<div class="imglykit-canvas-radial-blur-container"> <div class="imglykit-canvas-radial-blur-dot" id="imglykit-radial-blur-position"></div> <div class="imglykit-canvas-radial-blur-dot" id="imglykit-radial-blur-gradient"></div> <div class="imglykit-canvas-radial-blur-circle-container"> <div class="imglykit-canvas-radial-blur-circle"></div> </div></div>';return L};this._canvasControlsTemplate=K;this._partialTemplates.slider=j["default"].template;this._partialTemplates.slider.additionalContext={id:"imglykit-blur-radius-slider"}}},{key:"_onEnter",value:function z(){var J=this;this._operationExistedBefore=!!this._ui.operations["radial-blur"];this._operation=this._ui.getOrCreateOperation("radial-blur");this._initialSettings={position:this._operation.getPosition().clone(),gradientRadius:this._operation.getGradientRadius(),blurRadius:this._operation.getBlurRadius()};this._onPositionKnobDown=this._onPositionKnobDown.bind(this);this._onPositionKnobDrag=this._onPositionKnobDrag.bind(this);this._onPositionKnobUp=this._onPositionKnobUp.bind(this);this._onGradientKnobDown=this._onGradientKnobDown.bind(this);this._onGradientKnobDrag=this._onGradientKnobDrag.bind(this);this._onGradientKnobUp=this._onGradientKnobUp.bind(this);this._positionKnob=this._canvasControls.querySelector("#imglykit-radial-blur-position");this._gradientKnob=this._canvasControls.querySelector("#imglykit-radial-blur-gradient");this._circle=this._canvasControls.querySelector(".imglykit-canvas-radial-blur-circle");this._handleKnobs();this._initSliders();this._ui.canvas.render().then(function(){J._updateDOM()})}},{key:"_initSliders",value:function D(){var J=this._controls.querySelector("#imglykit-blur-radius-slider");this._blurRadiusSlider=new j["default"](J,{minValue:0,maxValue:40});this._blurRadiusSlider.on("update",this._onBlurRadiusUpdate.bind(this));this._blurRadiusSlider.setValue(this._initialSettings.blurRadius)}},{key:"_onBlurRadiusUpdate",value:function x(J){this._operation.setBlurRadius(J);this._ui.canvas.render();this._highlightDoneButton()}},{key:"_handleKnobs",value:function F(){var K=this._ui.canvas.size;var J=this._operation.getPosition().clone().multiply(K);this._gradientKnobPosition=J.clone().add(this._initialSettings.gradientRadius,0);this._positionKnob.addEventListener("mousedown",this._onPositionKnobDown);this._positionKnob.addEventListener("touchstart",this._onPositionKnobDown);this._gradientKnob.addEventListener("mousedown",this._onGradientKnobDown);this._gradientKnob.addEventListener("touchstart",this._onGradientKnobDown)}},{key:"_onPositionKnobDown",value:function A(K){K.preventDefault();var J=this._ui.canvas.size;this._initialMousePosition=n["default"].getEventPosition(K);this._initialPosition=this._operation.getPosition().clone();this._gradientKnobDistance=this._gradientKnobPosition.clone().subtract(this._initialPosition.clone().multiply(J));document.addEventListener("mousemove",this._onPositionKnobDrag);document.addEventListener("touchmove",this._onPositionKnobDrag);document.addEventListener("mouseup",this._onPositionKnobUp);document.addEventListener("touchend",this._onPositionKnobUp)}},{key:"_onPositionKnobDrag",value:function w(M){M.preventDefault();var J=this._ui.canvas.size;var O=n["default"].getEventPosition(M);var L=O.subtract(this._initialMousePosition);var K=this._initialPosition.clone().multiply(J).add(L);var N=J.clone().subtract(this._gradientKnobDistance);K.clamp(new e["default"](0,0),N);this._gradientKnobPosition.copy(K).add(this._gradientKnobDistance);K.divide(J);this._operation.setPosition(K);this._updateDOM();this._ui.canvas.render()}},{key:"_onPositionKnobUp",value:function C(J){J.preventDefault();document.removeEventListener("mousemove",this._onPositionKnobDrag);document.removeEventListener("touchmove",this._onPositionKnobDrag);document.removeEventListener("mouseup",this._onPositionKnobUp);document.removeEventListener("touchend",this._onPositionKnobUp)}},{key:"_onGradientKnobDown",value:function y(J){J.preventDefault();this._initialMousePosition=n["default"].getEventPosition(J);this._initialGradientKnobPosition=this._gradientKnobPosition.clone();document.addEventListener("mousemove",this._onGradientKnobDrag);document.addEventListener("touchmove",this._onGradientKnobDrag);document.addEventListener("mouseup",this._onGradientKnobUp);document.addEventListener("touchend",this._onGradientKnobUp)}},{key:"_onGradientKnobDrag",value:function H(N){N.preventDefault();var K=this._ui.canvas.size;var P=n["default"].getEventPosition(N);var M=P.subtract(this._initialMousePosition);this._gradientKnobPosition=this._initialGradientKnobPosition.clone().add(M);this._gradientKnobPosition.clamp(new e["default"](0,0),K);var J=this._operation.getPosition().clone().multiply(K);var O=this._gradientKnobPosition.clone().subtract(J);var L=Math.sqrt(Math.pow(O.x,2)+Math.pow(O.y,2));this._operation.setGradientRadius(L);this._updateDOM();this._ui.canvas.render()}},{key:"_onGradientKnobUp",value:function v(J){J.preventDefault();document.removeEventListener("mousemove",this._onGradientKnobDrag);document.removeEventListener("touchmove",this._onGradientKnobDrag);document.removeEventListener("mouseup",this._onGradientKnobUp);document.removeEventListener("touchend",this._onGradientKnobUp)}},{key:"_updateDOM",value:function u(){var K=this._ui.canvas.size;var J=this._operation.getPosition().clone().multiply(K);this._positionKnob.style.left=J.x+"px";this._positionKnob.style.top=J.y+"px";this._gradientKnob.style.left=this._gradientKnobPosition.x+"px";this._gradientKnob.style.top=this._gradientKnobPosition.y+"px";var L=this._operation.getGradientRadius()*2;this._circle.style.left=J.x+"px";this._circle.style.top=J.y+"px";this._circle.style.width=L+"px";this._circle.style.height=L+"px";this._circle.style.marginLeft="-"+L/2+"px";this._circle.style.marginTop="-"+L/2+"px"}},{key:"_onBack",value:function E(){if(this._operationExistedBefore){this._operation.set(this._initialSettings)}else{this._ui.removeOperation("radial-blur")}this._ui.canvas.render()}},{key:"_onDone",value:function B(){this._ui.addHistory(this._operation,{position:this._initialSettings.position.clone(),gradientRadius:this._initialSettings.gradientRadius,blurRadius:this._initialSettings.blurRadius},this._operationExistedBefore)}}]);return G})(f["default"]);h.prototype.identifier="radial-blur";s["default"]=h;d.exports=s["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;if(o===null){o=Function.prototype}var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n}}var j=b(96);var i=m(j);var l=(function(q){k(o,q);function o(){g(this,o);h(Object.getPrototypeOf(o.prototype),"constructor",this).apply(this,arguments)}e(o,[{key:"_setX",value:function p(r){this._xPosition=r;this._dotElement.style.left=r+"px";this._fillElement.style.width=r+"px"}}],[{key:"template",get:function n(){return function(s){var r='<div class="imglykit-slider" id="'+((typeof s.id==="undefined"?"":s.id))+'"> <div class="imglykit-slider-minus"> <img src="'+(s.helpers.assetPath("ui/night/slider/minus.png"))+'" /> </div> <div class="imglykit-slider-slider"> <div class="imglykit-slider-content"> <div class="imglykit-slider-background"></div> <div class="imglykit-slider-fill"></div> <div class="imglykit-slider-dot"></div> </div> </div> <div class="imglykit-slider-plus"> <img src="'+(s.helpers.assetPath("ui/night/slider/plus.png"))+'" /> </div></div>';return r}}}]);return o})(i["default"]);f["default"]=l;c.exports=f["default"]},function(d,s,g){Object.defineProperty(s,"__esModule",{value:true});var n=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var b=function q(A,z,y){var w=true;_function:while(w){var u=A,C=z,t=y;v=B=x=undefined;w=false;if(u===null){u=Function.prototype}var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;y=t;w=true;continue _function}}else{if("value" in v){return v.value}else{var x=v.get;if(x===undefined){return undefined}return x.call(t)}}}};function c(t){return t&&t.__esModule?t:{"default":t}}function h(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function l(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){Object.setPrototypeOf?Object.setPrototypeOf(u,t):u.__proto__=t}}var p=g(92);var f=c(p);var k=g(4);var e=c(k);var r=g(15);var m=c(r);var j=g(101);var i=c(j);var o=(function(t){l(y,t);function y(){h(this,y);b(Object.getPrototypeOf(y.prototype),"constructor",this).apply(this,arguments)}n(y,[{key:"init",value:function J(){var K=function(O){var N='<div class="imglykit-controls-icon"> <img src="'+(O.helpers.assetPath("ui/night/blur/blur.png"))+'" /></div><div> ';var M="imglykit-blur-radius-slider";N+=" "+(O.partials.slider)+"</div>"+(O.partials.doneButton);return N};this._controlsTemplate=K;var L=function(N){var M='<div class="imglykit-canvas-tilt-shift-container"> <div class="imglykit-canvas-tilt-shift-dot" data-option="position"></div> <div class="imglykit-canvas-tilt-shift-dot" data-option="gradient"></div> <div class="imglykit-canvas-tilt-shift-rect-container"> <div class="imglykit-canvas-tilt-shift-rect"></div> </div></div>';return M};this._canvasControlsTemplate=L;this._partialTemplates.slider=i["default"].template;this._partialTemplates.slider.additionalContext={id:"imglykit-blur-radius-slider"};this._currentKnob=null}},{key:"_onEnter",value:function A(){var L=this;this._operationExistedBefore=!!this._ui.operations["tilt-shift"];this._operation=this._ui.getOrCreateOperation("tilt-shift");this._initialSettings={start:this._operation.getStart().clone(),end:this._operation.getEnd().clone(),gradientRadius:this._operation.getGradientRadius(),blurRadius:this._operation.getBlurRadius()};this._onPositionKnobDown=this._onPositionKnobDown.bind(this);this._onPositionKnobDrag=this._onPositionKnobDrag.bind(this);this._onPositionKnobUp=this._onPositionKnobUp.bind(this);this._onGradientKnobDown=this._onGradientKnobDown.bind(this);this._onGradientKnobDrag=this._onGradientKnobDrag.bind(this);this._onGradientKnobUp=this._onGradientKnobUp.bind(this);var K=".imglykit-canvas-tilt-shift-dot";this._positionKnob=this._canvasControls.querySelector(K+"[data-option='position']");this._gradientKnob=this._canvasControls.querySelector(K+"[data-option='gradient']");this._rect=this._canvasControls.querySelector(".imglykit-canvas-tilt-shift-rect");this._initSliders();this._ui.canvas.render().then(function(){L._handleKnobs();L._updateDOM()})}},{key:"_initSliders",value:function F(){var K=this._controls.querySelector("#imglykit-blur-radius-slider");this._blurRadiusSlider=new i["default"](K,{minValue:0,maxValue:40});this._blurRadiusSlider.on("update",this._onBlurRadiusUpdate.bind(this));this._blurRadiusSlider.setValue(this._initialSettings.blurRadius)}},{key:"_onBlurRadiusUpdate",value:function x(K){this._operation.setBlurRadius(K);this._ui.canvas.render();this._highlightDoneButton()}},{key:"_handleKnobs",value:function H(){this._positionKnob.addEventListener("mousedown",this._onPositionKnobDown);this._positionKnob.addEventListener("touchstart",this._onPositionKnobDown);this._gradientKnob.addEventListener("mousedown",this._onGradientKnobDown);this._gradientKnob.addEventListener("touchstart",this._onGradientKnobDown);var R=this._ui.canvas.size;var O=this._initialSettings;var K=O.start;var M=O.end;K=K.clone().multiply(R);M=M.clone().multiply(R);var P=M.clone().subtract(K);var S=K.clone().add(P.clone().divide(2));var N=Math.sqrt(Math.pow(P.x,2)+Math.pow(P.y,2));var Q=P.clone().divide(N).divide(2);this._knobPosition=S.clone();var L=this._initialSettings.gradientRadius;this._gradientKnobPosition=S.clone().add(-L*Q.y,L*Q.x);this._updateStartAndEnd();this._updateDOM();this._ui.canvas.render()}},{key:"_updateStartAndEnd",value:function B(){var K=this._ui.canvas.size;var M=this._gradientKnobPosition.clone().subtract(this._knobPosition);var N=this._knobPosition.clone().add(-M.y,M.x).divide(K);var L=this._knobPosition.clone().add(M.y,-M.x).divide(K);this._operation.set({start:N,end:L})}},{key:"_onPositionKnobDown",value:function C(K){K.preventDefault();this._initialMousePosition=m["default"].getEventPosition(K);this._initialPosition=this._knobPosition.clone();this._initialDistanceToGradientKnob=this._gradientKnobPosition.clone().subtract(this._initialPosition);document.addEventListener("mousemove",this._onPositionKnobDrag);document.addEventListener("touchmove",this._onPositionKnobDrag);document.addEventListener("mouseup",this._onPositionKnobUp);document.addEventListener("touchend",this._onPositionKnobUp)}},{key:"_onPositionKnobDrag",value:function w(N){N.preventDefault();var K=this._ui.canvas.size;var Q=m["default"].getEventPosition(N);var M=Q.subtract(this._initialMousePosition);var L=this._initialPosition.clone().add(M);this._knobPosition.copy(L);var P=new e["default"]().subtract(this._initialDistanceToGradientKnob);P.clamp(new e["default"](0,0));var O=K.clone().subtract(this._initialDistanceToGradientKnob);O.clamp(null,K);this._knobPosition.clamp(P,O);this._gradientKnobPosition.copy(this._knobPosition).add(this._initialDistanceToGradientKnob);this._updateStartAndEnd();this._updateDOM();this._ui.canvas.render()}},{key:"_onPositionKnobUp",value:function E(K){K.preventDefault();document.removeEventListener("mousemove",this._onPositionKnobDrag);document.removeEventListener("touchmove",this._onPositionKnobDrag);document.removeEventListener("mouseup",this._onPositionKnobUp);document.removeEventListener("touchend",this._onPositionKnobUp)}},{key:"_onGradientKnobDown",value:function z(K){K.preventDefault();this._initialMousePosition=m["default"].getEventPosition(K);this._initialGradientKnobPosition=this._gradientKnobPosition.clone();document.addEventListener("mousemove",this._onGradientKnobDrag);document.addEventListener("touchmove",this._onGradientKnobDrag);document.addEventListener("mouseup",this._onGradientKnobUp);document.addEventListener("touchend",this._onGradientKnobUp)}},{key:"_onGradientKnobDrag",value:function I(M){M.preventDefault();var K=this._ui.canvas.size;var P=m["default"].getEventPosition(M);var L=P.subtract(this._initialMousePosition);this._gradientKnobPosition.copy(this._initialGradientKnobPosition).add(L);this._gradientKnobPosition.clamp(new e["default"](0,0),K);var O=this._gradientKnobPosition.clone().subtract(this._knobPosition);var N=2*Math.sqrt(Math.pow(O.x,2)+Math.pow(O.y,2));this._operation.setGradientRadius(N);this._updateStartAndEnd();this._updateDOM();this._ui.canvas.render()}},{key:"_onGradientKnobUp",value:function v(K){K.preventDefault();document.removeEventListener("mousemove",this._onGradientKnobDrag);document.removeEventListener("touchmove",this._onGradientKnobDrag);document.removeEventListener("mouseup",this._onGradientKnobUp);document.removeEventListener("touchend",this._onGradientKnobUp)}},{key:"_updateDOM",value:function u(){var L=this._knobPosition;this._positionKnob.style.left=L.x+"px";this._positionKnob.style.top=L.y+"px";var R=this._gradientKnobPosition;this._gradientKnob.style.left=R.x+"px";this._gradientKnob.style.top=R.y+"px";var K=this._ui.canvas.size;var N=this._operation.getGradientRadius();var O=new e["default"](Math.sqrt(Math.pow(K.x,2)+Math.pow(K.y,2))*2,N);this._rect.style.width=O.x+"px";this._rect.style.height=O.y+"px";this._rect.style.marginLeft="-"+O.x/2+"px";this._rect.style.marginTop="-"+O.y/2+"px";this._rect.style.left=L.x+"px";this._rect.style.top=L.y+"px";var Q=R.clone().subtract(L);var P=Math.atan2(Q.x,Q.y)*(180/Math.PI);var M="rotate("+(-P).toFixed(2)+"deg)";this._rect.style.transform=M;this._rect.style["-moz-transform"]=M;this._rect.style["-ms-transform"]=M;this._rect.style["-webkit-transform"]=M}},{key:"_onBack",value:function G(){if(this._operationExistedBefore){this._operation.set(this._initialSettings)}else{this._ui.removeOperation("tilt-shift")}this._ui.canvas.render()}},{key:"_onDone",value:function D(){this._ui.addHistory(this._operation,{start:this._initialSettings.start.clone(),end:this._initialSettings.end.clone(),blurRadius:this._initialSettings.blurRadius,gradientRadius:this._initialSettings.gradientRadius},this._operationExistedBefore)}}]);return y})(f["default"]);o.prototype.identifier="tilt-shift";s["default"]=o;d.exports=s["default"]},function(d,j,c){Object.defineProperty(j,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var m=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function l(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var i=c(92);var n=q(i);var b=c(101);var p=q(b);var h=c(104);var k=q(h);var g=(function(r){o(t,r);function t(){l(this,t);m(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}f(t,[{key:"init",value:function z(){var A=function(C){var B="<div> "+(C.partials.slider)+'</div><div class="imglykit-controls-button"> '+(C.partials.colorPicker)+"</div>"+(C.partials.doneButton);return B};this._controlsTemplate=A;this._partialTemplates.slider=p["default"].template;this._partialTemplates.colorPicker=k["default"].template}},{key:"_renderControls",value:function w(){this._partialTemplates.colorPicker.additionalContext={label:this._ui.translate("controls.frames.color")};m(Object.getPrototypeOf(t.prototype),"_renderControls",this).call(this)}},{key:"_onEnter",value:function s(){this._operationExistedBefore=!!this._ui.operations.frames;this._operation=this._ui.getOrCreateOperation("frames");this._initialOptions={thickness:this._operation.getThickness(),color:this._operation.getColor()};this._ui.canvas.render();var B=this._controls.querySelector(".imglykit-slider");this._slider=new p["default"](B,{minValue:0,maxValue:0.5});this._slider.on("update",this._onThicknessUpdate.bind(this));this._slider.setValue(this._initialOptions.thickness);var A=this._controls.querySelector(".imglykit-color-picker");this._colorPicker=new k["default"](this._ui,A);this._colorPicker.on("update",this._onColorUpdate.bind(this));this._colorPicker.setValue(this._initialOptions.color)}},{key:"_onBack",value:function y(){if(this._operationExistedBefore){this._operation.set(this._initialOptions)}else{this._ui.removeOperation("frames")}this._ui.canvas.render()}},{key:"_onThicknessUpdate",value:function v(A){this._operation.setThickness(A);this._ui.canvas.render();this._highlightDoneButton()}},{key:"_onColorUpdate",value:function u(A){this._operation.setColor(A);this._ui.canvas.render();this._highlightDoneButton()}},{key:"_onDone",value:function x(){this._ui.addHistory(this._operation,{color:this._initialOptions.color,thickness:this._initialOptions.thickness},this._operationExistedBefore)}}]);return t})(n["default"]);g.prototype.identifier="frames";j["default"]=g;d.exports=j["default"]},function(e,t,g){Object.defineProperty(t,"__esModule",{value:true});var h=(function(){function u(z,y){var C=[];var v=true;var B=false;var A=undefined;try{for(var x=z[Symbol.iterator](),D;!(v=(D=x.next()).done);v=true){C.push(D.value);if(y&&C.length===y){break}}}catch(w){B=true;A=w}finally{try{if(!v&&x["return"]){x["return"]()}}finally{if(B){throw A}}}return C}return function(v,w){if(Array.isArray(v)){return v}else{if(Symbol.iterator in Object(v)){return u(v,w)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}})();var o=(function(){function u(y,w){for(var v=0;v<w.length;v++){var x=w[v];x.enumerable=x.enumerable||false;x.configurable=true;if("value" in x){x.writable=true}Object.defineProperty(y,x.key,x)}}return function(x,v,w){if(v){u(x.prototype,v)}if(w){u(x,w)}return x}})();var c=function r(B,A,z){var x=true;_function:while(x){var v=B,D=A,u=z;w=C=y=undefined;x=false;if(v===null){v=Function.prototype}var w=Object.getOwnPropertyDescriptor(v,D);if(w===undefined){var C=Object.getPrototypeOf(v);if(C===null){return undefined}else{B=C;A=D;z=u;x=true;continue _function}}else{if("value" in w){return w.value}else{var y=w.get;if(y===undefined){return undefined}return y.call(u)}}}};function d(u){return u&&u.__esModule?u:{"default":u}}function j(u,v){if(!(u instanceof v)){throw new TypeError("Cannot call a class as a function")}}function m(v,u){if(typeof u!=="function"&&u!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof u)}v.prototype=Object.create(u&&u.prototype,{constructor:{value:v,enumerable:false,writable:true,configurable:true}});if(u){Object.setPrototypeOf?Object.setPrototypeOf(v,u):v.__proto__=u}}var p=g(2);var k=d(p);var s=g(15);var n=d(s);var q=g(23);var i=d(q);var l=g(4);var f=d(l);var b=(function(T){m(u,T);function u(aa,Z){j(this,u);c(Object.getPrototypeOf(u.prototype),"constructor",this).call(this);this._ui=aa;this._element=Z;this._visible=false;this._loaded=false;this._overlay=this._element.querySelector(".imglykit-color-picker-overlay");this._currentColorCanvas=this._element.querySelector(".imglykit-color-picker-color");this._alphaCanvas=this._element.querySelector("canvas.imglykit-color-picker-alpha");this._alphaKnob=this._element.querySelector(".imglykit-color-picker-alpha-container .imglykit-transparent-knob");this._hueCanvas=this._element.querySelector("canvas.imglykit-color-picker-hue");this._hueKnob=this._element.querySelector(".imglykit-color-picker-hue-container .imglykit-transparent-knob");this._saturationCanvas=this._element.querySelector("canvas.imglykit-color-picker-saturation");this._saturationKnob=this._element.querySelector(".imglykit-color-picker-saturation-container .imglykit-transparent-knob");this._transparencyImage=new Image();this._transparencyImage.src=aa.helpers.assetPath("ui/night/transparency.png");this._transparencyImage.addEventListener("load",this._onTransparencyImageLoad.bind(this));this._onAlphaCanvasDown=this._onAlphaCanvasDown.bind(this);this._onAlphaCanvasDrag=this._onAlphaCanvasDrag.bind(this);this._onAlphaCanvasUp=this._onAlphaCanvasUp.bind(this);this._onHueCanvasDown=this._onHueCanvasDown.bind(this);this._onHueCanvasDrag=this._onHueCanvasDrag.bind(this);this._onHueCanvasUp=this._onHueCanvasUp.bind(this);this._onSaturationCanvasDown=this._onSaturationCanvasDown.bind(this);this._onSaturationCanvasDrag=this._onSaturationCanvasDrag.bind(this);this._onSaturationCanvasUp=this._onSaturationCanvasUp.bind(this);this._onElementClick=this._onElementClick.bind(this);this._handleToggle();this._handleAlphaKnob();this._handleHueKnob();this._handleSaturationKnob()}o(u,[{key:"_onTransparencyImageLoad",value:function Y(){this._loaded=true;this._render()}},{key:"_handleToggle",value:function z(){this._element.addEventListener("click",this._onElementClick)}},{key:"_onElementClick",value:function U(Z){if(Z.target===this._element||Z.target===this._currentColorCanvas){if(this._visible){this.hide();this.emit("hide")}else{this.show();this.emit("show")}}}},{key:"hide",value:function M(){n["default"].classList(this._overlay).remove("imglykit-visible");this._visible=false}},{key:"show",value:function X(){n["default"].classList(this._overlay).add("imglykit-visible");this._visible=true}},{key:"setValue",value:function A(ae){this._value=ae.clone();var ac=this._value.toHSV();var ad=h(ac,3);var ab=ad[0];var aa=ad[1];var Z=ad[2];this._hsvColor={h:ab,s:aa,v:Z};this._positionKnobs();this._render()}},{key:"_positionKnobs",value:function y(){this._positionAlphaKnob();this._positionHueKnob();this._positionSaturationKnob()}},{key:"_positionAlphaKnob",value:function I(){var aa=this._alphaCanvas;var Z=new f["default"](aa.width,aa.height);var ab=this._value.a*Z.x;this._alphaKnob.style.left=ab+"px"}},{key:"_positionHueKnob",value:function J(){var aa=this._hueCanvas;var Z=new f["default"](aa.width,aa.height);var ab=this._hsvColor.h*Z.y;this._hueKnob.style.top=ab+"px"}},{key:"_positionSaturationKnob",value:function D(){var aa=this._saturationCanvas;var Z=new f["default"](aa.width,aa.height);var ac=this._hsvColor.s*Z.x;this._saturationKnob.style.left=ac+"px";var ab=(1-this._hsvColor.v)*Z.y;this._saturationKnob.style.top=ab+"px"}},{key:"_render",value:function F(){if(!this._loaded){return}this._renderCurrentColor();this._renderAlpha();this._renderHue();this._renderSaturation()}},{key:"_renderCurrentColor",value:function G(){var Z=this._currentColorCanvas;var aa=Z.getContext("2d");var ab=aa.createPattern(this._transparencyImage,"repeat");aa.rect(0,0,Z.width,Z.height);aa.fillStyle=ab;aa.fill();aa.fillStyle=this._value.toRGBA();aa.fill()}},{key:"_renderAlpha",value:function H(){var aa=this._alphaCanvas;var ab=aa.getContext("2d");var ac=ab.createPattern(this._transparencyImage,"repeat");ab.rect(0,0,aa.width,aa.height);ab.fillStyle=ac;ab.fill();var ad=ab.createLinearGradient(0,0,aa.width,aa.height);var Z=this._value.clone();Z.a=0;ad.addColorStop(0,Z.toRGBA());ad.addColorStop(1,this._value.toHex());ab.fillStyle=ad;ab.fill()}},{key:"_renderHue",value:function w(){var aa=this._hueCanvas;var ab=aa.getContext("2d");var Z=new i["default"]();for(var ad=0;ad<aa.height;ad++){var ac=ad/aa.height;Z.fromHSV(ac,1,1);ab.strokeStyle=Z.toRGBA();ab.beginPath();ab.moveTo(0,ad);ab.lineTo(aa.width,ad);ab.stroke()}}},{key:"_renderSaturation",value:function x(){var ac=this._saturationCanvas;var ab=ac.getContext("2d");var aa=ab.getImageData(0,0,ac.width,ac.height);var ad=new i["default"](1,0,0,1);for(var ai=0;ai<ac.height;ai++){var al=(ac.height-ai)/ac.height;for(var ak=0;ak<ac.width;ak++){var ae=ak/ac.width;ad.fromHSV(this._hsvColor.h,ae,al);var Z=ad.r;var af=ad.g;var ah=ad.b;var aj=ad.a;var ag=(ai*ac.width+ak)*4;aa.data[ag]=Z*255;aa.data[ag+1]=af*255;aa.data[ag+2]=ah*255;aa.data[ag+3]=aj*255}}ab.putImageData(aa,0,0)}},{key:"_handleAlphaKnob",value:function C(){this._alphaCanvas.addEventListener("mousedown",this._onAlphaCanvasDown);this._alphaCanvas.addEventListener("touchstart",this._onAlphaCanvasDown)}},{key:"_onAlphaCanvasDown",value:function S(Z){Z.preventDefault();this._onAlphaCanvasDrag(Z);document.addEventListener("mousemove",this._onAlphaCanvasDrag);document.addEventListener("touchmove",this._onAlphaCanvasDrag);document.addEventListener("mouseup",this._onAlphaCanvasUp);document.addEventListener("touchend",this._onAlphaCanvasUp)}},{key:"_onAlphaCanvasDrag",value:function v(ad){ad.preventDefault();var aa=this._alphaCanvas;var ag=new f["default"](aa.width,aa.height);var af=n["default"].getEventPosition(ad);var ah=aa.getBoundingClientRect();var ab=ah.left;var ae=ah.top;var ac=new f["default"](ab,ae);var Z=af.subtract(ac);Z.clamp(new f["default"](0,0),ag);this._alphaKnob.style.left=Z.x+"px";this._value.a=Z.x/ag.x;this._updateColor()}},{key:"_onAlphaCanvasUp",value:function O(){document.removeEventListener("mousemove",this._onAlphaCanvasDrag);document.removeEventListener("touchmove",this._onAlphaCanvasDrag);document.removeEventListener("mouseup",this._onAlphaCanvasUp);document.removeEventListener("touchend",this._onAlphaCanvasUp)}},{key:"_handleHueKnob",value:function N(){this._hueCanvas.addEventListener("mousedown",this._onHueCanvasDown);this._hueCanvas.addEventListener("touchstart",this._onHueCanvasDown)}},{key:"_onHueCanvasDown",value:function E(Z){Z.preventDefault();this._onHueCanvasDrag(Z);document.addEventListener("mousemove",this._onHueCanvasDrag);document.addEventListener("touchmove",this._onHueCanvasDrag);document.addEventListener("mouseup",this._onHueCanvasUp);document.addEventListener("touchend",this._onHueCanvasUp)}},{key:"_onHueCanvasDrag",value:function Q(ae){ae.preventDefault();var aa=this._hueCanvas;var ah=new f["default"](aa.width,aa.height);var ag=n["default"].getEventPosition(ae);var ac=aa.getBoundingClientRect();var ab=ac.left;var af=ac.top;var ad=new f["default"](ab,af);var Z=ag.subtract(ad);Z.clamp(new f["default"](0,0),ah);this._hueKnob.style.top=Z.y+"px";Z.divide(ah);this._hsvColor.h=Z.y;this._updateColor()}},{key:"_onHueCanvasUp",value:function L(){document.removeEventListener("mousemove",this._onHueCanvasDrag);document.removeEventListener("touchmove",this._onHueCanvasDrag);document.removeEventListener("mouseup",this._onHueCanvasUp);document.removeEventListener("touchend",this._onHueCanvasUp)}},{key:"_handleSaturationKnob",value:function V(){this._saturationCanvas.addEventListener("mousedown",this._onSaturationCanvasDown);this._saturationCanvas.addEventListener("touchstart",this._onSaturationCanvasDown)}},{key:"_onSaturationCanvasDown",value:function B(Z){Z.preventDefault();this._onSaturationCanvasDrag(Z);document.addEventListener("mousemove",this._onSaturationCanvasDrag);document.addEventListener("touchmove",this._onSaturationCanvasDrag);document.addEventListener("mouseup",this._onSaturationCanvasUp);document.addEventListener("touchend",this._onSaturationCanvasUp)}},{key:"_onSaturationCanvasDrag",value:function P(ae){ae.preventDefault();var aa=this._saturationCanvas;var ah=new f["default"](aa.width,aa.height);var ag=n["default"].getEventPosition(ae);var ac=aa.getBoundingClientRect();var ab=ac.left;var af=ac.top;var ad=new f["default"](ab,af);var Z=ag.subtract(ad);Z.clamp(0,aa.width);this._saturationKnob.style.left=Z.x+"px";this._saturationKnob.style.top=Z.y+"px";Z.divide(ah);this._hsvColor.s=Z.x;this._hsvColor.v=1-Z.y;this._updateColor()}},{key:"_onSaturationCanvasUp",value:function R(){document.removeEventListener("mousemove",this._onSaturationCanvasDrag);document.removeEventListener("touchmove",this._onSaturationCanvasDrag);document.removeEventListener("mouseup",this._onSaturationCanvasUp);document.removeEventListener("touchend",this._onSaturationCanvasUp)}},{key:"_updateColor",value:function K(){this._value.fromHSV(this._hsvColor.h,this._hsvColor.s,this._hsvColor.v);this.emit("update",this._value);this._render()}}],[{key:"template",get:function W(){return function(aa){var Z='<div class="imglykit-color-picker" id="'+((typeof aa.id==="undefined"?"":aa.id))+'"> <canvas class="imglykit-color-picker-color" width="34" height="34"></canvas> <div class="imglykit-controls-item-label">'+((typeof aa.label==="undefined"?"":aa.label))+'</div> <div class="imglykit-color-picker-overlay"> <div class="imglykit-color-picker-alpha-container"> <canvas class="imglykit-color-picker-alpha" width="200" height="30"></canvas> <div class="imglykit-transparent-knob"></div> </div> <div class="imglykit-color-picker-saturation-container"> <canvas class="imglykit-color-picker-saturation" width="160" height="160"></canvas> <div class="imglykit-transparent-knob"></div> </div> <div class="imglykit-color-picker-hue-container"> <canvas class="imglykit-color-picker-hue" width="30" height="160"></canvas> <div class="imglykit-transparent-knob"></div> </div> </div></div>';return Z}}}]);return u})(k["default"]);t["default"]=b;e.exports=t["default"]},function(c,i,b){Object.defineProperty(i,"__esModule",{value:true});var e=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var k=function d(y,x,u){var v=true;_function:while(v){var s=y,A=x,r=u;t=z=w=undefined;v=false;if(s===null){s=Function.prototype}var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;u=r;v=true;continue _function}}else{if("value" in t){return t.value}else{var w=t.get;if(w===undefined){return undefined}return w.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){Object.setPrototypeOf?Object.setPrototypeOf(s,r):s.__proto__=r}}var g=b(92);var n=p(g);var h=b(4);var l=p(h);var f=b(15);var q=p(f);var m=(function(x){o(v,x);function v(){j(this,v);k(Object.getPrototypeOf(v.prototype),"constructor",this).apply(this,arguments)}e(v,[{key:"init",value:function H(){var P=function(U){var T='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> ';for(var S in U.stickers){T+=" ";var V=U.stickers[S];T+=" ";var R=U.activeSticker===S;T+=' <li data-identifier="'+(S)+'"';if(R){T+=' class="imglykit-controls-item-active"'}T+='> <canvas class="imglykit-controls-item-canvas" data-image="'+(U.helpers.assetPath(V))+'"></canvas> </li> '}T+=" </ul></div>"+(U.partials.doneButton);return T};this._controlsTemplate=P;var Q=function(S){var R='<div class="imglykit-canvas-stickers-container"> <div class="imglykit-canvas-stickers"> <img class="imglykit-canvas-sticker-image" /> <div class="imglykit-knob"></div> </div></div>';return R};this._canvasControlsTemplate=Q;this._availableStickers={};this._stickers={};this._addDefaultStickers();this.selectStickers(null)}},{key:"_addDefaultStickers",value:function C(){this.addSticker("glasses-nerd","stickers/sticker-glasses-nerd.png");this.addSticker("glasses-normal","stickers/sticker-glasses-normal.png");this.addSticker("glasses-shutter-green","stickers/sticker-glasses-shutter-green.png");this.addSticker("glasses-shutter-yellow","stickers/sticker-glasses-shutter-yellow.png");this.addSticker("glasses-sun","stickers/sticker-glasses-sun.png");this.addSticker("hat-cap","stickers/sticker-hat-cap.png");this.addSticker("hat-cylinder","stickers/sticker-hat-cylinder.png");this.addSticker("hat-party","stickers/sticker-hat-party.png");this.addSticker("hat-sheriff","stickers/sticker-hat-sheriff.png");this.addSticker("heart","stickers/sticker-heart.png");this.addSticker("mustache-long","stickers/sticker-mustache-long.png");this.addSticker("mustache1","stickers/sticker-mustache1.png");this.addSticker("mustache2","stickers/sticker-mustache2.png");this.addSticker("mustache3","stickers/sticker-mustache3.png");this.addSticker("pipe","stickers/sticker-pipe.png");this.addSticker("snowflake","stickers/sticker-snowflake.png");this.addSticker("star","stickers/sticker-star.png")}},{key:"addSticker",value:function I(P,Q){this._availableStickers[P]=Q;this._stickers[P]=this._availableStickers[P];if(this._active){this._renderControls()}}},{key:"selectStickers",value:function z(Q){this._stickers={};var T=Object.keys(this._availableStickers);var P=q["default"].select(T,Q);for(var S=0;S<P.length;S++){var R=P[S];this._stickers[R]=this._availableStickers[R]}if(this._active){this._renderControls()}}},{key:"_onEnter",value:function M(){var Q=this;this._operationExistedBefore=!!this._ui.operations.stickers;this._operation=this._ui.getOrCreateOperation("stickers");this._ui.removeOperation("stickers");this._initialSettings={sticker:this._operation.getSticker(),position:this._operation.getPosition().clone(),size:this._operation.getSize().clone()};var P=this._ui.canvas.size;this._size=this._initialSettings.size.clone();this._position=this._initialSettings.position.clone().multiply(P);this._initialZoomLevel=this._ui.canvas.zoomLevel;this._ui.canvas.zoomToFit();this._container=this._canvasControls.querySelector(".imglykit-canvas-stickers");this._stickerImage=this._canvasControls.querySelector("img");this._stickerImage.addEventListener("load",function(){Q._stickerSize=new l["default"](Q._stickerImage.width,Q._stickerImage.height);Q._onStickerLoad()});this._knob=this._canvasControls.querySelector("div.imglykit-knob");this._onImageDown=this._onImageDown.bind(this);this._onImageDrag=this._onImageDrag.bind(this);this._onImageUp=this._onImageUp.bind(this);this._onKnobDown=this._onKnobDown.bind(this);this._onKnobDrag=this._onKnobDrag.bind(this);this._onKnobUp=this._onKnobUp.bind(this);this._renderListItems();this._handleListItems();this._handleImage();this._handleKnob()}},{key:"_renderListItems",value:function t(){var Q=this;var R=this._controls.querySelectorAll("li canvas");this._canvasItems=Array.prototype.slice.call(R);var S=function(W){var U=Q._canvasItems[W];U.width=U.offsetWidth;U.height=U.offsetHeight;var V=U.getContext("2d");var X=U.getAttribute("data-image");var Y=document.createElement("img");var T=new l["default"](U.width,U.height);Y.addEventListener("load",function(){var aa=new l["default"](Y.width,Y.height);var Z=q["default"].resizeVectorToFit(aa,T);var ab=T.clone().divide(2).subtract(Z.clone().divide(2));V.drawImage(Y,0,0,aa.x,aa.y,ab.x,ab.y,Z.x,Z.y)});Y.src=X};for(var P=0;P<this._canvasItems.length;P++){S(P)}}},{key:"_handleListItems",value:function E(){var Q=this;var S=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(S);var R=function(U){var V=Q._listItems[U];var T=V.getAttribute("data-identifier");V.addEventListener("click",function(){Q._onListItemClick(V)});if(!Q._operationExistedBefore&&U===0||Q._operationExistedBefore&&Q._stickers[T]===Q._initialSettings.sticker){Q._onListItemClick(V,false)}};for(var P=0;P<this._listItems.length;P++){R(P)}}},{key:"_applySettings",value:function K(){var P=this._stickerSize.y/this._stickerSize.x;this._size.y=this._size.x*P;this._stickerImage.style.width=this._size.x+"px";this._stickerImage.style.height=this._size.y+"px";this._container.style.left=this._position.x+"px";this._container.style.top=this._position.y+"px"}},{key:"_onBack",value:function J(){if(this._operationExistedBefore){this._operation=this._ui.getOrCreateOperation("stickers");this._operation.set(this._initialSettings)}else{this._ui.removeOperation("stickers")}this._ui.canvas.setZoomLevel(this._initialZoomLevel)}},{key:"_onDone",value:function D(){var Q=this._ui.canvas.size;var P=this._position.clone().divide(Q);var R=this._size.clone().divide(Q);this._ui.canvas.setZoomLevel(this._initialZoomLevel,false);this._operation=this._ui.getOrCreateOperation("stickers");this._operation.set({sticker:this._availableStickers[this._sticker],position:P,size:R});this._ui.canvas.render();this._ui.addHistory(this,{sticker:this._initialSettings.sticker,position:this._initialSettings.position.clone(),size:this._initialSettings.size.clone()},this._operationExistedBefore)}},{key:"_handleKnob",value:function u(){this._knob.addEventListener("mousedown",this._onKnobDown);this._knob.addEventListener("touchstart",this._onKnobDown)}},{key:"_onKnobDown",value:function L(P){P.preventDefault();this._initialMousePosition=q["default"].getEventPosition(P);this._initialSize=this._size.clone();document.addEventListener("mousemove",this._onKnobDrag);document.addEventListener("touchmove",this._onKnobDrag);document.addEventListener("mouseup",this._onKnobUp);document.addEventListener("touchend",this._onKnobUp)}},{key:"_onKnobDrag",value:function s(S){S.preventDefault();var T=q["default"].getEventPosition(S);var R=T.clone().subtract(this._initialMousePosition);var P=this._initialSize.clone();var Q=this._stickerImage.height/this._stickerImage.width;P.x+=R.x;P.y=P.x*Q;this._size.copy(P);this._applySettings();this._highlightDoneButton()}},{key:"_onKnobUp",value:function G(){document.removeEventListener("mousemove",this._onKnobDrag);document.removeEventListener("touchmove",this._onKnobDrag);document.removeEventListener("mouseup",this._onKnobUp);document.removeEventListener("touchend",this._onKnobUp)}},{key:"_handleImage",value:function r(){this._stickerImage.addEventListener("mousedown",this._onImageDown);this._stickerImage.addEventListener("touchstart",this._onImageDown)}},{key:"_onImageDown",value:function B(P){P.preventDefault();this._initialMousePosition=q["default"].getEventPosition(P);this._initialPosition=this._position.clone();document.addEventListener("mousemove",this._onImageDrag);document.addEventListener("touchmove",this._onImageDrag);document.addEventListener("mouseup",this._onImageUp);document.addEventListener("touchend",this._onImageUp)}},{key:"_onImageDrag",value:function N(R){R.preventDefault();var S=q["default"].getEventPosition(R);var Q=S.clone().subtract(this._initialMousePosition);var P=this._initialPosition.clone();P.add(Q);this._position.copy(P);this._applySettings();this._highlightDoneButton()}},{key:"_onImageUp",value:function y(){document.removeEventListener("mousemove",this._onImageDrag);document.removeEventListener("touchmove",this._onImageDrag);document.removeEventListener("mouseup",this._onImageUp);document.removeEventListener("touchend",this._onImageUp)}},{key:"_onStickerLoad",value:function F(){this._size=new l["default"](this._stickerImage.width,this._stickerImage.height);if(typeof this._position==="undefined"){this._position=new l["default"](0,0)}this._applySettings()}},{key:"_onListItemClick",value:function A(S){var P=arguments.length<=1||arguments[1]===undefined?true:arguments[1];this._deactivateAllItems();var Q=S.getAttribute("data-identifier");var R=this._availableStickers[Q];R=this._kit.getAssetPath(R);try{this._stickerImage.attributes.removeNamedItem("style")}catch(T){}this._sticker=Q;this._stickerImage.src=R;q["default"].classList(S).add("imglykit-controls-item-active");if(P){this._highlightDoneButton()}}},{key:"_deactivateAllItems",value:function w(){for(var P=0;P<this._listItems.length;P++){var Q=this._listItems[P];q["default"].classList(Q).remove("imglykit-controls-item-active")}}},{key:"context",get:function O(){var P=k(Object.getPrototypeOf(v.prototype),"context",this);P.stickers=this._stickers;return P}}]);return v})(n["default"]);m.prototype.identifier="stickers";i["default"]=m;c.exports=i["default"]},function(d,s,g){Object.defineProperty(s,"__esModule",{value:true});var n=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var b=function q(A,z,w){var x=true;_function:while(x){var u=A,C=z,t=w;v=B=y=undefined;x=false;if(u===null){u=Function.prototype}var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;w=t;x=true;continue _function}}else{if("value" in v){return v.value}else{var y=v.get;if(y===undefined){return undefined}return y.call(t)}}}};function c(t){return t&&t.__esModule?t:{"default":t}}function h(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function l(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){Object.setPrototypeOf?Object.setPrototypeOf(u,t):u.__proto__=t}}var p=g(92);var f=c(p);var j=g(104);var i=c(j);var k=g(4);var e=c(k);var r=g(15);var m=c(r);var o=(function(B){l(R,B);function R(){h(this,R);b(Object.getPrototypeOf(R.prototype),"constructor",this).apply(this,arguments)}n(R,[{key:"init",value:function N(){var W=function(ac){var ab='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> ';var aa=ac.fonts;if(aa){var ad,Z=-1,Y=aa.length-1;while(Z<Y){ad=aa[Z+=1];ab+=' <li data-name="'+(ad.name)+'" data-weight="'+(ad.weight)+'"> <canvas class="imglykit-controls-item-canvas"></canvas> </li> '}}ab+=' </ul></div><div class="imglykit-controls-button"> '+(ac.partials.fgColorPicker)+'</div><div class="imglykit-controls-button"> '+(ac.partials.bgColorPicker)+"</div>"+(ac.partials.doneButton);return ab};this._controlsTemplate=W;var X=function(Z){var Y='<div class="imglykit-canvas-text-container"> <div class="imglykit-canvas-text"> <div class="imglykit-crosshair"> <img src="'+(Z.helpers.assetPath("ui/night/crosshair.png"))+'" /> </div> <div class="imglykit-canvas-text-textarea"> <textarea></textarea> <div class="imglykit-knob"></div> </div> </div></div>';return Y};this._canvasControlsTemplate=X;this._partialTemplates.fgColorPicker=i["default"].template;this._partialTemplates.fgColorPicker.additionalContext={id:"imglykit-text-foreground-color-picker"};this._partialTemplates.bgColorPicker=i["default"].template;this._partialTemplates.bgColorPicker.additionalContext={id:"imglykit-text-background-color-picker"};this._fonts=[];this._addFonts()}},{key:"_renderControls",value:function I(){this._partialTemplates.fgColorPicker.additionalContext.label=this._ui.translate("controls.text.foreground");this._partialTemplates.bgColorPicker.additionalContext.label=this._ui.translate("controls.text.background");b(Object.getPrototypeOf(R.prototype),"_renderControls",this).call(this)}},{key:"_onEnter",value:function S(){var X=this;this._operationExistedBefore=!!this._ui.operations.text;this._operation=this._ui.getOrCreateOperation("text");this._ui.removeOperation("text");var W=this._ui.canvas.size;this._initialSettings={lineHeight:this._operation.getLineHeight(),fontSize:this._operation.getFontSize(),fontFamily:this._operation.getFontFamily(),fontWeight:this._operation.getFontWeight(),color:this._operation.getColor(),position:this._operation.getPosition(),text:this._operation.getText()||"",maxWidth:this._operation.getMaxWidth(),backgroundColor:this._operation.getBackgroundColor()};this._settings={lineHeight:this._initialSettings.lineHeight,fontSize:this._initialSettings.fontSize,fontFamily:this._initialSettings.fontFamily,fontWeight:this._initialSettings.fontWeight,color:this._initialSettings.color.clone(),position:this._initialSettings.position.clone().multiply(W),text:this._initialSettings.text,maxWidth:this._initialSettings.maxWidth*W.x,backgroundColor:this._initialSettings.backgroundColor.clone()};this._initialZoomLevel=this._ui.canvas.zoomLevel;this._container=this._canvasControls.querySelector(".imglykit-canvas-text");this._textarea=this._canvasControls.querySelector("textarea");this._textarea.focus();this._moveKnob=this._canvasControls.querySelector(".imglykit-crosshair");this._resizeKnob=this._canvasControls.querySelector(".imglykit-knob");if(this._operationExistedBefore){this._settings.position.x-=2;this._settings.position.y-=2}this._onTextareaKeyUp=this._onTextareaKeyUp.bind(this);this._onResizeKnobDown=this._onResizeKnobDown.bind(this);this._onResizeKnobDrag=this._onResizeKnobDrag.bind(this);this._onResizeKnobUp=this._onResizeKnobUp.bind(this);this._onMoveKnobDown=this._onMoveKnobDown.bind(this);this._onMoveKnobDrag=this._onMoveKnobDrag.bind(this);this._onMoveKnobUp=this._onMoveKnobUp.bind(this);this._onForegroundColorUpdate=this._onForegroundColorUpdate.bind(this);this._onBackgroundColorUpdate=this._onBackgroundColorUpdate.bind(this);this._initColorPickers();this._renderListItems();this._handleListItems();this._handleTextarea();this._handleResizeKnob();this._handleMoveKnob();setTimeout(function(){X._resizeTextarea()},1);this._ui.canvas.zoomToFit().then(function(){X._applySettings()})}},{key:"_initColorPickers",value:function w(){var X=this;var Y=this._controls.querySelector("#imglykit-text-foreground-color-picker");this._foregroundColorPicker=new i["default"](this._ui,Y);this._foregroundColorPicker.setValue(this._operation.getColor());this._foregroundColorPicker.on("update",this._onForegroundColorUpdate);this._foregroundColorPicker.on("show",function(){X._backgroundColorPicker.hide()});var W=this._controls.querySelector("#imglykit-text-background-color-picker");this._backgroundColorPicker=new i["default"](this._ui,W);this._backgroundColorPicker.setValue(this._operation.getBackgroundColor());this._backgroundColorPicker.on("update",this._onBackgroundColorUpdate);this._backgroundColorPicker.on("show",function(){X._foregroundColorPicker.hide()})}},{key:"_renderListItems",value:function z(){var ac=this._controls.querySelectorAll("li canvas");this._canvasItems=Array.prototype.slice.call(ac);for(var aa=0;aa<this._canvasItems.length;aa++){var Y=this._canvasItems[aa];Y.width=Y.offsetWidth;Y.height=Y.offsetHeight;var ab=Y.parentNode;var Z=Y.getContext("2d");var W=ab.getAttribute("data-name");var X=ab.getAttribute("data-weight");Z.font=X+" 30px "+W;Z.textBaseline="middle";Z.textAlign="center";Z.fillStyle="white";Z.fillText(W.substr(0,2),Y.width/2,Y.height/2)}}},{key:"_handleListItems",value:function L(){var X=this;var Y=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(Y);var Z=function(ab){var ac=X._listItems[ab];var aa=ac.getAttribute("data-name");ac.addEventListener("click",function(){X._onListItemClick(ac)});if(!X._operationExistedBefore&&ab===0||X._operationExistedBefore&&aa===X._initialSettings.fontFamily){X._onListItemClick(ac,false)}};for(var W=0;W<this._listItems.length;W++){Z(W)}}},{key:"_handleTextarea",value:function D(){this._textarea.addEventListener("keyup",this._onTextareaKeyUp)}},{key:"_onTextareaKeyUp",value:function J(){this._resizeTextarea();this._settings.text=this._textarea.value;this._highlightDoneButton()}},{key:"_resizeTextarea",value:function v(){var Z=this._textarea.scrollTop;if(!Z){var Y=undefined,W=undefined;do{Y=this._textarea.scrollHeight;W=this._textarea.offsetHeight;this._textarea.style.height=W-5+"px"}while(Y&&Y!==this._textarea.scrollHeight)}var X=this._textarea.scrollHeight;this._textarea.style.height=X+20+"px"}},{key:"_handleMoveKnob",value:function y(){this._moveKnob.addEventListener("mousedown",this._onMoveKnobDown);this._moveKnob.addEventListener("touchstart",this._onMoveKnobDown)}},{key:"_onMoveKnobDown",value:function V(W){W.preventDefault();this._initialMousePosition=m["default"].getEventPosition(W);this._initialPosition=this._settings.position.clone();document.addEventListener("mousemove",this._onMoveKnobDrag);document.addEventListener("touchmove",this._onMoveKnobDrag);document.addEventListener("mouseup",this._onMoveKnobUp);document.addEventListener("touchend",this._onMoveKnobUp)}},{key:"_onMoveKnobDrag",value:function x(Z){Z.preventDefault();var X=this._ui.canvas.size;var ad=m["default"].getEventPosition(Z);var Y=ad.clone().subtract(this._initialMousePosition);var ac=new e["default"](0,0);var ab=new e["default"](this._container.offsetWidth,this._container.offsetHeight);var aa=X.clone().subtract(ab);var W=this._initialPosition.clone().add(Y).clamp(ac,aa);this._settings.position=W;this._container.style.left=W.x+"px";this._container.style.top=W.y+"px"}},{key:"_onMoveKnobUp",value:function H(){document.removeEventListener("mousemove",this._onMoveKnobDrag);document.removeEventListener("touchmove",this._onMoveKnobDrag);document.removeEventListener("mouseup",this._onMoveKnobUp);document.removeEventListener("touchend",this._onMoveKnobUp)}},{key:"_handleResizeKnob",value:function M(){this._resizeKnob.addEventListener("mousedown",this._onResizeKnobDown);this._resizeKnob.addEventListener("touchstart",this._onResizeKnobDown)}},{key:"_onResizeKnobDown",value:function E(W){W.preventDefault();this._initialMousePosition=m["default"].getEventPosition(W);this._initialMaxWidth=this._settings.maxWidth;document.addEventListener("mousemove",this._onResizeKnobDrag);document.addEventListener("touchmove",this._onResizeKnobDrag);document.addEventListener("mouseup",this._onResizeKnobUp);document.addEventListener("touchend",this._onResizeKnobUp)}},{key:"_onResizeKnobDrag",value:function P(ab){ab.preventDefault();var X=this._ui.canvas.size;var ac=m["default"].getEventPosition(ab);var aa=ac.subtract(this._initialMousePosition);var W=this._settings.position.clone();var Y=X.x-W.x;var Z=this._initialMaxWidth+aa.x;Z=Math.max(100,Math.min(Y,Z));this._settings.maxWidth=Z;this._textarea.style.width=Z+"px";this._resizeTextarea()}},{key:"_onResizeKnobUp",value:function t(){document.removeEventListener("mousemove",this._onResizeKnobDrag);document.removeEventListener("touchmove",this._onResizeKnobDrag);document.removeEventListener("mouseup",this._onResizeKnobUp);document.removeEventListener("touchend",this._onResizeKnobUp)}},{key:"_onForegroundColorUpdate",value:function T(W){this._settings.color=W;this._applySettings();this._highlightDoneButton()}},{key:"_onBackgroundColorUpdate",value:function u(W){this._settings.backgroundColor=W;this._applySettings();this._highlightDoneButton()}},{key:"_applySettings",value:function Q(){var X=this._textarea;var Z=this._settings;var W=this._ui.canvas.size;var Y=Z.fontSize*W.y;this._container.style.left=Z.position.x+"px";this._container.style.top=Z.position.y+"px";X.value=Z.text;X.style.fontFamily=Z.fontFamily;X.style.fontSize=Y+"px";X.style.fontWeight=Z.fontWeight;X.style.lineHeight=Z.lineHeight;X.style.color=Z.color.toRGBA();X.style.backgroundColor=Z.backgroundColor.toRGBA();X.style.width=Z.maxWidth+"px"}},{key:"_onListItemClick",value:function G(Y){var W=arguments.length<=1||arguments[1]===undefined?true:arguments[1];this._deactivateAllItems();var X=Y.getAttribute("data-name");var Z=Y.getAttribute("data-weight");this._settings.fontFamily=X;this._settings.fontWeight=Z;this._applySettings();m["default"].classList(Y).add("imglykit-controls-item-active");if(W){this._highlightDoneButton()}}},{key:"_deactivateAllItems",value:function A(){for(var W=0;W<this._listItems.length;W++){var X=this._listItems[W];m["default"].classList(X).remove("imglykit-controls-item-active")}}},{key:"_addFonts",value:function F(){this.addFont("Helvetica","normal");this.addFont("Verdana","normal");this.addFont("Times New Roman","normal")}},{key:"addFont",value:function C(W,X){this._fonts.push({name:W,weight:X})}},{key:"_onDone",value:function K(){var X=this._ui.canvas.size;var Y=new e["default"](2,2);var W=this._settings.position.clone().add(Y).divide(X);this._ui.canvas.setZoomLevel(this._initialZoomLevel,false);this._operation=this._ui.getOrCreateOperation("text");this._operation.set({fontSize:this._settings.fontSize,fontFamily:this._settings.fontFamily,fontWeight:this._settings.fontWeight,color:this._settings.color,backgroundColor:this._settings.backgroundColor,position:W,text:this._settings.text,maxWidth:this._settings.maxWidth/X.x});this._ui.canvas.render();this._ui.addHistory(this,{fontFamily:this._initialSettings.fontFamily,fontWeight:this._initialSettings.fontWeight,color:this._initialSettings.color.clone(),backgroundColor:this._initialSettings.backgroundColor.clone(),position:this._initialSettings.position.clone(),text:this._initialSettings.text,maxWidth:this._initialSettings.maxWidth},this._operationExistedBefore)}},{key:"_onBack",value:function O(){if(this._operationExistedBefore){this._operation=this._ui.getOrCreateOperation("text");this._operation.set(this._initialSettings)}else{this._ui.removeOperation("text")}this._ui.canvas.setZoomLevel(this._initialZoomLevel)}},{key:"context",get:function U(){var W=b(Object.getPrototypeOf(R.prototype),"context",this);W.fonts=this._fonts;return W}}]);return R})(f["default"]);o.prototype.identifier="text";s["default"]=o;d.exports=s["default"]},function(d,w,g){Object.defineProperty(w,"__esModule",{value:true});var q=(function(){function x(B,z){for(var y=0;y<z.length;y++){var A=z[y];A.enumerable=A.enumerable||false;A.configurable=true;if("value" in A){A.writable=true}Object.defineProperty(B,A.key,A)}}return function(A,y,z){if(y){x(A.prototype,y)}if(z){x(A,z)}return A}})();var b=function t(E,D,C){var A=true;_function:while(A){var y=E,G=D,x=C;z=F=B=undefined;A=false;if(y===null){y=Function.prototype}var z=Object.getOwnPropertyDescriptor(y,G);if(z===undefined){var F=Object.getPrototypeOf(y);if(F===null){return undefined}else{E=F;D=G;C=x;A=true;continue _function}}else{if("value" in z){return z.value}else{var B=z.get;if(B===undefined){return undefined}return B.call(x)}}}};function c(x){return x&&x.__esModule?x:{"default":x}}function i(x,y){if(!(x instanceof y)){throw new TypeError("Cannot call a class as a function")}}function o(y,x){if(typeof x!=="function"&&x!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof x)}y.prototype=Object.create(x&&x.prototype,{constructor:{value:y,enumerable:false,writable:true,configurable:true}});if(x){Object.setPrototypeOf?Object.setPrototypeOf(y,x):y.__proto__=x}}var s=g(92);var f=c(s);var n=g(4);var e=c(n);var u=g(15);var p=c(u);var m=g(101);var l=c(m);var k=g(104);var j=c(k);var r=g(23);var h=c(r);var v=(function(aa){o(F,aa);function F(){i(this,F);b(Object.getPrototypeOf(F.prototype),"constructor",this).apply(this,arguments)}q(F,[{key:"init",value:function ac(){var ah=function(ak){var aj="";if(ak.displayThickness){aj+=" <div> "+(ak.partials.slider)+" </div>"}else{aj+=' <div> <ul class="imglykit-controls-list imglykit-controls-list-overflow"> <li class="imglykit-controls-item--with-label" id="imglykit-thickness-button"> <img src="'+(ak.helpers.assetPath("ui/night/brush/thickness@2x.png"))+'" /> <div class="imglykit-controls-label">Thickness</div> </li> <li> '+(ak.partials.colorPicker)+" </li> </ul> </div>"}return aj};this._controlsTemplate=ah;var ai=function(ak){var aj='<div class="imglykit-canvas-brush-container"> <div class="imglykit-canvas-brush"> <canvas></canvas> </div> <div id="imglykit-brush-cursor"> </div></div>';return aj};this._canvasControlsTemplate=ai;this._partialTemplates.slider=l["default"].template;this._partialTemplates.colorPicker=j["default"].template;this._displayThickness=false;this._painting=false}},{key:"_renderControls",value:function N(){this._partialTemplates.colorPicker.additionalContext={label:this._ui.translate("controls.brush.color")};b(Object.getPrototypeOf(F.prototype),"_renderControls",this).call(this)}},{key:"_onEnter",value:function E(){b(Object.getPrototypeOf(F.prototype),"_onEnter",this).call(this);this._handleThicknessButton();this._setupCanvas();this._setupOperation();this._setupOptions();this._bindEventHandlers();this._setupContainer();this._setupSlider();this._initCurrentValues();this._setupColorPicker();this._initialZoomLevel=this._ui.canvas.zoomLevel;this._ui.canvas.zoomToFit();this._setupCursor()}},{key:"_handleThicknessButton",value:function af(){if(this._displayThickness){return}this._thicknessButton=this._controlsContainer.querySelector("#imglykit-thickness-button");this._thicknessButton.addEventListener("click",this._onThicknessButtonClick.bind(this))}},{key:"_onThicknessButtonClick",value:function O(ah){ah.preventDefault();this._displayThickness=true;this.enter()}},{key:"_initCurrentValues",value:function T(){this._currentThickness=this._currentThickness||this._operation.getLastThickness();this._currentColor=this._currentColor||this._operation.getLastColor()}},{key:"_setupCursor",value:function Y(){this._cursor=this._canvasControls.querySelector("#imglykit-brush-cursor");this._setCursorSize(this._currentThickness*this._getLongerSideSize());this._setCursorColor(this._currentColor)}},{key:"_setupOptions",value:function U(){this._initialOptions={paths:this._operation.getPaths().slice(0)}}},{key:"_setupCanvas",value:function ab(){var ah=this._ui.canvas;this._canvas=this._canvasControls.querySelector("canvas");this._canvas.width=ah.size.x;this._canvas.height=ah.size.y}},{key:"_setupOperation",value:function R(){this._operationExistedBefore=!!this._ui.operations.brush;this._operation=this._ui.getOrCreateOperation("brush")}},{key:"_setupContainer",value:function Q(){this._container=this._canvasControls.querySelector(".imglykit-canvas-brush-container");this._container.addEventListener("mousedown",this._onMouseDown);this._container.addEventListener("touchstart",this._onMouseDown);this._container.addEventListener("mouseup",this._onMouseUp);this._container.addEventListener("touchend",this._onMouseUp);document.addEventListener("mousemove",this._onMouseMove);document.addEventListener("touchmove",this._onMouseMove);this._container.addEventListener("mouseleave",this._onMouseLeave)}},{key:"_bindEventHandlers",value:function W(){this._onMouseDown=this._onMouseDown.bind(this);this._onMouseUp=this._onMouseUp.bind(this);this._onMouseMove=this._onMouseMove.bind(this);this._onMouseLeave=this._onMouseLeave.bind(this)}},{key:"_setupSlider",value:function ae(){if(!this._displayThickness){return}var ah=this._controls.querySelector(".imglykit-slider");this._slider=new l["default"](ah,{minValue:0.01,maxValue:0.2});this._onThicknessUpdate=this._onThicknessUpdate.bind(this);this._slider.on("update",this._onThicknessUpdate);this._slider.setValue(this._currentThickness)}},{key:"_setupColorPicker",value:function B(){if(this._displayThickness){return}var ah=this._controls.querySelector(".imglykit-color-picker");this._colorPicker=new j["default"](this._ui,ah);this._colorPicker.on("update",this._onColorUpdate.bind(this));this._colorPicker.setValue(this._currentColor)}},{key:"_onBackButtonClick",value:function z(){if(this._displayThickness){this._displayThickness=false;return this.enter()}b(Object.getPrototypeOf(F.prototype),"_onBackButtonClick",this).call(this)}},{key:"_onBack",value:function Z(){if(!this._operationExistedBefore&&!this._operation.getPaths().length){this._ui.removeOperation("brush")}else{this._operation.dirty=true}this._ui.canvas.setZoomLevel(this._initialZoomLevel)}},{key:"_resetOperationSettings",value:function K(){this._operation.setPaths(this._initialOptions.paths)}},{key:"_onMouseDown",value:function y(ah){var ai=this._operation.getPaths().slice(0);this._operationExistedBeforeDraw=!!ai.length;this._optionsBeforeDraw={paths:ai};if(p["default"].isTouchEvent(ah)){this._showCursor()}this._startPaint(ah)}},{key:"_startPaint",value:function G(ah){ah.preventDefault();var ai=this._getRelativeMousePositionFromEvent(ah);this._painting=true;this._currentPath=this._operation.createPath(this._currentThickness,this._currentColor);this._currentPath.addControlPoint(ai);this._redrawPath()}},{key:"_onMouseUp",value:function S(ah){if(p["default"].isTouchEvent(ah)){this._hideCursor()}this._stopPaint();this._ui.addHistory(this,{paths:this._optionsBeforeDraw.paths},this._operationExistedBeforeDraw)}},{key:"_stopPaint",value:function M(){this._painting=false}},{key:"_redrawPath",value:function I(){this._operation.renderBrushCanvas(this._canvas,this._canvas)}},{key:"_onMouseMove",value:function D(ah){var ai=this._getRelativeMousePositionFromEvent(ah);if(!p["default"].isTouchEvent(ah)){this._moveCursorTo(ai);this._showCursor()}if(this._painting){this._currentPath.addControlPoint(ai);this._redrawPath()}}},{key:"_onMouseLeave",value:function C(ah){this._hideCursor()}},{key:"_getRelativeMousePositionFromEvent",value:function J(aj){var ai=this._container.getBoundingClientRect();var ak=new e["default"](ai.left,ai.top);var ah=p["default"].getEventPosition(aj).subtract(ak);return ah.divide(this._ui.canvas.size)}},{key:"_onThicknessUpdate",value:function ag(ah){this._currentThickness=ah;this._setCursorSize(this._currentThickness*this._getLongerSideSize())}},{key:"_onColorUpdate",value:function V(ah){this._currentColor=ah;this._setCursorColor(ah)}},{key:"_getLongerSideSize",value:function P(){var ah=this._ui.canvas.size;return Math.max(ah.x,ah.y)}},{key:"_moveCursorTo",value:function x(ah){var ai=this._currentThickness*this._getLongerSideSize()/2;this._cursor.style.left=ah.x*this._ui.canvas.size.x-ai+"px";this._cursor.style.top=ah.y*this._ui.canvas.size.y-ai+"px"}},{key:"_setCursorSize",value:function A(ah){this._cursor.style.width=ah+"px";this._cursor.style.height=ah+"px"}},{key:"_setCursorColor",value:function X(ah){this._cursor.style.background=ah.toHex()}},{key:"_showCursor",value:function H(){this._cursor.style.display="block"}},{key:"_hideCursor",value:function L(){this._cursor.style.display="none"}},{key:"context",get:function ad(){return{displayThickness:this._displayThickness}}}]);return F})(f["default"]);v.prototype.identifier="brush";w["default"]=v;d.exports=w["default"]},function(c,b){c.exports={operations:{brightness:"Brightness",contrast:"Contrast",filters:"Filters",flip:"Flip",frames:"Frames","radial-blur":"Radial Blur",rotation:"Rotation",saturation:"Saturation",stickers:"Stickers",text:"Text","tilt-shift":"Tilt-Shift",crop:"Crop",brush:"Brush"},"top-controls":{"new":"New",undo:"Undo","export":"Export",zoom:"Zoom"},splash:{upload:{headline:"Upload a picture",description:"Click here to upload a picture from your library or just drag and drop"},or:"or",webcam:{headline:"Take a picture",description:"Click here to take a picture with your webcam or phone"}},generic:{loading:"Loading",exporting:"Exporting",importing:"Importing",color:"Color",error_headline:"An error has occurred.",warning_headline:"Warning!"},controls:{frames:{color:"Color"},brush:{color:"Color"},text:{foreground:"Foreground",background:"Background"}},errors:{context_lost:"Your browser took too long to render the image. Please try applying less operations.",context_lost_limit:"Your browser failed multiple times while rendering the image."},warnings:{image_resized:"Your image exceeds the maximum size of $1 megapixels and has therefore been resized to $2x$3 pixels."}}},function(c,b){c.exports={operations:{brightness:"Helligkeit",contrast:"Kontrast",filters:"Filter",flip:"Spiegeln",frames:"Rahmen","radial-blur":"Radial Blur",rotation:"Drehung",saturation:"Sttigung",stickers:"Sticker",text:"Text","tilt-shift":"Tilt-Shift",crop:"Zuschneiden",brush:"Malen"},"top-controls":{"new":"Neu",undo:"Rckgngig","export":"Exportieren",zoom:"Zoom"},splash:{upload:{headline:"Bild hochladen",description:"Klicke hier, um ein Bild hochzuladen oder ziehe eine Bilddatei hier her"},or:"oder",webcam:{headline:"Foto machen",description:"Klicke hier, um ein Foto mit deiner Webcam oder deinem Smartphone zu machen"}},generic:{loading:"Laden",exporting:"Exportiere",importing:"Importiere",error_headline:"Es ist ein Fehler aufgetreten.",warning_headline:"Warnung!"},controls:{frames:{color:"Farbe"},brush:{color:"Farbe"},text:{foreground:"Text",background:"Hintergrund"}},errors:{context_lost:"Dein Browser hat zu lange gebraucht, um das Bild zu generieren. Bitte versuche es noch einmal.",context_lost_limit:"Bild-Generierung ist mehrmals fehlgeschlagen."},warnings:{image_resized:"Dein Bild berschreitet die maximale Gre von $1 Megapixeln und wurde daher auf $2x$3 Pixel verkleinert."}}}])});